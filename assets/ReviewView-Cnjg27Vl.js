import{g as C,d as $,u as a,c as i,f as h,h as g,e as y,b as k,F as m,i as V,w as K,o as r,a as u,t as v,_ as b,j as B,k as S}from"./index-1Esrt7dj.js";import{Q as A,w as D,l as T}from"./index-guFvHVik.js";import{u as F,a as N,p as q,K as P,b as W,c as L,d as M,e as Q}from"./KanjiWordList-DM3FcbLG.js";import{f as E,u as G,a as z,r as H}from"./cards-Dj3TZW_V.js";import{A as I}from"./AppButton-CI0rVoMs.js";import{l as J}from"./db-Bi06ATXP.js";function O(){return C(()=>{const j=D();return A(j)})}const U={key:0},X={class:"advance-buttons"},Y={class:"next-review-time"},Z=$({__name:"KanjiReview",props:{progress:{},answered:{type:Boolean}},emits:["answer","rate"],setup(j,{emit:d}){const c=j,f=d,p=F(()=>c.progress.cardId),t=N(()=>c.progress.cardId);q(()=>c.progress.cardId.toString(16).padStart(5,"0"));const _=O(),s=C(()=>_.value.repeat(c.progress.fsrs,new Date));function n(e){var R;const w=((R=e.last_review)==null?void 0:R.getTime())??Date.now(),l=e.due.getTime();return E(l-w)}function o(e){e!==T.Manual&&f("rate",_.value.next(c.progress.fsrs,new Date,e))}return(e,w)=>a(p)?(r(),i("section",U,[h(P,{class:"title",kanji:a(p),"hide-literal":!e.answered&&e.progress.cardType==="kanji-write","hide-meaning":!e.answered&&e.progress.cardType==="kanji-read"},null,8,["kanji","hide-literal","hide-meaning"]),e.answered||e.progress.cardType==="kanji-write"?(r(),g(W,{key:0,class:"readings",kanji:a(p)},null,8,["kanji"])):y("",!0),h(L,{class:"strokes",kanji:a(p),"practice-mode":!e.answered&&e.progress.cardType==="kanji-write"},null,8,["kanji","practice-mode"]),k("div",X,[e.answered?(r(!0),i(m,{key:0},V(s.value,({log:l,card:R})=>(r(),g(I,{class:"rating-button",key:l.rating,"data-rating":a(T)[l.rating],onClick:ce=>o(l.rating)},{default:K(()=>[u(v(a(T)[l.rating])+" ",1),k("small",Y,v(n(R)),1)]),_:2},1032,["data-rating","onClick"]))),128)):(r(),g(I,{key:1,onClick:w[0]||(w[0]=l=>e.$emit("answer")),filled:""},{default:K(()=>[w[1]||(w[1]=u(" Show ")),e.progress.cardType==="kanji-read"?(r(),i(m,{key:0},[u(" Reading")],64)):(r(),i(m,{key:1},[u(" Writing")],64))]),_:1}))]),e.answered?(r(),g(Q,{key:1,class:"components"})):y("",!0),a(t)?(r(),g(M,{key:2,class:"words","kanji-vocab":a(t),"hide-kanji":!e.answered&&e.progress.cardType==="kanji-write","hide-reading":!e.answered&&e.progress.cardType==="kanji-read","hide-meaning":!e.answered&&e.progress.cardType==="kanji-read"},null,8,["kanji-vocab","hide-kanji","hide-reading","hide-meaning"])):y("",!0)])):y("",!0)}}),x=b(Z,[["__scopeId","data-v-7fc0c953"]]),ee={key:0,class:"review-remaining-count"},ae={class:"review-count"},re={class:"new-count"},ne={class:"learning-count"},se=$({__name:"ReviewRemainCount",setup(j){const d=G();return(c,f)=>a(d)?(r(),i("div",ee,[k("span",ae,v(a(d).due),1),k("span",re,"(+ "+v(a(d).new)+")",1),k("span",ne,v(a(d).learning),1)])):y("",!0)}}),te=b(se,[["__scopeId","data-v-def2b4ab"]]),ie={class:"header"},oe={class:"title"},de=$({__name:"ReviewView",setup(j){const d=B(),c=S();function f(s){return s==="kanji-read"||s==="kanji-write"}const p=C(()=>{const{kanji:s,"card-type":n}=d.query;if(typeof s!="string"||typeof n!="string")return null;const o=s.codePointAt(0);return!o||!f(n)?null:{cardId:o,cardType:n}}),t=z(p);async function _(s,n){try{await H(s.cardId,s.cardType,n),J.postMessage("card-review"),c.replace({query:{kanji:void 0,"card-type":void 0}})}catch(o){console.error(o)}}return(s,n)=>(r(),i("article",null,[k("header",ie,[k("strong",oe,[a(t)?(r(),i(m,{key:0},[a(t).cardType==="kanji-read"?(r(),i(m,{key:0},[u(" Reading ")],64)):(r(),i(m,{key:1},[u("Writing")],64)),n[2]||(n[2]=u(" Review "))],64)):(r(),i(m,{key:1},[u("Finished Review")],64))]),h(te,{class:"counts"})]),a(t)?(r(),g(x,{key:0,progress:a(t),answered:p.value!=null,onAnswer:n[0]||(n[0]=o=>s.$router.replace({query:{kanji:String.fromCodePoint(a(t).cardId),"card-type":a(t).cardType}})),onRate:n[1]||(n[1]=o=>_(a(t),o))},null,8,["progress","answered"])):y("",!0)]))}}),ge=b(de,[["__scopeId","data-v-b10aac66"]]);export{ge as default};
