import{b as p,W as d,u as w}from"./index-TyJKmroR.js";import{l as m}from"./reviews-CQAw0Jgj.js";import{d as u}from"./channels-Cq-RpcWF.js";import{u as g}from"./db-2hokmpug.js";import{c as f,x as c,C as j,l as v}from"./index-Bay301qk.js";const b=new RegExp("\\p{Script=Han}","u"),K=new RegExp("^\\p{Script=Han}$","u"),R=/[\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Han}\u{2e80}-\u{2fd5}\u{3000}-\u{303f}\u{31f0}-\u{31ff}\u{3220}-\u{3243}\u{3280}-\u{337f}\u{ff5f}-\u{ff9f}\u{ff01}-\u{ff5e}]/u;function _(t){return R.test(t)}function x(t){return b.test(t)}function h(t){return K.test(t)}function l(){return f(()=>{const t=p({enable_fuzz:m.value});return d(t)})}function D(t){const s=l(),{result:n}=g(f(()=>{const r=c(t);return async()=>{const i=(await u).transaction("progress").store,a=await i.get([r,"kanji-read"]),o=await i.get([r,"kanji-write"]),e=new Date;return{read:a?s.value.get_retrievability(a.fsrs,e,!1):null,write:o?s.value.get_retrievability(o.fsrs,e,!1):null}}}));return n}function F(t){const s=l(),n=j(new Set);return v(()=>c(t),async r=>{if(!r)return;const i=new Date;for(const a of r)if(h(a)){const o=a.codePointAt(0)??0,e=await(await u).get("progress",[o,"kanji-read"]);if(e){if(e.fsrs.state!==w.Review)continue;s.value.get_retrievability(e.fsrs,i,!1)>.99&&n.add(a)}}},{immediate:!0}),n}export{D as a,_ as b,b as c,F as d,x as h,h as i,l as u};
