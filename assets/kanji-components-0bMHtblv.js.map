{"version":3,"file":"kanji-components-0bMHtblv.js","sources":["../../src/helpers/kanji-components.ts"],"sourcesContent":["import { MaybeRefOrGetter, Ref, ref, toValue, watch } from \"vue\";\n\nimport { KanjiComponentInfo } from \"../types.ts\";\n\nfunction toHex(literal: string): string {\n  if (literal.startsWith(\"CDP-\")) {\n    return literal;\n  }\n\n  const codepoint = literal.codePointAt(0) ?? 0;\n  return codepoint.toString(16).padStart(5, \"0\");\n}\n\nexport function useKanjiComponent(\n  literal: MaybeRefOrGetter<string | null | undefined>,\n): Ref<KanjiComponentInfo | null> {\n  const kanjiComponent = ref<KanjiComponentInfo | null>(null);\n\n  function setKanjiComponent(kanjiComponentInfo: KanjiComponentInfo) {\n    kanjiComponent.value = kanjiComponentInfo;\n  }\n\n  watch(\n    () => toValue(literal),\n    async (value) => {\n      if (!value) {\n        kanjiComponent.value = null;\n        return;\n      }\n\n      if (value === kanjiComponent.value?.literal) {\n        return;\n      }\n\n      const hex = toHex(value);\n      const response = await fetch(`/data/components-v1/${hex}.json`);\n\n      if (\n        !response.ok ||\n        !response.headers.get(\"Content-Type\")?.startsWith(\"application/json\")\n      ) {\n        // eslint-disable-next-line no-console\n        console.error(\"failed getting kanji components:\", value);\n        return;\n      }\n\n      try {\n        const data = await response.json();\n        setKanjiComponent(data);\n      } catch {\n        // eslint-disable-next-line no-console\n        console.error(\"failed getting kanji components:\", value);\n      }\n    },\n    { immediate: true },\n  );\n\n  return kanjiComponent;\n}\n"],"names":["toHex","literal","useKanjiComponent","kanjiComponent","ref","setKanjiComponent","kanjiComponentInfo","watch","toValue","value","hex","response","data"],"mappings":"sDAIA,SAASA,EAAMC,EAAyB,CACtC,OAAIA,EAAQ,WAAW,MAAM,EACpBA,GAGSA,EAAQ,YAAY,CAAC,GAAK,GAC3B,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAC/C,CAEO,SAASC,EACdD,EACgC,CAChC,MAAME,EAAiBC,EAA+B,IAAI,EAE1D,SAASC,EAAkBC,EAAwC,CACjEH,EAAe,MAAQG,CACzB,CAEA,OAAAC,EACE,IAAMC,EAAQP,CAAO,EACrB,MAAOQ,GAAU,CACf,GAAI,CAACA,EAAO,CACVN,EAAe,MAAQ,KACvB,MACF,CAEA,GAAIM,IAAUN,EAAe,OAAO,QAClC,OAGF,MAAMO,EAAMV,EAAMS,CAAK,EACjBE,EAAW,MAAM,MAAM,uBAAuBD,CAAG,OAAO,EAE9D,GACE,CAACC,EAAS,IACV,CAACA,EAAS,QAAQ,IAAI,cAAc,GAAG,WAAW,kBAAkB,EACpE,CAEA,QAAQ,MAAM,mCAAoCF,CAAK,EACvD,MACF,CAEA,GAAI,CACF,MAAMG,EAAO,MAAMD,EAAS,KAAA,EAC5BN,EAAkBO,CAAI,CACxB,MAAQ,CAEN,QAAQ,MAAM,mCAAoCH,CAAK,CACzD,CACF,EACA,CAAE,UAAW,EAAA,CAAK,EAGbN,CACT"}