import{c as u,C as F,d as j,i as A,x as q,u as a,v as W,w as b,h as f,t as m,o as s,_ as L,a as o,F as S,l as E,b as v,m as Q,p as Y,E as T,N as z,e as p,g as w,f as $,A as K}from"./index-Q4noPGif.js";import{g as G}from"./decks-mTR0UDKY.js";import{u as N,d as M}from"./db-BhNzgzsk.js";import{u as P}from"./fsrs-jRzrxqJt.js";import{d as H}from"./decks-C8NYG5fl.js";import{f as R}from"./formats-CxjEYhKc.js";import{S as C,k as J,e as O,W as U}from"./reviews-DovQcjTA.js";function X(){return N(async()=>(await(await M).transaction("decks").store.index("category+priority").getAll()).filter(({active:t})=>t)).result}function Z(d){const t=P(),r=u(()=>{const i=F(d);return()=>G(i,t.value)}),{result:e}=N(r);return e}const ee=j({__name:"DeckKanjiCardItem",props:{codepoint:{}},setup(d){const t=d,r=u(()=>String.fromCodePoint(t.codepoint)),{result:e}=N(async()=>{const{codepoint:n}=t,l=(await M).transaction("progress").store,k=await l.get([n,"kanji-read"]),h=await l.get([n,"kanji-write"]);return{read:k,write:h}}),i=P();function y(n){const l=new Date,k=J.value/100,h=new Date(Date.now()+O.value*U);return i.value.get_retrievability(n,l,!1)>k&&n.due>h}function _(n){return n?n.state===C.New?"new":n.state===C.Learning||n.state===C.Relearning||n.due<new Date?"due":y(n)?"know":"review":null}const g=u(()=>_(e.value?.read?.fsrs)),x=u(()=>_(e.value?.write?.fsrs));return(n,l)=>{const k=q("RouterLink");return s(),A(k,{to:a(W)(r.value),class:"kanji","data-read":g.value,"data-write":x.value},{default:b(()=>[f(m(r.value),1)]),_:1},8,["to","data-read","data-write"])}}}),te=L(ee,[["__scopeId","data-v-08b61479"]]),ne={class:"kanji-list"},se=j({__name:"DeckKanjiCards",props:{kanji:{}},setup(d){return(t,r)=>(s(),o("ol",ne,[(s(!0),o(S,null,E(t.kanji,e=>(s(),o("li",{key:e,class:"kanji"},[v(te,{codepoint:e},null,8,["codepoint"])]))),128))]))}}),ae=L(se,[["__scopeId","data-v-4bbb3e6d"]]),oe=["aria-labelledby"],re=["id"],ce={class:"status"},ue={class:"count total-count"},ie={key:0,class:"count know-count"},le={key:1,class:"count review-count"},de={key:2,class:"count due-count"},ke={key:3,class:"count new-count"},pe=j({__name:"DeckListItem",props:{deck:{}},setup(d){const t=d,r=Q(null),e=z(),i=Y(),y=u(()=>H(t.deck)),_=u(()=>i.query.deck?typeof i.query.deck=="string"?[i.query.deck]:i.query.deck:[]),g=u(()=>_.value.includes(t.deck.name)),x=u(()=>{const{name:c}=t.deck,I=g.value?_.value.filter(D=>D!==c):[..._.value,c];return{query:{...i.query,deck:I}}}),n=Z(()=>t.deck.name);function l(c){if(!n.value)return 0;const{"kanji-read":I,"kanji-write":D}=n.value;return(I[c]+D[c])/2}const k=u(()=>l("new")),h=u(()=>l("due")),V=u(()=>l("review")),B=u(()=>l("know"));return T(()=>{g.value&&_.value.length===1&&r.value?.scrollIntoView({block:"start"})}),(c,I)=>{const D=q("RouterLink");return s(),o("article",{ref_key:"el",ref:r,class:"deck-list-item","aria-labelledby":a(e)},[p("strong",{id:a(e),class:"label"},[v(D,{to:x.value,"aria-pressed":g.value,replace:""},{default:b(()=>[f(m(y.value),1)]),_:1},8,["to","aria-pressed"])],8,re),p("div",ce,[p("span",ue,m(c.deck.cards.length)+" cards",1),a(n)?(s(),o(S,{key:0},[B.value>0?(s(),o("span",ie,m(a(R)(B.value/c.deck.cards.length))+" know ",1)):w("",!0),V.value>0?(s(),o("span",le,m(a(R)(V.value/c.deck.cards.length))+" reviewed ",1)):w("",!0),h.value>0?(s(),o("span",de,m(a(R)(h.value/c.deck.cards.length))+" due ",1)):w("",!0),k.value>0?(s(),o("span",ke,m(a(R)(k.value/c.deck.cards.length))+" remaining ",1)):w("",!0)],64)):w("",!0)]),g.value?(s(),A(ae,{key:0,kanji:c.deck.cards,class:"cards"},null,8,["kanji"])):w("",!0)],8,oe)}}}),_e=L(pe,[["__scopeId","data-v-33452db6"]]),me={key:0,class:"deck-list"},we=j({__name:"DeckList",setup(d){const t=X();return(r,e)=>{const i=q("RouterLink");return s(),o("section",null,[e[4]||(e[4]=p("p",null," Decks allow you do keep track of your practice, such that you know which kanji you already know, which you should learn next, and which you need to review. ",-1)),a(t)&&a(t).length>0?(s(),o("ol",me,[(s(!0),o(S,null,E(a(t),y=>(s(),o("li",{key:y.name,class:"deck-list-item"},[v(_e,{deck:y},null,8,["deck"])]))),128))])):a(t)?(s(),o(S,{key:1},[p("p",null,[e[1]||(e[1]=f(" You donâ€˜t have any decks. ")),v(i,{to:a($)},{default:b(()=>e[0]||(e[0]=[f(" Add your first deck ")])),_:1,__:[0]},8,["to"]),e[2]||(e[2]=f(" by clicking the button below. "))]),v(K,{to:a($),"prefix-icon":"plus"},{default:b(()=>e[3]||(e[3]=[f(" Add Deck ")])),_:1,__:[3]},8,["to"])],64)):w("",!0)])}}}),fe=L(we,[["__scopeId","data-v-d7bb3716"]]),ve={class:"article-header"},ye={class:"actions"},ge=j({__name:"DecksView",setup(d){return(t,r)=>(s(),o("article",null,[p("header",ve,[r[1]||(r[1]=p("h2",{class:"title"},"Your Decks",-1)),p("div",ye,[v(K,{to:a($),"prefix-icon":"draw"},{default:b(()=>r[0]||(r[0]=[f(" Manage Decks ")])),_:1,__:[0]},8,["to"])])]),v(fe)]))}}),Se=L(ge,[["__scopeId","data-v-45d5f815"]]);export{Se as default};
