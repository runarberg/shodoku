import{z as H,m as j,B as J,d as w,C as T,a as k,e as r,D as b,i as y,g as D,E as F,u as c,v as S,G as O,H as W,o as l,_ as M,b as m,A as E,I as Y,w as g,T as Q,h as $,t as I,J as L,K as X,c as K,L as Z,F as h,l as V,R as x,q as ee}from"./index-BM2Ra3on.js";import{g as oe,p as ae,K as te,a as ne,b as le,c as se,d as ie}from"./KanjiWordList-Bkqv3Okt.js";import{p as re,S as P}from"./reviews-BZy-Kf2y.js";import{a as ce}from"./fsrs-B_IQ2BK6.js";import{u as ue,a as de}from"./decks-Bhp3y8Gp.js";import{e as R,c as pe}from"./decks-BBCgiq92.js";import{c as fe}from"./decks-SO1bh7uj.js";import{A as me,a as ke}from"./AppNumberInput-Cglb6g1n.js";import{A as ge}from"./AppCheckbox-BswWwhJl.js";import{u as ve,a as be}from"./kanji-FSB18ZmU.js";import"./kanji-components-CdOEBGxo.js";import"./index-BaBsQMEA.js";import"./db-MrKA-e94.js";import"./WordListItem-CxTWrGoe.js";import"./WordWritingSelect-ba5XybYn.js";const z=Symbol("menu-injection-key");function G(){return{open:j(!1)}}function _e(){const p=G();return J(z,p),p}function ye(){return H(z,G,!0)}const je=["aria-label","popovertarget","disabled"],$e=["id"],he={role:"list",class:"menu"},De=w({__name:"AppMenu",props:{open:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},toggleIcon:{default:null}},emits:["update:open"],setup(p,{emit:u}){W(t=>({"537a91c9":c(B)}));const i=p,d=u,n=j(null),a=j(null),e=j(null),s=_e(),_=O(),B=`--${_}`.replace(":","-anchor-");function v(){s.open.value=!1}function o(t){t.relatedTarget instanceof Element&&!e.value?.contains(t.relatedTarget)&&v()}function f(t){s.open.value=t.newState==="open"}function N(t){if(t.newState==="open"&&!("anchorName"in document.documentElement.style)){const C=n.value?.getBoundingClientRect(),A=a.value?.style;A&&C&&(A.insetBlockStart=`${C.bottom+window.scrollY}px`,A.insetInlineEnd=`calc(100% - ${C.right}px)`)}}return T(s.open,t=>{t?a.value?.showPopover():a.value?.hidePopover(),d("update:open",t)}),T(()=>i.open,t=>{t!==s.open.value&&(s.open.value=t)}),(t,C)=>(l(),k("div",{ref_key:"menuEl",ref:e,class:"app-menu popover-container",onFocusout:C[0]||(C[0]=A=>o(A))},[r("button",{ref_key:"toggleButton",ref:n,class:S(["toggle-button",{open:c(s).open.value}]),"aria-label":t.$slots.toggle?void 0:"Options",popovertarget:c(_),disabled:t.disabled},[b(t.$slots,"toggle",{},()=>[t.toggleIcon?(l(),y(F,{key:0,icon:t.toggleIcon,class:"toggle-icon"},null,8,["icon"])):D("",!0)],!0)],10,je),r("div",{id:c(_),ref_key:"popoverEl",ref:a,class:"popover",popover:"",onBeforetoggle:N,onToggle:f},[r("menu",he,[b(t.$slots,"default",{},void 0,!0)])],40,$e)],544))}}),we=M(De,[["__scopeId","data-v-cc4e4138"]]),Ce={class:"app-menu-item"},Ie={class:"text"},Be=w({__name:"AppMenuItem",props:{prefixIcon:{default:null},to:{default:null},disabled:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},replace:{type:Boolean,default:!1}},emits:["click"],setup(p,{emit:u}){const i=p,d=u,{open:n}=ye();function a(e){i.disabled||(i.persistent||(n.value=!1),d("click",e))}return(e,s)=>(l(),k("li",Ce,[m(E,{type:"button",inline:"",class:"button",disabled:e.disabled,"prefix-icon":e.prefixIcon,to:e.to,replace:e.replace,onClick:a},Y({default:g(()=>[r("span",Ie,[b(e.$slots,"default",{},void 0,!0)])]),_:2},[e.$slots.prefix?{name:"prefix",fn:g(()=>[b(e.$slots,"prefix",{},void 0,!0)]),key:"0"}:void 0]),1032,["disabled","prefix-icon","to","replace"])]))}}),U=M(Be,[["__scopeId","data-v-746e6864"]]),Ae=["aria-labelledby"],Ee={class:"header"},Ke=["id"],Me={class:"body"},Ne=["id"],Ve={class:"footer"},Se={class:"buttons"},Te=w({__name:"AppDialog",props:{title:{default:null},cancelLabel:{default:null},confirmDisabled:{type:Boolean,default:!1},confirmLabel:{default:null}},emits:["cancel","close","confirm"],setup(p,{expose:u,emit:i}){const d=i,n=j(!1),a=j(null),e=O();function s(o=""){d("close"),n.value=!1,a.value?.open&&a.value.close(o)}function _(){d("cancel"),s("")}function B(){s("confirmed"),d("confirm")}function v(){n.value=!0,a.value?.showModal()}return u({close:s,show:v}),(o,f)=>(l(),y(Q,{to:"[id='app:dialogs']"},[r("dialog",X(o.$attrs,{ref_key:"dialog",ref:a,"aria-labelledby":`${c(e)}/title`,class:"app-dialog",onCancel:L(_,["prevent"])}),[r("header",Ee,[r("strong",{id:`${c(e)}/title`,class:"title"},[b(o.$slots,"title",{},()=>[$(I(o.title),1)],!0)],8,Ke),m(E,{"aria-label":"close",class:"close-button",inline:"",onClick:_},{default:g(()=>[m(F,{icon:"x-mark"})]),_:1})]),r("div",Me,[b(o.$slots,"default",{},void 0,!0),r("form",{id:`${c(e)}/form`,class:"form",method:"dialog",onSubmit:L(B,["prevent"])},[b(o.$slots,"form",{},void 0,!0)],40,Ne)]),r("footer",Ve,[b(o.$slots,"footer",{},void 0,!0),r("div",Se,[b(o.$slots,"buttons",{},void 0,!0),o.cancelLabel||o.$slots.cancel?(l(),y(E,{key:0,onClick:_},{default:g(()=>[b(o.$slots,"cancel",{},()=>[$(I(o.cancelLabel),1)],!0)]),_:3})):D("",!0),o.confirmLabel||o.$slots.confirm?(l(),y(E,{key:1,type:"submit",filled:"",form:`${c(e)}/form`,disabled:o.confirmDisabled},{default:g(()=>[b(o.$slots,"confirm",{},()=>[$(I(o.confirmLabel),1)],!0)]),_:3},8,["form","disabled"])):D("",!0)])])],16,Ae)]))}}),Le=M(Te,[["__scopeId","data-v-95bc6f59"]]),Pe=w({__name:"KanjiManageDecksDeckItem",props:{kanji:{},deck:{}},setup(p){const u=p,i=K(()=>u.deck.cards.includes(u.kanji.codepoint));async function d(){const{deck:n}=u,{cards:a}=n,{codepoint:e}=u.kanji;i.value?R({...n,cards:a.filter(s=>s!==e)}):a.includes(e)||R({...n,cards:[...a,e]})}return(n,a)=>(l(),y(ge,{"model-value":i.value,"onUpdate:modelValue":d},{label:g(()=>[r("span",{class:S(["label",{active:i.value}])},I(n.deck.label),3)]),_:1},8,["model-value"]))}}),q=M(Pe,[["__scopeId","data-v-369949f9"]]),Re={class:"list"},Ue={key:0},qe=["open"],Fe={class:"category-summary"},Oe={class:"list"},ze=w({__name:"KanjiManageDecksDialog",props:{kanji:{}},setup(p,{expose:u}){const i=p,d=j(null),n=ue(),a=j(!1),e=Z({label:"",priority:1}),s=K(()=>re(n.value??[],oe(v=>v.category)));async function _(){a.value=!1,e.label="",e.priority=1,d.value?.show()}function B(){a.value&&pe({label:e.label,priority:e.priority,cards:[i.kanji.codepoint]})}return u({show:_}),(v,o)=>(l(),y(Le,{ref_key:"dialog",ref:d,title:` ${v.kanji.literal}: Manage Decks`,"cancel-label":a.value?"Cancel":null,"confirm-label":a.value?"Cretate Deck":"Close",onConfirm:B},{form:g(()=>[r("ul",Re,[(l(!0),k(h,null,V(s.value,([f,N])=>(l(),k(h,{key:f},[f!=="custom"?(l(),k("li",Ue,[r("details",{class:"category-details",open:N.some(({cards:t})=>t.includes(v.kanji.codepoint))},[r("summary",Fe,I(c(fe)(f)),1),r("ul",Oe,[(l(!0),k(h,null,V(N,t=>(l(),k("li",{key:t.name},[m(q,{kanji:v.kanji,deck:t},null,8,["kanji","deck"])]))),128))])],8,qe)])):D("",!0)],64))),128)),(l(!0),k(h,null,V(s.value.get("custom")??[],f=>(l(),k("li",{key:f.name},[m(q,{kanji:v.kanji,deck:f},null,8,["kanji","deck"])]))),128))]),r("div",{class:S(["create-new-fields",{expanded:a.value}])},[a.value?(l(),k(h,{key:1},[m(me,{modelValue:e.label,"onUpdate:modelValue":o[1]||(o[1]=f=>e.label=f),class:"name-field",label:"Deck Name",required:""},null,8,["modelValue"]),m(ke,{modelValue:e.priority,"onUpdate:modelValue":o[2]||(o[2]=f=>e.priority=f),class:"priority-field",label:"Priority",min:"1",required:""},null,8,["modelValue"])],64)):(l(),y(E,{key:0,class:"create-new-expand-button","prefix-icon":"plus",inline:"",onClick:o[0]||(o[0]=f=>a.value=!0)},{default:g(()=>[...o[5]||(o[5]=[$(" Create New ",-1)])]),_:1}))],2)]),default:g(()=>[r("p",null,[o[3]||(o[3]=$(" Select a decks to add/remove ",-1)),r("strong",null,I(v.kanji.literal),1),o[4]||(o[4]=$(" to/from. ",-1))])]),_:1},8,["title","cancel-label","confirm-label"]))}}),Ge=M(ze,[["__scopeId","data-v-b2295588"]]),He=w({__name:"KanjiExploreActions",props:{kanji:{}},setup(p){const u=p,i=j(null),d=de(()=>u.kanji.codepoint),n=ce(()=>u.kanji.codepoint),a=K(()=>n.value.read?.fsrs.state===P.New&&n.value.write?.fsrs.state===P.New);return(e,s)=>(l(),y(we,{"toggle-icon":"ellipsis-vertical"},{default:g(()=>[m(U,{onClick:s[0]||(s[0]=_=>i.value?.show())},{default:g(()=>[c(d).length===0?(l(),k(h,{key:0},[$("Add to deck")],64)):(l(),k(h,{key:1},[$("Manage decks")],64))]),_:1}),c(d).length>0&&a.value?(l(),y(U,{key:0,to:{name:c(x),query:{kanji:e.kanji.literal,"card-type":"kanji-write",singleton:""}},replace:""},{default:g(()=>[...s[1]||(s[1]=[$(" Review now ",-1)])]),_:1},8,["to"])):D("",!0),m(Ge,{ref_key:"manageDecksDialog",ref:i,kanji:e.kanji},null,8,["kanji"])]),_:1}))}}),Je={key:0,class:"kanji-card"},co=w({__name:"KanjiView",setup(p){const u=ee(),i=K(()=>{const e=u.params.kanji;return typeof e!="string"||[...e].length!==1?null:e.codePointAt(0)??null}),d=K(()=>i.value?.toString(16).padStart(5,"0")??null),n=ve(i),a=be(i);return ae(d),(e,s)=>c(n)?(l(),k("article",Je,[m(te,{class:"title",kanji:c(n)},{actions:g(()=>[m(He,{kanji:c(n)},null,8,["kanji"])]),_:1},8,["kanji"]),m(ne,{class:"readings",kanji:c(n)},null,8,["kanji"]),m(le,{class:"strokes",kanji:c(n)},null,8,["kanji"]),m(se,{class:"components"}),c(a)?(l(),y(ie,{key:0,class:"words","kanji-vocab":c(a)},null,8,["kanji-vocab"])):D("",!0)])):D("",!0)}});export{co as default};
//# sourceMappingURL=KanjiView-CcPg-kpY.js.map
