{"version":3,"file":"ReviewSummaryView-B59thNW4.js","sources":["../../src/components/ReviewSummaryItem.vue","../../src/components/ReviewSummary.vue","../../src/views/ReviewSummaryView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { State } from \"ts-fsrs\";\nimport { computed } from \"vue\";\n\nimport { kanaRoute, kanjiRoute } from \"../router.ts\";\nimport { CardReview } from \"../types.ts\";\n\nconst props = defineProps<{\n  cardId: number;\n  reviews: CardReview[];\n}>();\n\nconst literal = computed(() => String.fromCharCode(props.cardId));\nconst firstReview = computed(() => props.reviews.at(0));\nconst isNew = computed(() => {\n  if (!firstReview.value) {\n    return false;\n  }\n\n  return firstReview.value.log.state === State.New;\n});\n\nconst route = computed(() =>\n  firstReview.value?.cardType.startsWith(\"kana\")\n    ? kanaRoute(literal.value)\n    : kanjiRoute(literal.value),\n);\n</script>\n\n<template>\n  <RouterLink\n    :to=\"route\"\n    class=\"review-summary-item\"\n    :class=\"{ 'is-new': isNew }\"\n  >\n    <strong class=\"card-value\">{{ literal }}</strong>\n  </RouterLink>\n</template>\n\n<style scoped>\n.review-summary-item {\n  background: var(--background-strong);\n  border: 1px solid var(--accent-color);\n  display: flex;\n  padding: 0.2ex 0.5ex;\n  text-decoration: none;\n\n  &.is-new {\n    border-color: var(--green);\n  }\n}\n\n.card-value {\n  color: var(--accent-color);\n  font-size: 1.5em;\n  font-weight: 500;\n\n  .is-new & {\n    color: var(--green);\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { State } from \"ts-fsrs\";\nimport { computed, watchEffect } from \"vue\";\nimport { useRouter } from \"vue-router\";\n\nimport { homeRoute, reviewRoute } from \"../router.ts\";\nimport {\n  increaseReviewLimit,\n  newLimit,\n  useRemainingCount,\n  useReviewedCards,\n} from \"../store/reviews.ts\";\nimport AppButton from \"./AppButton.vue\";\nimport RemoteSyncSyncButton from \"./RemoteSyncSyncButton.vue\";\nimport ReviewSummaryItem from \"./ReviewSummaryItem.vue\";\n\nconst router = useRouter();\nconst reviewedCards = useReviewedCards();\n\nconst newCount = computed(() => {\n  if (!reviewedCards.value) {\n    return 0;\n  }\n\n  let sum = 0;\n  for (const [review] of reviewedCards.value.values()) {\n    if (review.log.state === State.New) {\n      sum += 1;\n    }\n  }\n\n  return sum;\n});\n\nconst remainingCount = useRemainingCount();\nconst doneToday = computed(() => {\n  const counts = remainingCount.value;\n\n  if (!counts) {\n    return false;\n  }\n\n  return counts.due === 0 && counts.new === 0 && counts.learning === 0;\n});\n\nfunction continueReview() {\n  increaseReviewLimit();\n  router.push(reviewRoute);\n}\n\nwatchEffect(() => {\n  if (reviewedCards.value?.size === 0) {\n    // Not reviewed any cards today.\n    router.replace(homeRoute);\n  }\n});\n</script>\n\n<template>\n  <section class=\"review-summary\">\n    <p v-if=\"reviewedCards\">\n      Reviewed\n      <span class=\"review-count total-count\"\n        >{{ reviewedCards.size }} cards</span\n      >\n      today<template v-if=\"newCount > 0\">\n        (of which\n        <span class=\"review-count new-count\">{{ newCount }} new</span\n        >)</template\n      >.\n    </p>\n\n    <ul v-if=\"reviewedCards\" class=\"review-summary-list\">\n      <li v-for=\"[cardId, reviews] of reviewedCards\" :key=\"cardId\">\n        <ReviewSummaryItem :card-id=\"cardId\" :reviews=\"reviews\" />\n      </li>\n    </ul>\n\n    <p v-if=\"doneToday\">\n      Click the button below to temporarily increase your daily review limit.\n    </p>\n\n    <div class=\"buttons\">\n      <AppButton v-if=\"doneToday\" @click=\"continueReview()\">\n        Review {{ newLimit }} Extra\n      </AppButton>\n\n      <RemoteSyncSyncButton conditional />\n    </div>\n  </section>\n</template>\n\n<style scoped>\n.review-summary-list {\n  gap: 1em;\n  list-style: none;\n  display: flex;\n  padding: 0;\n  flex-wrap: wrap;\n}\n\n.review-count {\n  font-weight: 500;\n\n  &.total-count {\n    color: var(--blue);\n  }\n\n  &.new-count {\n    color: var(--green);\n  }\n}\n\n.buttons {\n  align-items: start;\n  display: flex;\n  gap: 1ex;\n\n  @media screen and (max-width: 60ch) {\n    align-items: center;\n    flex-direction: column;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport ReviewSummary from \"../components/ReviewSummary.vue\";\n</script>\n\n<template>\n  <article>\n    <header class=\"article-header\">\n      <h2 class=\"title\">Review Summary</h2>\n    </header>\n\n    <ReviewSummary />\n  </article>\n</template>\n\n<style scoped>\n.article-header {\n  margin-block-end: 1.5em;\n\n  & .title {\n    margin-block: 0;\n  }\n}\n</style>\n"],"names":["props","__props","literal","computed","firstReview","isNew","State","route","kanaRoute","kanjiRoute","_createBlock","_component_RouterLink","_normalizeClass","_createElementVNode","_hoisted_1","_toDisplayString","router","useRouter","reviewedCards","useReviewedCards","newCount","sum","review","remainingCount","useRemainingCount","doneToday","counts","continueReview","increaseReviewLimit","reviewRoute","watchEffect","homeRoute","_openBlock","_createElementBlock","_unref","_hoisted_2","_hoisted_3","_Fragment","_hoisted_4","_hoisted_5","_renderList","cardId","reviews","_createVNode","ReviewSummaryItem","_hoisted_7","AppButton","newLimit","RemoteSyncSyncButton","ReviewSummary"],"mappings":"udAOA,MAAMA,EAAQC,EAKRC,EAAUC,EAAS,IAAM,OAAO,aAAaH,EAAM,MAAM,CAAC,EAC1DI,EAAcD,EAAS,IAAMH,EAAM,QAAQ,GAAG,CAAC,CAAC,EAChDK,EAAQF,EAAS,IAChBC,EAAY,MAIVA,EAAY,MAAM,IAAI,QAAUE,EAAM,IAHpC,EAIV,EAEKC,EAAQJ,EAAS,IACrBC,EAAY,OAAO,SAAS,WAAW,MAAM,EACzCI,EAAUN,EAAQ,KAAK,EACvBO,EAAWP,EAAQ,KAAK,CAAA,mDAK5BQ,EAMaC,EAAA,CALV,GAAIJ,EAAA,MACL,MAAKK,EAAA,CAAC,sBAAqB,CAAA,SACPP,EAAA,MAAK,CAAA,CAAA,aAEzB,IAAiD,CAAjDQ,EAAiD,SAAjDC,EAAiDC,EAAnBb,EAAA,KAAO,EAAA,CAAA,CAAA,6RCnBzC,MAAMc,EAASC,EAAA,EACTC,EAAgBC,EAAA,EAEhBC,EAAWjB,EAAS,IAAM,CAC9B,GAAI,CAACe,EAAc,MACjB,MAAO,GAGT,IAAIG,EAAM,EACV,SAAW,CAACC,CAAM,IAAKJ,EAAc,MAAM,SACrCI,EAAO,IAAI,QAAUhB,EAAM,MAC7Be,GAAO,GAIX,OAAOA,CACT,CAAC,EAEKE,EAAiBC,EAAA,EACjBC,EAAYtB,EAAS,IAAM,CAC/B,MAAMuB,EAASH,EAAe,MAE9B,OAAKG,EAIEA,EAAO,MAAQ,GAAKA,EAAO,MAAQ,GAAKA,EAAO,WAAa,EAH1D,EAIX,CAAC,EAED,SAASC,GAAiB,CACxBC,EAAA,EACAZ,EAAO,KAAKa,CAAW,CACzB,CAEA,OAAAC,EAAY,IAAM,CACZZ,EAAc,OAAO,OAAS,GAEhCF,EAAO,QAAQe,CAAS,CAE5B,CAAC,UAICC,EAAA,EAAAC,EA8BU,UA9BVnB,EA8BU,CA7BCoB,EAAAhB,CAAA,OAATe,EAUI,IAAAE,EAAA,eAVoB,aAEtB,EAAA,GAAAtB,EAEC,OAFDuB,EAECrB,EADKmB,KAAc,IAAI,EAAG,SAAM,CAAA,gBAChC,SACI,EAAA,GAAgBd,EAAA,MAAQ,OAAxBa,EAIJI,EAAA,CAAA,IAAA,GAAA,eAJkC,cAEjC,EAAA,GAAAxB,EACC,OADDyB,EACCvB,EADuCK,EAAA,KAAQ,EAAG,OAAI,CAAA,gBACtD,IAAC,EAAA,EAAA,8BACH,KACH,EAAA,EAAA,aAEUc,EAAAhB,CAAA,GAAVc,IAAAC,EAIK,KAJLM,EAIK,EAHHP,EAAA,EAAA,EAAAC,EAEKI,EAAA,KAAAG,EAF2BN,EAAAhB,CAAA,EAAa,CAAA,CAAjCuB,EAAQC,CAAO,SAA3BT,EAEK,KAAA,CAF2C,IAAKQ,GAAM,CACzDE,EAA0DC,EAAA,CAAtC,UAASH,EAAS,QAAAC,CAAA,sDAIjCjB,EAAA,OAATO,EAAA,EAAAC,EAEI,MAFgB,2EAEpB,YAEApB,EAMM,MANNgC,EAMM,CALapB,EAAA,WAAjBf,EAEYoC,EAAA,OAFiB,uBAAOnB,EAAA,EAAc,aAAI,IAC7C,GAD6C,WAC7CZ,EAAGmB,EAAAa,CAAA,CAAQ,EAAG,UACvB,CAAA,CAAA,mBAEAJ,EAAoCK,EAAA,CAAd,YAAA,GAAW,CAAA,6GClFrCf,EAMU,UAAA,KAAA,aALRpB,EAES,SAAA,CAFD,MAAM,kBAAgB,CAC5BA,EAAqC,KAAA,CAAjC,MAAM,OAAA,EAAQ,gBAAc,CAAA,OAGlC8B,EAAiBM,CAAA,CAAA"}