import{m as B,x as G,B as b,c as w,d as V,h as R,w as M,u as I,A as z,o as t,b as W,G as Q,_ as S,q as Y,a,l as K,F as i,f as r,t as L,s as U,e as u,N as J,Q as X,H as Z,I as c,g as N,R as h,K as x}from"./index-chiovaS4.js";import{d as D,i as O}from"./fsrs-CLWAx46U.js";import{u as _,d as P,l as nn}from"./db-1SYsvhON.js";function*en(...g){const e=g.map(n=>n[Symbol.iterator]());try{let n=e.map(o=>o.next());for(;!n.some(({done:o})=>o);)yield n.map(({value:o})=>o),n=e.map(o=>o.next())}finally{e.forEach(n=>{typeof n.return=="function"&&n.return()})}}function En(g){const e=B(null);return G(()=>b(g),async n=>{var l;if(!n){e.value=null;return}if(n===((l=e.value)==null?void 0:l.codepoint))return;const o=n.toString(16).padStart(5,"0"),p=await(await fetch(`/data/kanji-v1/${o}.json`)).json();e.value=p},{immediate:!0}),e}function Pn(g){const e=B(null);return G(()=>b(g),async n=>{if(!n){e.value=null;return}const o=n.toString(16).padStart(5,"0"),p=await(await fetch(`/data/kanji-vocab-v1/${o}.json`)).json();e.value=p},{immediate:!0}),e}function qn(g){const e=B(null);return G(()=>b(g),async n=>{if(!n){e.value=null;return}const s=await(await fetch(`/data/words-v1/${n}.json`)).json();e.value=s},{immediate:!0}),e}function Mn(g){const e=B([]);return G(()=>b(g),async n=>{if(!n){e.value=[];return}const s=await(await fetch(`/data/words-sentences-v1/${n}.json`)).json();e.value=s},{immediate:!0}),e}function tn(g,e={}){return w(()=>{var p,l;const n=b(e.kanji),{writings:o}=b(g)??{};if(!o)return null;let s=null;for(const d of o){if(!s){s=d;continue}if(n){if(!d.text.includes(n))continue;if(!(s!=null&&s.text.includes(n))){s=d;continue}}(p=d.priority)!=null&&p.freq&&d.priority.freq<(((l=s.priority)==null?void 0:l.freq)??Number.POSITIVE_INFINITY)&&(s=d)}return s==null?void 0:s.text})}function an(g){return w(()=>{var o,s;const{readings:e}=b(g)??{};if(!e)return null;let n=null;for(const p of e){if(!n){n=p;continue}(o=p.priority)!=null&&o.freq&&p.priority.freq<(((s=n.priority)==null?void 0:s.freq)??Number.POSITIVE_INFINITY)&&(n=p)}return n==null?void 0:n.text})}function On(g,e={}){const n=tn(g,e),o=an(g),s=D(()=>{var l,d;return(d=(l=b(g))==null?void 0:l.writings)==null?void 0:d.map(({text:v})=>v).join("")}),p=w(()=>{const l=b(e.forceReading),d=b(e.kanji);return v=>{if(l&&d&&v.includes(d))return!1;for(const m of v)if(O(m)&&!s.has(m))return!1;return!0}});return w(()=>{const{furigana:l}=b(g)??{};let d;!o.value||!n.value?d=l==null?void 0:l.at(0):d=l==null?void 0:l.find(j=>j.writing===n.value&&j.reading===o.value),d||(d=l==null?void 0:l.at(0));const v=(d==null?void 0:d.furigana)??[{ruby:n.value??o.value??""}];let m=!1;return v.map(({ruby:j,rt:C})=>{const T=m;return m=!1,C?j==="々"&&T?{ruby:j}:p.value(j)?(m=!0,{ruby:j}):{ruby:j,rt:C}:{ruby:j}})})}const rn=V({__name:"BookmarkWordButton",props:{wordId:{},reading:{}},setup(g){const e=g,{result:n}=_(w(()=>{const s=e.wordId;return async()=>await(await P).count("bookmarked-words",s)>0}));async function o(){n.value?(await P).delete("bookmarked-words",e.wordId):(await P).add("bookmarked-words",{wordId:e.wordId,reading:e.reading,bookmarkedAt:new Date}),nn.postMessage("word-bookmarked")}return(s,p)=>(t(),R(z,{"aria-pressed":I(n),class:"bookmark-button",onClick:p[0]||(p[0]=l=>o())},{default:M(()=>[W(Q,{icon:I(n)?"star-filled":"star"},null,8,["icon"])]),_:1},8,["aria-pressed"]))}}),An=S(rn,[["__scopeId","data-v-5945e700"]]);function on(g){const e=B(null);return G(()=>b(g),async n=>{const s=await(await fetch(`/data/sentences-v1/${n}.json`)).json();e.value=s},{immediate:!0}),e}const sn={key:0,class:"placeholder"},ln=V({__name:"MaybeHideKanji",props:{str:{},kanji:{default:null},hide:{type:Boolean,default:!1},link:{type:Boolean,default:!1}},setup(g){return(e,n)=>{const o=Y("RouterLink");return e.link?(t(!0),a(i,{key:0},K(e.str,s=>(t(),a(i,null,[I(O)(s)?(t(),R(o,{key:0,to:I(U)(s),class:"link"},{default:M(()=>[r(L(s),1)]),_:2},1032,["to"])):(t(),a(i,{key:1},[r(L(s),1)],64))],64))),256)):!e.kanji||!e.hide?(t(),a(i,{key:1},[r(L(e.str),1)],64)):(t(!0),a(i,{key:2},K(e.str,s=>(t(),a(i,null,[s===e.kanji?(t(),a("span",sn,"◌")):(t(),a(i,{key:1},[r(L(s),1)],64))],64))),256))}}}),A=S(ln,[["__scopeId","data-v-46882cf0"]]),un={key:0},dn={key:0},gn={key:1},q=V({__name:"VocabularyWordFurigana",props:{furigana:{},kanji:{},hideKanji:{type:Boolean},hideReading:{type:Boolean},linkKanji:{type:Boolean}},setup(g){const e=g;function n(o,s){var p;return!e.hideReading||!e.kanji?!1:o==="々"&&((p=e.furigana.at(s-1))==null?void 0:p.ruby)===e.kanji?!0:o.includes(e.kanji)}return(o,s)=>(t(!0),a(i,null,K(o.furigana,({ruby:p,rt:l},d)=>(t(),a(i,null,[l?(t(),a("ruby",un,[W(A,{hide:o.hideKanji,kanji:o.kanji,str:p,link:o.linkKanji},null,8,["hide","kanji","str","link"]),s[0]||(s[0]=u("rp",null,"(",-1)),n(p,d)?(t(),a("rt",dn,"◌")):(t(),a("rt",gn,L(l),1)),s[1]||(s[1]=u("rp",null,")",-1))])):(t(),R(A,{key:1,hide:o.hideKanji,kanji:o.kanji,str:p,link:o.linkKanji},null,8,["hide","kanji","str","link"]))],64))),256))}}),fn={key:0,class:"vocabulary-sentence"},pn={lang:"ja",class:"sentence"},kn=V({__name:"VocabularySentence",props:{sentenceId:{},hideKanji:{},hideReading:{},hideMeaning:{type:Boolean}},setup(g){const e=g,n=on(()=>e.sentenceId),o=D(()=>{var l;return(l=n.value)==null?void 0:l.sentence}),s=w(()=>l=>{if(e.hideKanji&&l.includes(e.hideKanji))return!1;for(const d of l)if(O(d)&&!o.has(d))return!1;return!0}),p=w(()=>l=>{let d=!1;return l.furigana.map(({ruby:v,rt:m})=>{const j=d;return d=!1,m?v==="々"&&j?{ruby:v}:s.value(v)?(d=!0,{ruby:v}):{ruby:v,rt:m}:{ruby:v}})});return(l,d)=>I(n)?(t(),a("div",fn,[u("p",pn,[(t(!0),a(i,null,K(I(n).words,v=>(t(),R(X(v.word?"RouterLink":"span"),{key:v.word,to:I(J)(v.word),class:"word"},{default:M(()=>[W(q,{furigana:p.value(v),"hide-kanji":!!l.hideKanji,"hide-reading":!!l.hideReading,kanji:l.hideKanji??l.hideReading},null,8,["furigana","hide-kanji","hide-reading","kanji"])]),_:2},1032,["to"]))),128))]),Z(u("p",{lang:"en",class:"translation"},L(I(n).meaning),513),[[c,!l.hideMeaning]])])):N("",!0)}}),Fn=S(kn,[["__scopeId","data-v-c9f5bedd"]]),vn={class:"pos-tag"},yn=V({__name:"PartOfSpeechTag",props:{tag:{}},setup(g){return(e,n)=>(t(),a("span",vn,[e.tag==="adj-f"?(t(),a(i,{key:0},[r(" noun or prenominal verb")],64)):e.tag==="adj-i"?(t(),a(i,{key:1},[n[0]||(n[0]=u("i",{lang:"ja-Latn"},"i",-1)),n[1]||(n[1]=r(" adjective"))],64)):e.tag==="adj-ix"?(t(),a(i,{key:2},[n[2]||(n[2]=r(" adjective – ")),n[3]||(n[3]=u("i",{lang:"ja-Latn"},"yoi",-1)),n[4]||(n[4]=r("/")),n[5]||(n[5]=u("i",{lang:"ja-Latn"},"ii",-1)),n[6]||(n[6]=r(" class"))],64)):e.tag==="adj-na"?(t(),a(i,{key:3},[r(" na adjective")],64)):e.tag==="adj-nari"?(t(),a(i,{key:4},[n[7]||(n[7]=r(" formal ")),n[8]||(n[8]=u("i",{lang:"ja-Latn"},"na",-1)),n[9]||(n[9]=r("-adjective"))],64)):e.tag==="adj-no"?(t(),a(i,{key:5},[n[10]||(n[10]=r(" noun w. ")),n[11]||(n[11]=u("i",null,"no",-1)),n[12]||(n[12]=r(" particle"))],64)):e.tag==="adj-pn"?(t(),a(i,{key:6},[r(" pre-noun adjectival")],64)):e.tag==="adj-t"?(t(),a(i,{key:7},[n[13]||(n[13]=u("i",{lang:"ja-Latn"},"taru",-1)),n[14]||(n[14]=r(" adjective"))],64)):e.tag==="adv"?(t(),a(i,{key:8},[r(" adverb")],64)):e.tag==="adv-to"?(t(),a(i,{key:9},[n[15]||(n[15]=r(" adverb w. ")),n[16]||(n[16]=u("i",{lang:"ja-Latn"},"to",-1)),n[17]||(n[17]=r(" particle"))],64)):e.tag==="aux"?(t(),a(i,{key:10},[r(" auxiliary")],64)):e.tag==="aux-adj"?(t(),a(i,{key:11},[r(" auxiliary adjective")],64)):e.tag==="aux-v"?(t(),a(i,{key:12},[r(" auxiliary verb")],64)):e.tag==="conj"?(t(),a(i,{key:13},[r(" conjunction")],64)):e.tag==="cop"?(t(),a(i,{key:14},[r(" copula")],64)):e.tag==="ctr"?(t(),a(i,{key:15},[r(" counter")],64)):e.tag==="exp"?(t(),a(i,{key:16},[r(" expressions")],64)):e.tag==="int"?(t(),a(i,{key:17},[r(" interjection")],64)):e.tag==="n"?(t(),a(i,{key:18},[r(" noun")],64)):e.tag==="n-adv"?(t(),a(i,{key:19},[r(" adverbial noun")],64)):e.tag==="n-pr"?(t(),a(i,{key:20},[r(" proper noun")],64)):e.tag==="n-pref"?(t(),a(i,{key:21},[r(" noun, used as a prefix")],64)):e.tag==="n-suf"?(t(),a(i,{key:22},[r(" noun, used as a suffix")],64)):e.tag==="n-t"?(t(),a(i,{key:23},[r(" noun (temporal)")],64)):e.tag==="num"?(t(),a(i,{key:24},[r(" numeric")],64)):e.tag==="pn"?(t(),a(i,{key:25},[r(" pronoun")],64)):e.tag==="pref"?(t(),a(i,{key:26},[r(" prefix")],64)):e.tag==="prt"?(t(),a(i,{key:27},[r(" particle")],64)):e.tag==="suf"?(t(),a(i,{key:28},[r(" suffix")],64)):e.tag==="uk"?(t(),a(i,{key:29},[r(" Usually written with kana")],64)):e.tag==="v-unspec"?(t(),a(i,{key:30},[r(" verb")],64)):e.tag==="v1"?(t(),a(i,{key:31},[r(" Ichidan verb")],64)):e.tag==="v1-s"?(t(),a(i,{key:32},[n[18]||(n[18]=r(" Ichidan verb – ")),n[19]||(n[19]=u("i",{lang:"ja-Latn"},"kureru",-1))],64)):e.tag==="v5aru"?(t(),a(i,{key:33},[n[20]||(n[20]=r(" Godan verb – ")),n[21]||(n[21]=u("i",{lang:"ja-Latn"},"-aru",-1))],64)):e.tag==="v5b"?(t(),a(i,{key:34},[r(" Godan verb")],64)):e.tag==="v5g"?(t(),a(i,{key:35},[r(" Godan verb")],64)):e.tag==="v5k"?(t(),a(i,{key:36},[r(" Godan verb")],64)):e.tag==="v5k-s"?(t(),a(i,{key:37},[n[22]||(n[22]=r(" Godan verb – ")),n[23]||(n[23]=u("i",{lang:"ja-Latn"},"iku",-1)),n[24]||(n[24]=r("/")),n[25]||(n[25]=u("i",{lang:"ja-Latn"},"yuku",-1))],64)):e.tag==="v5m"?(t(),a(i,{key:38},[r(" Godan verb")],64)):e.tag==="v5n"?(t(),a(i,{key:39},[r(" Godan verb")],64)):e.tag==="v5r"?(t(),a(i,{key:40},[n[26]||(n[26]=r(" Godan verb with ")),n[27]||(n[27]=u("i",{lang:"ja-Latn"},"ru",-1)),n[28]||(n[28]=r(" ending"))],64)):e.tag==="v5r-i"?(t(),a(i,{key:41},[n[29]||(n[29]=r(" Godan verb with ")),n[30]||(n[30]=u("i",{lang:"ja-Latn"},"ru",-1)),n[31]||(n[31]=r(" ending (irregular)"))],64)):e.tag==="v5s"?(t(),a(i,{key:42},[r(" Godan verb")],64)):e.tag==="v5t"?(t(),a(i,{key:43},[r(" Godan verb")],64)):e.tag==="v5u"?(t(),a(i,{key:44},[r(" Godan verb")],64)):e.tag==="v5u-s"?(t(),a(i,{key:45},[n[32]||(n[32]=r(" Godan verb with ")),n[33]||(n[33]=u("i",{lang:"ja-Latn"},"u",-1)),n[34]||(n[34]=r(" ending (special class)"))],64)):e.tag==="v5uru"?(t(),a(i,{key:46},[n[35]||(n[35]=r(" Godan verb – ")),n[36]||(n[36]=u("i",{lang:"ja-Latn"},"Uru",-1)),n[37]||(n[37]=r(" old class verb"))],64)):e.tag==="vi"?(t(),a(i,{key:47},[r(" intransitive verb")],64)):e.tag==="vk"?(t(),a(i,{key:48},[n[38]||(n[38]=u("i",{lang:"ja-Latn"},"Kuru",-1)),n[39]||(n[39]=r(" verb"))],64)):e.tag==="vn"?(t(),a(i,{key:49},[n[40]||(n[40]=r(" irregular ")),n[41]||(n[41]=u("i",{lang:"ja-Latn"},"nu",-1)),n[42]||(n[42]=r(" verb"))],64)):e.tag==="vr"?(t(),a(i,{key:50},[n[43]||(n[43]=r(" irregular ")),n[44]||(n[44]=u("i",{lang:"ja-Latn"},"ru",-1)),n[45]||(n[45]=r(" verb"))],64)):e.tag==="vs"?(t(),a(i,{key:51},[n[46]||(n[46]=u("i",{lang:"ja-Latn"},"suru",-1)),n[47]||(n[47]=r(" verb"))],64)):e.tag==="vs-c"?(t(),a(i,{key:52},[n[48]||(n[48]=u("i",{lang:"ja-Latn"},"su",-1)),n[49]||(n[49]=r(" verb—precursor to the modern ")),n[50]||(n[50]=u("i",{lang:"ja-Latn"},"suru",-1))],64)):e.tag==="vs-i"?(t(),a(i,{key:53},[n[51]||(n[51]=u("i",{lang:"ja-Latn"},"suru",-1)),n[52]||(n[52]=r(" verb – included"))],64)):e.tag==="vs-s"?(t(),a(i,{key:54},[n[53]||(n[53]=u("i",{lang:"ja-Latn"},"suru",-1)),n[54]||(n[54]=r(" verb – special class"))],64)):e.tag==="vt"?(t(),a(i,{key:55},[r(" transitive verb")],64)):e.tag==="vz"?(t(),a(i,{key:56},[n[55]||(n[55]=r(" Ichidan verb – ")),n[56]||(n[56]=u("i",{lang:"ja-Latn"},"zuru",-1)),n[57]||(n[57]=r(" verb"))],64)):N("",!0)]))}}),F=S(yn,[["__scopeId","data-v-ee320153"]]),jn={class:"vocabulary-word-meaning"},mn={class:"meaning-pos"},bn={class:"glossary"},wn={class:"glossary-word"},In=V({__name:"VocabularyWordMeaning",props:{meaning:{}},setup(g){return(e,n)=>(t(),a("div",jn,[u("div",mn,[(t(!0),a(i,null,K(e.meaning.pos,o=>(t(),R(F,{tag:o},null,8,["tag"]))),256)),e.meaning.kanaPreferred?(t(),R(F,{key:0,tag:"uk"})):N("",!0)]),u("div",bn,[(t(!0),a(i,null,K(e.meaning.glossary,o=>(t(),a("span",wn,L(o),1))),256))])]))}}),Dn=S(In,[["__scopeId","data-v-b323a088"]]),$n={key:0,class:"word-writing-details popover-container"},Ln=["popovertarget"],Bn={class:"writing-select-count"},Kn=["id"],Vn=["disabled"],Rn={class:"additional-writing"},Sn=["disabled","onClick"],Wn=["disabled","onClick"],Gn=V({__name:"WordWritingSelect",props:{word:{},default:{},modelValue:{}},emits:["update:modelValue"],setup(g){h(k=>({"625ae786":I(o)}));const e=g,n=x(),o=`--${n}`.replace(":","-anchor-"),s=w(()=>{var k;return((k=e.word.writings)==null?void 0:k.filter(f=>f.irregular||f.outdated||f.searchOnly).map(({text:f})=>f))??[]}),p=w(()=>{var k;return((k=e.word.readings)==null?void 0:k.filter(f=>f.irregular||f.outdated||f.searchOnly).map(({text:f})=>f))??[]});function l(k,f){if(k.length!==f.length)return!1;for(const[y,$]of en(k,f))if(y.ruby!==$.ruby||y.rt!==$.rt)return!1;return!0}const d=w(()=>{var k;return((k=e.word.furigana)==null?void 0:k.filter(f=>!l(e.default,f.furigana)&&!s.value.includes(f.writing)&&!p.value.includes(f.reading)))??[]}),v=w(()=>{var k;return((k=e.word.readings)==null?void 0:k.filter(f=>{var y;return!f.irregular&&!f.outdated&&!f.searchOnly&&!((y=e.word.furigana)!=null&&y.some($=>f.text===$.reading))}))??[]}),m=B(null),j=B(null),C=B(!1);function T(k){C.value=k.newState==="open"}function H(k){var f,y;if(k.newState==="open"&&!("anchorName"in document.documentElement.style)){const $=(f=m.value)==null?void 0:f.getBoundingClientRect(),E=(y=j.value)==null?void 0:y.style;E&&$&&(E.insetBlockStart=`${$.bottom+window.scrollY}px`,E.insetInlineEnd=`calc(100% - ${$.right}px)`)}}return(k,f)=>d.value.length+v.value.length>0?(t(),a("div",$n,[u("button",{ref_key:"toggleButton",ref:m,title:"Additional Writings",class:"toggle-button",popovertarget:I(n)},[f[1]||(f[1]=u("span",{class:"writing-select-icon"},"か",-1)),u("small",Bn,"(+"+L(d.value.length+v.value.length+1)+")",1)],8,Ln),u("ul",{id:I(n),ref_key:"popoverEl",ref:j,class:"writing-list popover",popover:"",onBeforetoggle:H,onToggle:T},[u("li",null,[u("button",{class:"select-button",disabled:k.modelValue===null,onClick:f[0]||(f[0]=y=>k.$emit("update:modelValue",null))},[W(q,{furigana:k.default},null,8,["furigana"])],8,Vn)]),(t(!0),a(i,null,K(d.value,y=>(t(),a("li",Rn,[u("button",{class:"select-button",disabled:k.modelValue===y.furigana,onClick:$=>k.$emit("update:modelValue",y.furigana)},[W(q,{furigana:y.furigana},null,8,["furigana"])],8,Sn)]))),256)),(t(!0),a(i,null,K(v.value,y=>(t(),a("li",null,[u("button",{class:"select-button",disabled:k.modelValue===y.text,onClick:$=>k.$emit("update:modelValue",y.text)},L(y.text),9,Wn)]))),256))],40,Kn)])):N("",!0)}}),Hn=S(Gn,[["__scopeId","data-v-6cabb85a"]]);export{An as B,Fn as V,Hn as W,q as _,Pn as a,Mn as b,qn as c,On as d,Dn as e,En as u};
