import{c as z}from"./fsrs-D14ruAop.js";import{d as M,g as E}from"./reviews-C0tp5JDi.js";import{q as V,I as N,c as b,W as x,d as B,i as K,w as P,u as w,A as H,b as R,J as U,o as t,_ as L,a,F as r,l as $,h as i,t as I,m as Y,z as Q,e as u,g as S,U as J,C as X,p as Z,V as h,K as _,L as ee}from"./index-3SZaU-iL.js";import{u as ne,d as q,l as F}from"./db-CmzCis4b.js";function*te(...n){const s=n.map(e=>e[Symbol.iterator]());try{let e=s.map(o=>o.next());for(;!e.some(({done:o})=>o);)yield e.map(({value:o})=>o),e=s.map(o=>o.next())}finally{s.forEach(e=>{typeof e.return=="function"&&e.return()})}}function Pe(n,s){return e=>{const o=new Map;for(const l of e){const f=n(l);let g=o.get(f);g||(g=[],o.set(f,g)),g.push(s?s(l):l)}return o}}function Ee(n){const s=V(null);return N(()=>x(n),async e=>{if(!e){s.value=null;return}const o=await fetch(`/data/words-v1/${e}.json`);if(!o.ok||!o.headers.get("Content-Type")?.startsWith("application/json")){console.error("failed getting word:",n);return}try{const l=await o.json();s.value=l}catch{console.error("failed getting word:",n)}},{immediate:!0}),s}function qe(n){const s=V([]);return N(()=>x(n),async e=>{if(!e){s.value=[];return}const o=await fetch(`/data/words-sentences-v2/${e}.json`);if(!o.ok||!o.headers.get("Content-Type")?.startsWith("application/json")){console.error("failed getting sentences for word:",e);return}try{const l=await o.json();s.value=l}catch{console.error("failed getting sentences for word:",e)}},{immediate:!0}),s}function ae(n,s={}){return b(()=>{const e=x(s.kanji),{writings:o}=x(n)??{};if(!o)return null;let l=null;for(const f of o){if(!l){l=f;continue}if(e){if(!f.text.includes(e))continue;if(!l?.text.includes(e)){l=f;continue}}f.priority?.freq&&f.priority.freq<(l.priority?.freq??Number.POSITIVE_INFINITY)&&(l=f)}return l?.text})}function ie(n){return b(()=>{const{readings:s}=x(n)??{};if(!s)return null;let e=null;for(const o of s){if(!e){e=o;continue}o.priority?.freq&&o.priority.freq<(e.priority?.freq??Number.POSITIVE_INFINITY)&&(e=o)}return e?.text})}function Fe(n,s={}){const e=ae(n,s),o=ie(n),l=z(()=>x(n)?.writings?.map(({text:g})=>g).join("")),f=b(()=>{const g=x(s.forceReading),k=x(s.kanji);return y=>{if(g&&k&&y.includes(k))return!1;for(const c of y)if(M(c)&&!l.has(c))return!1;return!0}});return b(()=>{const{furigana:g}=x(n)??{};let k;!o.value||!e.value?k=g?.at(0):k=g?.find(m=>m.writing===e.value&&m.reading===o.value),k||(k=g?.at(0));const y=k?.furigana??[{ruby:e.value??o.value??""}];let c=!1;return y.map(({ruby:m,rt:C})=>{const G=c;return c=!1,C?m==="々"&&G?{ruby:m}:f.value(m)?(c=!0,{ruby:m}):{ruby:m,rt:C}:{ruby:m}})})}const re=B({__name:"BookmarkWordButton",props:{wordId:{},reading:{}},setup(n){const s=n,{result:e}=ne(b(()=>{const l=s.wordId;return async()=>await(await q).count("bookmarked-words",l)>0}));async function o(){const l=await q;if(e.value){await l.delete("bookmarked-words",s.wordId),F.postMessage("word-unbookmarked"),E([{store:"bookmarked-words",op:"delete",key:s.wordId}]);return}const f={wordId:s.wordId,reading:s.reading,bookmarkedAt:new Date};await l.add("bookmarked-words",f),F.postMessage("word-bookmarked"),E([{store:"bookmarked-words",op:"add",key:s.wordId}])}return(l,f)=>(t(),K(H,{"aria-pressed":w(e),class:"bookmark-button",onClick:f[0]||(f[0]=g=>o())},{default:P(()=>[R(U,{icon:w(e)?"star-filled":"star"},null,8,["icon"])]),_:1},8,["aria-pressed"]))}}),Oe=L(re,[["__scopeId","data-v-36e09a23"]]),oe={key:0,class:"placeholder"},se=B({__name:"MaybeHideKanji",props:{str:{},kanji:{default:null},hide:{type:Boolean,default:!1},link:{type:Boolean,default:!1}},setup(n){return(s,e)=>{const o=Q("RouterLink");return n.link?(t(!0),a(r,{key:0},$(n.str,l=>(t(),a(r,{key:l},[w(M)(l)?(t(),K(o,{key:0,to:w(Y)(l),class:"link"},{default:P(()=>[i(I(l),1)]),_:2},1032,["to"])):(t(),a(r,{key:1},[i(I(l),1)],64))],64))),128)):!n.kanji||!n.hide?(t(),a(r,{key:1},[i(I(n.str),1)],64)):(t(!0),a(r,{key:2},$(n.str,l=>(t(),a(r,{key:l},[l===n.kanji?(t(),a("span",oe,"◌")):(t(),a(r,{key:1},[i(I(l),1)],64))],64))),128))}}}),O=L(se,[["__scopeId","data-v-dd465f3e"]]),le={key:0},ue={key:0},de={key:1},T=B({__name:"VocabularyWordFurigana",props:{furigana:{},kanji:{},hideKanji:{type:Boolean},hideReading:{type:Boolean},linkKanji:{type:Boolean}},setup(n){const s=n;function e(o,l){return!s.hideReading||!s.kanji?!1:o==="々"&&s.furigana.at(l-1)?.ruby===s.kanji?!0:o.includes(s.kanji)}return(o,l)=>(t(!0),a(r,null,$(n.furigana,({ruby:f,rt:g},k)=>(t(),a(r,{key:k},[g?(t(),a("ruby",le,[R(O,{hide:n.hideKanji,kanji:n.kanji,str:f,link:n.linkKanji},null,8,["hide","kanji","str","link"]),l[0]||(l[0]=u("rp",null,"(",-1)),e(f,k)?(t(),a("rt",ue,"◌")):(t(),a("rt",de,I(g),1)),l[1]||(l[1]=u("rp",null,")",-1))])):(t(),K(O,{key:1,hide:n.hideKanji,kanji:n.kanji,str:f,link:n.linkKanji},null,8,["hide","kanji","str","link"]))],64))),128))}}),ge={class:"pos-tag"},fe=B({__name:"PartOfSpeechTag",props:{tag:{}},setup(n){return(s,e)=>(t(),a("span",ge,[n.tag==="adj-f"?(t(),a(r,{key:0},[i(" noun or prenominal verb")],64)):n.tag==="adj-i"?(t(),a(r,{key:1},[e[0]||(e[0]=u("i",{lang:"ja-Latn"},"i",-1)),e[1]||(e[1]=i(" adjective",-1))],64)):n.tag==="adj-ix"?(t(),a(r,{key:2},[e[2]||(e[2]=i(" adjective – ",-1)),e[3]||(e[3]=u("i",{lang:"ja-Latn"},"yoi",-1)),e[4]||(e[4]=i("/",-1)),e[5]||(e[5]=u("i",{lang:"ja-Latn"},"ii",-1)),e[6]||(e[6]=i(" class",-1))],64)):n.tag==="adj-na"?(t(),a(r,{key:3},[i(" na adjective")],64)):n.tag==="adj-nari"?(t(),a(r,{key:4},[e[7]||(e[7]=i(" formal ",-1)),e[8]||(e[8]=u("i",{lang:"ja-Latn"},"na",-1)),e[9]||(e[9]=i("-adjective",-1))],64)):n.tag==="adj-no"?(t(),a(r,{key:5},[e[10]||(e[10]=i(" noun w. ",-1)),e[11]||(e[11]=u("i",null,"no",-1)),e[12]||(e[12]=i(" particle",-1))],64)):n.tag==="adj-pn"?(t(),a(r,{key:6},[i(" pre-noun adjectival")],64)):n.tag==="adj-t"?(t(),a(r,{key:7},[e[13]||(e[13]=u("i",{lang:"ja-Latn"},"taru",-1)),e[14]||(e[14]=i(" adjective",-1))],64)):n.tag==="adv"?(t(),a(r,{key:8},[i(" adverb")],64)):n.tag==="adv-to"?(t(),a(r,{key:9},[e[15]||(e[15]=i(" adverb w. ",-1)),e[16]||(e[16]=u("i",{lang:"ja-Latn"},"to",-1)),e[17]||(e[17]=i(" particle",-1))],64)):n.tag==="aux"?(t(),a(r,{key:10},[i(" auxiliary")],64)):n.tag==="aux-adj"?(t(),a(r,{key:11},[i(" auxiliary adjective")],64)):n.tag==="aux-v"?(t(),a(r,{key:12},[i(" auxiliary verb")],64)):n.tag==="conj"?(t(),a(r,{key:13},[i(" conjunction")],64)):n.tag==="cop"?(t(),a(r,{key:14},[i(" copula")],64)):n.tag==="ctr"?(t(),a(r,{key:15},[i(" counter")],64)):n.tag==="exp"?(t(),a(r,{key:16},[i(" expressions")],64)):n.tag==="int"?(t(),a(r,{key:17},[i(" interjection")],64)):n.tag==="n"?(t(),a(r,{key:18},[i(" noun")],64)):n.tag==="n-adv"?(t(),a(r,{key:19},[i(" adverbial noun")],64)):n.tag==="n-pr"?(t(),a(r,{key:20},[i(" proper noun")],64)):n.tag==="n-pref"?(t(),a(r,{key:21},[i(" noun, used as a prefix")],64)):n.tag==="n-suf"?(t(),a(r,{key:22},[i(" noun, used as a suffix")],64)):n.tag==="n-t"?(t(),a(r,{key:23},[i(" noun (temporal)")],64)):n.tag==="num"?(t(),a(r,{key:24},[i(" numeric")],64)):n.tag==="pn"?(t(),a(r,{key:25},[i(" pronoun")],64)):n.tag==="pref"?(t(),a(r,{key:26},[i(" prefix")],64)):n.tag==="prt"?(t(),a(r,{key:27},[i(" particle")],64)):n.tag==="suf"?(t(),a(r,{key:28},[i(" suffix")],64)):n.tag==="uk"?(t(),a(r,{key:29},[i(" Usually written with kana")],64)):n.tag==="v-unspec"?(t(),a(r,{key:30},[i(" verb")],64)):n.tag==="v1"?(t(),a(r,{key:31},[i(" Ichidan verb")],64)):n.tag==="v1-s"?(t(),a(r,{key:32},[e[18]||(e[18]=i(" Ichidan verb – ",-1)),e[19]||(e[19]=u("i",{lang:"ja-Latn"},"kureru",-1))],64)):n.tag==="v5aru"?(t(),a(r,{key:33},[e[20]||(e[20]=i(" Godan verb – ",-1)),e[21]||(e[21]=u("i",{lang:"ja-Latn"},"-aru",-1))],64)):n.tag==="v5b"?(t(),a(r,{key:34},[i(" Godan verb")],64)):n.tag==="v5g"?(t(),a(r,{key:35},[i(" Godan verb")],64)):n.tag==="v5k"?(t(),a(r,{key:36},[i(" Godan verb")],64)):n.tag==="v5k-s"?(t(),a(r,{key:37},[e[22]||(e[22]=i(" Godan verb – ",-1)),e[23]||(e[23]=u("i",{lang:"ja-Latn"},"iku",-1)),e[24]||(e[24]=i("/",-1)),e[25]||(e[25]=u("i",{lang:"ja-Latn"},"yuku",-1))],64)):n.tag==="v5m"?(t(),a(r,{key:38},[i(" Godan verb")],64)):n.tag==="v5n"?(t(),a(r,{key:39},[i(" Godan verb")],64)):n.tag==="v5r"?(t(),a(r,{key:40},[e[26]||(e[26]=i(" Godan verb with ",-1)),e[27]||(e[27]=u("i",{lang:"ja-Latn"},"ru",-1)),e[28]||(e[28]=i(" ending",-1))],64)):n.tag==="v5r-i"?(t(),a(r,{key:41},[e[29]||(e[29]=i(" Godan verb with ",-1)),e[30]||(e[30]=u("i",{lang:"ja-Latn"},"ru",-1)),e[31]||(e[31]=i(" ending (irregular)",-1))],64)):n.tag==="v5s"?(t(),a(r,{key:42},[i(" Godan verb")],64)):n.tag==="v5t"?(t(),a(r,{key:43},[i(" Godan verb")],64)):n.tag==="v5u"?(t(),a(r,{key:44},[i(" Godan verb")],64)):n.tag==="v5u-s"?(t(),a(r,{key:45},[e[32]||(e[32]=i(" Godan verb with ",-1)),e[33]||(e[33]=u("i",{lang:"ja-Latn"},"u",-1)),e[34]||(e[34]=i(" ending (special class)",-1))],64)):n.tag==="v5uru"?(t(),a(r,{key:46},[e[35]||(e[35]=i(" Godan verb – ",-1)),e[36]||(e[36]=u("i",{lang:"ja-Latn"},"Uru",-1)),e[37]||(e[37]=i(" old class verb",-1))],64)):n.tag==="vi"?(t(),a(r,{key:47},[i(" intransitive verb")],64)):n.tag==="vk"?(t(),a(r,{key:48},[e[38]||(e[38]=u("i",{lang:"ja-Latn"},"Kuru",-1)),e[39]||(e[39]=i(" verb",-1))],64)):n.tag==="vn"?(t(),a(r,{key:49},[e[40]||(e[40]=i(" irregular ",-1)),e[41]||(e[41]=u("i",{lang:"ja-Latn"},"nu",-1)),e[42]||(e[42]=i(" verb",-1))],64)):n.tag==="vr"?(t(),a(r,{key:50},[e[43]||(e[43]=i(" irregular ",-1)),e[44]||(e[44]=u("i",{lang:"ja-Latn"},"ru",-1)),e[45]||(e[45]=i(" verb",-1))],64)):n.tag==="vs"?(t(),a(r,{key:51},[e[46]||(e[46]=u("i",{lang:"ja-Latn"},"suru",-1)),e[47]||(e[47]=i(" verb",-1))],64)):n.tag==="vs-c"?(t(),a(r,{key:52},[e[48]||(e[48]=u("i",{lang:"ja-Latn"},"su",-1)),e[49]||(e[49]=i(" verb—precursor to the modern ",-1)),e[50]||(e[50]=u("i",{lang:"ja-Latn"},"suru",-1))],64)):n.tag==="vs-i"?(t(),a(r,{key:53},[e[51]||(e[51]=u("i",{lang:"ja-Latn"},"suru",-1)),e[52]||(e[52]=i(" verb – included",-1))],64)):n.tag==="vs-s"?(t(),a(r,{key:54},[e[53]||(e[53]=u("i",{lang:"ja-Latn"},"suru",-1)),e[54]||(e[54]=i(" verb – special class",-1))],64)):n.tag==="vt"?(t(),a(r,{key:55},[i(" transitive verb")],64)):n.tag==="vz"?(t(),a(r,{key:56},[e[55]||(e[55]=i(" Ichidan verb – ",-1)),e[56]||(e[56]=u("i",{lang:"ja-Latn"},"zuru",-1)),e[57]||(e[57]=i(" verb",-1))],64)):S("",!0)]))}}),A=L(fe,[["__scopeId","data-v-ee320153"]]),ke={class:"vocabulary-word-meaning"},ye={class:"meaning-pos"},ve={class:"glossary"},me=B({__name:"VocabularyWordMeaning",props:{meaning:{}},setup(n){return(s,e)=>(t(),a("div",ke,[u("div",ye,[(t(!0),a(r,null,$(n.meaning.pos,o=>(t(),K(A,{key:o,tag:o},null,8,["tag"]))),128)),n.meaning.kanaPreferred?(t(),K(A,{key:0,tag:"uk"})):S("",!0)]),u("div",ve,[(t(!0),a(r,null,$(n.meaning.glossary,o=>(t(),a("span",{key:o,class:"glossary-word"},I(o),1))),128))])]))}}),Ae=L(me,[["__scopeId","data-v-9dd3a484"]]);function je(n){const s=V(null);return N(()=>x(n),async e=>{const o=await fetch(`/data/sentences-v1/${e}.json`);if(!o.ok||!o.headers.get("Content-Type")?.startsWith("application/json")){console.error("failed getting sentence:",n);return}try{const l=await o.json();s.value=l}catch{console.error("failed getting sentence:",n)}},{immediate:!0}),s}const ce={key:0,class:"vocabulary-sentence"},be={lang:"ja",class:"sentence"},we=B({__name:"VocabularySentence",props:{sentenceId:{},kanji:{},hideKanji:{type:Boolean},hideReading:{type:Boolean},hideMeaning:{type:Boolean}},setup(n){const s=n,e=je(()=>s.sentenceId),o=z(()=>e.value?.sentence),l=b(()=>g=>{if(s.kanji&&s.hideKanji&&g.includes(s.kanji))return!1;for(const k of g)if(M(k)&&!o.has(k))return!1;return!0}),f=b(()=>g=>{let k=!1;return g.furigana.map(({ruby:y,rt:c})=>{const m=k;return k=!1,c?y==="々"&&m?{ruby:y}:l.value(y)?(k=!0,{ruby:y}):{ruby:y,rt:c}:{ruby:y}})});return(g,k)=>w(e)?(t(),a("div",ce,[u("p",be,[(t(!0),a(r,null,$(w(e).words,y=>(t(),K(Z(y.word?"RouterLink":"span"),{key:y.word,to:w(X)(y.word),class:"word"},{default:P(()=>[R(T,{furigana:f.value(y),"hide-kanji":n.hideKanji,"hide-reading":n.hideReading,kanji:n.kanji},null,8,["furigana","hide-kanji","hide-reading","kanji"])]),_:2},1032,["to"]))),128))]),J(u("p",{lang:"en",class:"translation"},I(w(e).meaning),513),[[h,!n.hideMeaning]])])):S("",!0)}}),xe=L(we,[["__scopeId","data-v-856f392e"]]),Ie={key:0,class:"sentence-list"},$e=B({__name:"VocabularyWordMeaningSentences",props:{sentenceIds:{default:()=>[]},kanji:{default:null},hideKanji:{type:Boolean},hideReading:{type:Boolean},hideMeaning:{type:Boolean}},setup(n){return(s,e)=>n.sentenceIds.length>0?(t(),a("ul",Ie,[(t(!0),a(r,null,$(n.sentenceIds,o=>(t(),a("li",{key:o,class:"sentence-item"},[R(xe,{"sentence-id":o,kanji:n.kanji,"hide-kanji":n.hideKanji,"hide-reading":n.hideReading,"hide-meaning":n.hideMeaning},null,8,["sentence-id","kanji","hide-kanji","hide-reading","hide-meaning"])]))),128))])):S("",!0)}}),ze=L($e,[["__scopeId","data-v-2fff9b9f"]]),Be={key:0,class:"word-writing-details popover-container"},Le=["popovertarget"],We={class:"writing-select-count"},Ve=["id"],Ke=["disabled"],Re=["disabled","onClick"],Se=["disabled","onClick"],Ce=B({__name:"WordWritingSelect",props:{word:{},defaultFurigana:{},modelValue:{}},emits:["update:modelValue"],setup(n){ee(d=>({ae632862:w(o)}));const s=n,e=_(),o=`--${e}`.replace(":","-anchor-"),l=b(()=>s.word.writings?.filter(d=>d.irregular||d.outdated||d.searchOnly).map(({text:d})=>d)??[]),f=b(()=>s.word.readings?.filter(d=>d.irregular||d.outdated||d.searchOnly).map(({text:d})=>d)??[]);function g(d,j){if(d.length!==j.length)return!1;for(const[v,W]of te(d,j))if(v.ruby!==W.ruby||v.rt!==W.rt)return!1;return!0}const k=b(()=>s.word.furigana?.filter(d=>!g(s.defaultFurigana,d.furigana)&&!l.value.includes(d.writing)&&!f.value.includes(d.reading))??[]),y=b(()=>s.word.readings?.filter(d=>!d.irregular&&!d.outdated&&!d.searchOnly&&!s.word.furigana?.some(j=>d.text===j.reading))??[]),c=V(null),m=V(null),C=V(!1);function G(d){C.value=d.newState==="open"}function D(d){if(d.newState==="open"&&!("anchorName"in document.documentElement.style)){const j=c.value?.getBoundingClientRect(),v=m.value?.style;v&&j&&(v.insetBlockStart=`${j.bottom+window.scrollY}px`,v.insetInlineEnd=`calc(100% - ${j.right}px)`)}}return(d,j)=>k.value.length+y.value.length>0?(t(),a("div",Be,[u("button",{ref_key:"toggleButton",ref:c,title:"Additional Writings",class:"toggle-button",popovertarget:w(e)},[j[1]||(j[1]=u("span",{class:"writing-select-icon"},"か",-1)),u("small",We,"(+"+I(k.value.length+y.value.length+1)+")",1)],8,Le),u("ul",{id:w(e),ref_key:"popoverEl",ref:m,class:"writing-list popover",popover:"",onBeforetoggle:D,onToggle:G},[u("li",null,[u("button",{class:"select-button",disabled:n.modelValue===null,onClick:j[0]||(j[0]=v=>d.$emit("update:modelValue",null))},[R(T,{furigana:n.defaultFurigana},null,8,["furigana"])],8,Ke)]),(t(!0),a(r,null,$(k.value,(v,W)=>(t(),a("li",{key:W,class:"additional-writing"},[u("button",{class:"select-button",disabled:n.modelValue===v.furigana,onClick:p=>d.$emit("update:modelValue",v.furigana)},[R(T,{furigana:v.furigana},null,8,["furigana"])],8,Re)]))),128)),(t(!0),a(r,null,$(y.value,(v,W)=>(t(),a("li",{key:W},[u("button",{class:"select-button",disabled:n.modelValue===v.text,onClick:p=>d.$emit("update:modelValue",v.text)},I(v.text),9,Se)]))),128))],40,Ve)])):S("",!0)}}),De=L(Ce,[["__scopeId","data-v-c6ac4536"]]);export{Oe as B,Ae as V,De as W,T as _,Fe as a,qe as b,ze as c,Pe as g,Ee as u};
//# sourceMappingURL=WordWritingSelect-DnSPLHUE.js.map
