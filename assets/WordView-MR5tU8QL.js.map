{"version":3,"file":"WordView-MR5tU8QL.js","sources":["../../src/components/WordKanjiList.vue","../../src/views/WordView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed } from \"vue\";\n\nimport { isKanji } from \"../helpers/text.ts\";\nimport { Word } from \"../types.ts\";\nimport WordKanjiListItem from \"./WordKanjiListItem.vue\";\n\nconst props = defineProps<{\n  word: Word;\n}>();\n\nconst kanjiInWord = computed<Set<string>>(() => {\n  const kanji = new Set<string>();\n\n  if (!props.word.writings) {\n    return kanji;\n  }\n\n  for (const writing of props.word.writings) {\n    if (writing.irregular || writing.outdated || writing.searchOnly) {\n      continue;\n    }\n\n    for (const char of writing.text) {\n      if (isKanji(char)) {\n        kanji.add(char);\n      }\n    }\n  }\n\n  return kanji;\n});\n</script>\n\n<template>\n  <section v-if=\"kanjiInWord.size > 0\">\n    <h3>Kanji ({{ kanjiInWord.size }})</h3>\n\n    <ul class=\"kanji-list\">\n      <li v-for=\"kanji of kanjiInWord\" :key=\"kanji\">\n        <WordKanjiListItem :kanji=\"kanji\" />\n      </li>\n    </ul>\n  </section>\n</template>\n\n<style scoped>\n.kanji-list {\n  display: grid;\n  gap: 1.5em 1em;\n  grid-template-columns: repeat(3, 1fr);\n  list-style: none;\n  margin: 0;\n  padding: 0;\n\n  @media screen and (max-width: 60ch) {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  @media screen and (max-width: 45ch) {\n    display: flex;\n    flex-direction: column;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { pipe } from \"yta\";\nimport { groupBy } from \"yta/sync\";\n\nimport BookmarkWordButton from \"../components/BookmarkWordButton.vue\";\nimport VocabularyWordFurigana from \"../components/VocabularyWordFurigana.vue\";\nimport VocabularyWordMeaning from \"../components/VocabularyWordMeaning.vue\";\nimport VocabularyWordMeaningSentences from \"../components/VocabularyWordMeaningSentences.vue\";\nimport WordKanjiList from \"../components/WordKanjiList.vue\";\nimport WordWritingSelect from \"../components/WordWritingSelect.vue\";\nimport {\n  useWord,\n  useWordFurigana,\n  useWordSetenceIndex,\n} from \"../helpers/words.ts\";\nimport { Furigana } from \"../types.ts\";\n\nconst route = useRoute();\nconst wordId = computed(() => {\n  const value = route.params.wordId;\n\n  if (typeof value !== \"string\") {\n    return null;\n  }\n\n  const id = Number.parseInt(value);\n\n  if (!Number.isFinite(id)) {\n    return null;\n  }\n\n  return id;\n});\n\nconst word = useWord(wordId);\nconst preferredFurigana = useWordFurigana(word);\nconst selectedFurigana = ref<Furigana | string | null>(null);\n\nconst firstMeaning = computed(() => word.value?.meanings?.at(0));\nconst additionalMeanings = computed(() => word.value?.meanings?.slice(1));\n\nconst sentenceIndex = useWordSetenceIndex(wordId);\nconst meaningSentenceMap = computed(() => {\n  if (!sentenceIndex.value) {\n    return null;\n  }\n\n  return pipe(\n    sentenceIndex.value,\n    groupBy(\n      (entry) => entry.meaning,\n      (entry) => entry.sentence,\n    ),\n  );\n});\n\nwatch(wordId, (newId, oldId) => {\n  if (newId !== oldId) {\n    selectedFurigana.value = null;\n  }\n});\n</script>\n\n<template>\n  <article v-if=\"word\" class=\"world-view-article\">\n    <header class=\"header\">\n      <h2 class=\"title\">\n        <template v-if=\"typeof selectedFurigana === 'string'\">\n          {{ selectedFurigana }}\n        </template>\n\n        <VocabularyWordFurigana\n          v-else\n          :furigana=\"selectedFurigana || preferredFurigana\"\n          link-kanji\n        />\n      </h2>\n\n      <div class=\"actions\">\n        <BookmarkWordButton\n          :word-id=\"word.id\"\n          :reading=\"word.readings?.at(0)?.text\"\n        />\n\n        <WordWritingSelect\n          v-model=\"selectedFurigana\"\n          :word=\"word\"\n          :default-furigana=\"preferredFurigana\"\n          class=\"section\"\n        />\n      </div>\n    </header>\n\n    <div v-if=\"firstMeaning\" class=\"section\">\n      <VocabularyWordMeaning :meaning=\"firstMeaning\" />\n      <VocabularyWordMeaningSentences\n        :sentence-ids=\"meaningSentenceMap?.get(1)\"\n      />\n    </div>\n\n    <WordKanjiList v-if=\"word\" :word=\"word\" class=\"section\" />\n\n    <section\n      v-if=\"additionalMeanings && additionalMeanings.length > 0\"\n      class=\"section\"\n    >\n      <h3>Other Meanings</h3>\n\n      <ul class=\"meaning-list\">\n        <li v-for=\"(meaning, i) of word.meanings\" :key=\"i\">\n          <VocabularyWordMeaning :meaning=\"meaning\" />\n          <VocabularyWordMeaningSentences\n            :sentence-ids=\"meaningSentenceMap?.get(i + 2)\"\n          />\n        </li>\n      </ul>\n    </section>\n  </article>\n</template>\n\n<style scoped>\n.header {\n  align-items: start;\n  column-gap: 1em;\n  display: flex;\n\n  & .title {\n    font-size: 4em;\n    font-weight: 500;\n    margin: 0;\n    max-inline-size: calc(100vw - 1.5em);\n  }\n\n  & .actions {\n    align-items: end;\n    display: flex;\n    flex-direction: column;\n    margin-inline-start: auto;\n    row-gap: 1ex;\n  }\n}\n\n.world-view-article > .section {\n  margin-block: 1em 1.5em;\n}\n\n.meaning-list {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n\n  & > li:not(:first-child) {\n    margin-block-start: 1ex;\n  }\n}\n</style>\n"],"names":["props","__props","kanjiInWord","computed","kanji","writing","char","isKanji","_createElementBlock","_hoisted_1","_createElementVNode","_toDisplayString","_hoisted_2","_Fragment","_renderList","_createVNode","WordKanjiListItem","route","useRoute","wordId","value","id","word","useWord","preferredFurigana","useWordFurigana","selectedFurigana","ref","firstMeaning","additionalMeanings","sentenceIndex","useWordSetenceIndex","meaningSentenceMap","pipe","groupBy","entry","watch","newId","oldId","_unref","_openBlock","_hoisted_3","_createBlock","VocabularyWordFurigana","_hoisted_4","BookmarkWordButton","WordWritingSelect","$event","_hoisted_5","VocabularyWordMeaning","VocabularyWordMeaningSentences","WordKanjiList","_hoisted_6","_cache","_hoisted_7","meaning","i"],"mappings":"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"}