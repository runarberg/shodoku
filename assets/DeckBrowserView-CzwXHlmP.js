import{A as $}from"./index-CKpX5h9N.js";import{j as N,n as x,g as L,b as V}from"./decks-_sN1aXjG.js";import{A as F,u as P,d as q}from"./db-CBPHPZsk.js";import{b as H,c as K,d as S,e as E,f as G}from"./decks-C2JpTzAv.js";import{d as f,o as s,f as I,w as b,a as c,_ as y,k as w,H as j,c as A,l as J,p as Q,b as r,u as i,t as D,e as l,F as h,j as R,g as _,q as z,h as M,I as O}from"./index-ChzRPr1n.js";import"./fsrs-C70PUnKv.js";const U={key:0,class:"loading-icon"},W=f({__name:"DeckAddButton",props:{added:{type:Boolean,default:!1},adding:{type:Boolean,default:!1}},emits:["add","remove"],setup(m,{emit:t}){const e=m,u=t;function p(){e.added?u("remove"):u("add")}return(o,g)=>(s(),I($,{"aria-label":o.added?"Remove Deck":"Add Deck",class:"add-button",filled:o.added,disabled:o.adding,onClick:p},{default:b(()=>[o.adding?(s(),c("span",U,"æ™‚")):(s(),I(F,{key:1,icon:"plus"}))]),_:1},8,["aria-label","filled","disabled"]))}}),T=y(W,[["__scopeId","data-v-ffaf72fb"]]),X=["aria-labelledby"],Y={class:"controls"},Z=["id"],ee={class:"kanji-list"},ae=f({__name:"DeckBrowserItem",props:{deck:{},contentPath:{},addingCategory:{type:Boolean}},setup(m){const t=m,e=w(!1),u=j(),p=w(null);async function o(){if(!p.value)return;const d=p.value.map(a=>a.codePointAt(0)??NaN);e.value=!0;try{await K({...t.deck,cards:d})}catch(a){console.error(a)}finally{e.value=!1}}async function g(){e.value=!0;try{await S(t.deck.name)}catch(d){console.error(d)}finally{e.value=!1}}const B=H(()=>t.deck.name),C=A(()=>B.value!=null);return J(()=>t.contentPath,async d=>{const k=await(await fetch(d)).text();p.value=k.split(`
`).filter(n=>n)},{immediate:!0}),(d,a)=>{const k=Q("RouterLink");return s(),c("article",{"aria-labelledby":i(u)},[r("div",Y,[r("strong",{id:i(u)},D(d.deck.label),9,Z),l(T,{adding:e.value||d.addingCategory,added:C.value,onAdd:o,onRemove:g},null,8,["adding","added"])]),r("ol",ee,[(s(!0),c(h,null,R(p.value,n=>(s(),c("li",{key:n,class:"kanji"},[l(k,{to:i(z)(n)},{default:b(()=>[_(D(n),1)]),_:2},1032,["to"])]))),128))])],8,X)}}}),te=y(ae,[["__scopeId","data-v-444c5444"]]),se=["aria-labelledby"],oe={class:"controls"},ne=["id"],ce={key:0,class:"deck-list"},re=f({__name:"DeckBrowserCategory",props:{title:{},category:{},deckTemplates:{}},setup(m){const t=m,e=w(!1),u=j(),{result:p}=P(A(()=>{const{category:a}=t;return async()=>(await q).transaction("decks").store.index("category").count(a)})),o=w(!1),g=A(()=>(p.value??0)>=t.deckTemplates.length);async function B(){o.value=!0;try{await E(t.category,t.deckTemplates)}catch(a){console.error(a)}finally{o.value=!1}}async function C(){o.value=!0;try{await G(t.category)}catch(a){console.error(a)}finally{o.value=!1}}function d({name:a,label:k,priority:n}){return{name:a,label:k,priority:n,category:t.category}}return(a,k)=>(s(),c("article",{"aria-labelledby":i(u)},[r("div",oe,[r("strong",{id:i(u),class:"title"},D(a.title),9,ne),l(T,{adding:o.value,added:g.value,onAdd:B,onRemove:C},null,8,["adding","added"])]),l($,{class:"expand-button","aria-pressed":e.value,onClick:k[0]||(k[0]=n=>e.value=!e.value)},{default:b(()=>[e.value?(s(),c(h,{key:0},[_("Hide ")],64)):(s(),c(h,{key:1},[_("Show ")],64)),_(" ("+D(a.deckTemplates.length)+" decks) ",1)]),_:1},8,["aria-pressed"]),e.value?(s(),c("ol",ce,[(s(!0),c(h,null,R(a.deckTemplates,n=>(s(),c("li",{key:n.name},[l(te,{deck:d(n),"content-path":n.content,"adding-category":o.value},null,8,["deck","content-path","adding-category"])]))),128))])):M("",!0)],8,se))}}),v=y(re,[["__scopeId","data-v-caf77e95"]]),le={class:"categories"},de=f({__name:"DeckBrowser",setup(m){return(t,e)=>(s(),c("ul",le,[r("li",null,[l(v,{title:"JLPT",category:"jlpt","deck-templates":i(N)},null,8,["deck-templates"])]),r("li",null,[l(v,{title:"News Frequency",category:"news","deck-templates":i(x)},null,8,["deck-templates"])]),r("li",null,[l(v,{title:"Genki",category:"genki","deck-templates":i(L)},null,8,["deck-templates"])]),r("li",null,[l(v,{title:"Basic Kanji Book",category:"basic-kanji","deck-templates":i(V)},null,8,["deck-templates"])])]))}}),ie=y(de,[["__scopeId","data-v-898009ac"]]),ue={class:"article-header"},pe={class:"actions"},ke=f({__name:"DeckBrowserView",setup(m){return(t,e)=>(s(),c("article",null,[r("header",ue,[e[1]||(e[1]=r("h2",{class:"title"},"Add Decks",-1)),r("div",pe,[l($,{to:i(O),"prefix-icon":"arrow-left"},{default:b(()=>e[0]||(e[0]=[_(" Back to your decks ")])),_:1},8,["to"])])]),l(ie)]))}}),he=y(ke,[["__scopeId","data-v-a1e5f41b"]]);export{he as default};
