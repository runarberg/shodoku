import{h as v,r as y,t as b,S as l,d as R,W as D,e as k,k as M}from"./reviews-BjQG9Nhh.js";import{u as P,d}from"./db-CaAx7W_9.js";import{c as w,W as g,X as h,I as z}from"./index-sZE7bAWT.js";function p(){return w(()=>{const e=v({enable_fuzz:y.value});return b(e)})}function S(e,s){const{result:t}=P(w(()=>{const n=g(e);return async()=>{const r=new Map;if(!n)return r;const i=(await d).transaction("progress").store;for(const a of s){const o=await i.get([n,a]);o&&r.set(a,o)}return r}}),new Map);return t}function W(e,s,t=new Date){return e?e.fsrs.state===l.Learning?"learning":e.fsrs.state===l.Relearning?"relearning":s.get_retrievability(e.fsrs,t,!1):null}function C(e,s){const t=p(),n=S(e,s);return w(()=>{const r=new Date,i=t.value,a=new Map;for(const[o,u]of n.value)a.set(o,W(u,i,r));return a})}function F(e){const s=p(),t=h(new Set);return z([()=>g(e),k,M],async([n,r,i])=>{if(!n)return;const a=new Date,o=i/100,u=new Date(Date.now()+r*D);for(const f of n)if(R(f)){const m=f.codePointAt(0)??0,c=await(await d).get("progress",[m,"kanji-read"]);if(c){if(c.fsrs.state!==l.Review)continue;s.value.get_retrievability(c.fsrs,a,!1)>o&&c.fsrs.due>u&&t.add(f)}}},{immediate:!0}),t}export{C as a,S as b,F as c,p as u};
//# sourceMappingURL=fsrs-BAHU2VgB.js.map
