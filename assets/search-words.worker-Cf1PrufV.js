(function(){"use strict";const S=new RegExp("\\p{Script=Han}","u"),w=/[\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Han}\u{2e80}-\u{2fd5}\u{3000}-\u{303f}\u{31f0}-\u{31ff}\u{3220}-\u{3243}\u{3280}-\u{337f}\u{ff5f}-\u{ff9f}\u{ff01}-\u{ff5e}]/u;function R(n){return w.test(n)}function h(n){return S.test(n)}const y=20,f="␟",g="␞",m="␝",E=fetch("/data/index/words-v1.usv").then(n=>n.text());function x(n,t){const i=n.indexOf("(");return i===-1?!1:n.indexOf(t)>i}async function C(n){const t=await E;let i=0,e=0,o=0,l=0,p=0,u=null;for(const d of t){const c=d.length;if(d===f){if(!u){let s,a,r;n.reading&&o===1?(s=t.slice(l,e),a=s,r=n.reading):n.writing&&o===2?(s=t.slice(l,e),a=s,r=n.writing):n.glossary&&o===3&&(s=t.slice(l,e),a=s.toLowerCase(),r=n.glossary),r&&s&&(a!=null&&a.includes(r))&&!(n.glossary&&x(a,r))&&(u=s)}l=e+c}else if(d===g)o+=1,l=e+c;else if(d===m){if(u){const s=t.slice(p,e).trim(),[a,r,I,K]=s.split(`${f}${g}`),O={id:Number.parseInt(a),phrase:n.phrase,match:u,readings:r.split(f),writings:I.split(f),glossary:K.split(f)};if(self.postMessage(O),i+=1,u=null,i===y)break}o=0,l=e+c,p=e+c}e+=c}}addEventListener("message",async n=>{const{data:t}=n,i=h(t),e=!i&&R(t);C({phrase:t,writing:i?t:null,reading:e?t:null,glossary:!i&&!e?t.toLowerCase():null})})})();
