import{d as f,o as s,f as I,w as b,a as c,E as N,A as $,_ as y,k as w,J as j,c as A,l as x,p as L,b as r,u as i,t as D,e as l,F as h,j as R,g as _,q as V,h as F,K as P}from"./index-BOg8xiez.js";import{j as q,n as K,g as E,b as J}from"./decks-GrwULuka.js";import{d as S}from"./channels-Cq-RpcWF.js";import{b as G,c as H,d as Q,e as z,f as M}from"./decks-zXNpY7XZ.js";import{u as O}from"./db-3hrw4Sm5.js";import"./index-TyJKmroR.js";import"./fsrs-CiIXS6Cp.js";import"./reviews-vBeA8rIc.js";const U={key:0,class:"loading-icon"},W=f({__name:"DeckAddButton",props:{added:{type:Boolean,default:!1},adding:{type:Boolean,default:!1}},emits:["add","remove"],setup(m,{emit:a}){const e=m,u=a;function p(){e.added?u("remove"):u("add")}return(o,g)=>(s(),I($,{"aria-label":o.added?"Remove Deck":"Add Deck",class:"add-button",filled:o.added,disabled:o.adding,onClick:p},{default:b(()=>[o.adding?(s(),c("span",U,"æ™‚")):(s(),I(N,{key:1,icon:"plus"}))]),_:1},8,["aria-label","filled","disabled"]))}}),T=y(W,[["__scopeId","data-v-ffaf72fb"]]),X=["aria-labelledby"],Y={class:"controls"},Z=["id"],ee={class:"kanji-list"},te=f({__name:"DeckBrowserItem",props:{deck:{},contentPath:{},addingCategory:{type:Boolean}},setup(m){const a=m,e=w(!1),u=j(),p=w(null);async function o(){if(!p.value)return;const d=p.value.map(t=>t.codePointAt(0)??NaN);e.value=!0;try{await H({...a.deck,cards:d})}catch(t){console.error(t)}finally{e.value=!1}}async function g(){e.value=!0;try{await Q(a.deck.name)}catch(d){console.error(d)}finally{e.value=!1}}const B=G(()=>a.deck.name),C=A(()=>B.value!=null);return x(()=>a.contentPath,async d=>{const k=await(await fetch(d)).text();p.value=k.split(`
`).filter(n=>n)},{immediate:!0}),(d,t)=>{const k=L("RouterLink");return s(),c("article",{"aria-labelledby":i(u)},[r("div",Y,[r("strong",{id:i(u)},D(d.deck.label),9,Z),l(T,{adding:e.value||d.addingCategory,added:C.value,onAdd:o,onRemove:g},null,8,["adding","added"])]),r("ol",ee,[(s(!0),c(h,null,R(p.value,n=>(s(),c("li",{key:n,class:"kanji"},[l(k,{to:i(V)(n)},{default:b(()=>[_(D(n),1)]),_:2},1032,["to"])]))),128))])],8,X)}}}),ae=y(te,[["__scopeId","data-v-444c5444"]]),se=["aria-labelledby"],oe={class:"controls"},ne=["id"],ce={key:0,class:"deck-list"},re=f({__name:"DeckBrowserCategory",props:{title:{},category:{},deckTemplates:{}},setup(m){const a=m,e=w(!1),u=j(),{result:p}=O(A(()=>{const{category:t}=a;return async()=>(await S).transaction("decks").store.index("category").count(t)})),o=w(!1),g=A(()=>(p.value??0)>=a.deckTemplates.length);async function B(){o.value=!0;try{await z(a.category,a.deckTemplates)}catch(t){console.error(t)}finally{o.value=!1}}async function C(){o.value=!0;try{await M(a.category)}catch(t){console.error(t)}finally{o.value=!1}}function d({name:t,label:k,priority:n}){return{name:t,label:k,priority:n,category:a.category}}return(t,k)=>(s(),c("article",{"aria-labelledby":i(u)},[r("div",oe,[r("strong",{id:i(u),class:"title"},D(t.title),9,ne),l(T,{adding:o.value,added:g.value,onAdd:B,onRemove:C},null,8,["adding","added"])]),l($,{class:"expand-button","aria-pressed":e.value,onClick:k[0]||(k[0]=n=>e.value=!e.value)},{default:b(()=>[e.value?(s(),c(h,{key:0},[_("Hide ")],64)):(s(),c(h,{key:1},[_("Show ")],64)),_(" ("+D(t.deckTemplates.length)+" decks) ",1)]),_:1},8,["aria-pressed"]),e.value?(s(),c("ol",ce,[(s(!0),c(h,null,R(t.deckTemplates,n=>(s(),c("li",{key:n.name},[l(ae,{deck:d(n),"content-path":n.content,"adding-category":o.value},null,8,["deck","content-path","adding-category"])]))),128))])):F("",!0)],8,se))}}),v=y(re,[["__scopeId","data-v-caf77e95"]]),le={class:"categories"},de=f({__name:"DeckBrowser",setup(m){return(a,e)=>(s(),c("ul",le,[r("li",null,[l(v,{title:"JLPT",category:"jlpt","deck-templates":i(q)},null,8,["deck-templates"])]),r("li",null,[l(v,{title:"News Frequency",category:"news","deck-templates":i(K)},null,8,["deck-templates"])]),r("li",null,[l(v,{title:"Genki",category:"genki","deck-templates":i(E)},null,8,["deck-templates"])]),r("li",null,[l(v,{title:"Basic Kanji Book",category:"basic-kanji","deck-templates":i(J)},null,8,["deck-templates"])])]))}}),ie=y(de,[["__scopeId","data-v-898009ac"]]),ue={class:"article-header"},pe={class:"actions"},ke=f({__name:"DeckBrowserView",setup(m){return(a,e)=>(s(),c("article",null,[r("header",ue,[e[1]||(e[1]=r("h2",{class:"title"},"Add Decks",-1)),r("div",pe,[l($,{to:i(P),"prefix-icon":"arrow-left"},{default:b(()=>e[0]||(e[0]=[_(" Back to your decks ")])),_:1},8,["to"])])]),l(ie)]))}}),De=y(ke,[["__scopeId","data-v-a1e5f41b"]]);export{De as default};
