import{d as w,m as P,a as u,e as d,I as q,g as A,F as m,l as j,b as c,u as h,h as I,o as a,_ as y,E as O,B as S,V as z,c as k,v as T,W as H,w as Q,i as V,t as E,k as U,n as G,H as J,Q as X}from"./index-DRXBIH1a.js";import{W as Y,v as Z}from"./WordListItem-R2_LxMq-.js";import{c as ee,w as F}from"./reviews-ShNZGkIO.js";import{d as se}from"./db-CSQ4qy-K.js";import{h as L,a as b,i as re}from"./text-p0dDw4FE.js";import{c as te,B as ae,_ as ne,e as oe}from"./WordWritingSelect-BogeNjGy.js";import{W as N}from"./WordKanjiListItem-Cf3g5wGs.js";import"./index-BOsLoRk8.js";import"./fsrs-DGjdKZ7y.js";const ue={class:"word-search-results"},ie={class:"results-list"},le=w({__name:"BookmarkedWords",setup(o){const t=ee(async()=>{const n=[],e=(await se).transaction("bookmarked-words").store.index("bookmarkedAt").iterate(null,"prev");for await(const l of e)n.push(l.primaryKey);return n},[]),s=P(20);function r(){s.value+=20}function i([{isIntersecting:n}]){n&&r()}return(n,e)=>(a(),u("section",ue,[e[2]||(e[2]=d("h3",null,"Bookmarked Words",-1)),d("ul",ie,[(a(!0),u(m,null,j(h(t).slice(0,s.value),l=>(a(),u("li",{key:l},[c(Y,{word:l},null,8,["word"])]))),128))]),s.value<h(t).length?q((a(),u("button",{key:0,class:"next-page-button",onClick:e[0]||(e[0]=l=>r())},e[1]||(e[1]=[I(" Load More ")]))),[[h(Z),i]]):A("",!0)]))}}),ce=y(le,[["__scopeId","data-v-8a1217ab"]]);function de(o){return new Worker("/assets/search-kanji.worker-CVf2lNVP.js",{name:o==null?void 0:o.name})}function me(o){return new Worker("/assets/search-words.worker-Cf1PrufV.js",{name:o==null?void 0:o.name})}const R=new de,$=new me;function fe(o){const t=O([]);F(()=>S(o),async r=>{t.splice(0,t.length),r.length>0&&$.postMessage(r)},{debounce:300,immediate:!0});function s(r){const i=r.data;i.phrase===S(o)&&t.push(i)}return $.addEventListener("message",s),z(()=>{$.removeEventListener("message",s)}),t}function pe(o){const t=P([]);F(()=>S(o),async r=>{r.length===0||L(r)?t.value=[]:R.postMessage(r)},{debounce:300,immediate:!0});function s(r){t.value=r.data}return R.addEventListener("message",s),z(()=>{R.removeEventListener("message",s)}),t}const he={class:"word-search-result-item"},_e={class:"meaning"},ge=w({__name:"WordSearchResultItem",props:{result:{}},setup(o){const t=o,s=te(()=>t.result.id),r=k(()=>{var e,l;return s.value?(l=(e=s.value.readings)==null?void 0:e.at(0))==null?void 0:l.text:t.result.readings.at(0)}),i=k(()=>{var W,v,B,K,C,M,D;const{match:e,readings:l,writings:_}=t.result;if(s.value){let g;return L(e)?g=(W=s.value.furigana)==null?void 0:W.find(x=>x.writing===e):b(e)&&(g=(v=s.value.furigana)==null?void 0:v.find(x=>x.reading===e)),g||(g=(B=s.value.furigana)==null?void 0:B.at(0)),g?g.furigana:((C=(K=s.value.writings)==null?void 0:K.at(0))==null?void 0:C.text)??((D=(M=s.value.readings)==null?void 0:M.at(0))==null?void 0:D.text)??e}if(L(e))return[{ruby:e,rt:l.at(0)}];const[f]=_;if(b(e))return f?[{ruby:f,rt:e}]:e;const[p]=l;return f&&p?[{ruby:p,rt:p}]:f??p??e}),n=k(()=>{var _,f;const{match:e,glossary:l}=t.result;if(s.value){if(b(e))return((_=s.value.meanings)==null?void 0:_.at(0))??l.at(0)??e;const p=(f=s.value.meanings)==null?void 0:f.find(W=>{var v;return(v=W.glossary)==null?void 0:v.includes(e)});if(p)return p}return b(e)?l.at(0)??e:e});return(e,l)=>{const _=T("RouterLink");return a(),u("div",he,[c(ae,{"word-id":e.result.id,reading:r.value,class:"bookmark-button"},null,8,["word-id","reading"]),c(_,{to:h(H)(e.result.id),class:"word"},{default:Q(()=>[typeof i.value=="string"?(a(),u(m,{key:0},[I(E(i.value),1)],64)):(a(),V(ne,{key:1,furigana:i.value},null,8,["furigana"]))]),_:1},8,["to"]),d("div",_e,[typeof n.value=="string"?(a(),u(m,{key:0},[I(E(n.value),1)],64)):(a(),V(oe,{key:1,meaning:n.value},null,8,["meaning"]))])])}}}),ve=y(ge,[["__scopeId","data-v-3a6c2f15"]]),ke={class:"word-search-results"},we={class:"results-list"},ye=w({__name:"WordSearchResults",props:{phrase:{}},setup(o){const t=o,s=fe(()=>t.phrase);return(r,i)=>(a(),u("section",ke,[i[0]||(i[0]=d("h3",null,"Words",-1)),d("ul",we,[(a(!0),u(m,null,j(h(s),n=>(a(),u("li",{key:n.id},[c(ve,{result:n},null,8,["result"])]))),128))])]))}}),We=y(ye,[["__scopeId","data-v-884f1e39"]]),be={key:0,class:"kanji-search-results"},je={key:0,class:"results-list"},xe={key:1,class:"results-list"},Re=w({__name:"KanjiSearchResults",props:{phrase:{}},setup(o){const t=o,s=k(()=>{const i=new Set;for(const n of t.phrase)re(n)&&i.add(n);return i}),r=pe(()=>t.phrase);return(i,n)=>s.value.size>0||h(r).length>0?(a(),u("section",be,[n[0]||(n[0]=d("h3",null,"Kanji",-1)),s.value.size>0?(a(),u("ul",je,[(a(!0),u(m,null,j(s.value,e=>(a(),u("li",{key:e},[c(N,{kanji:e},null,8,["kanji"])]))),128))])):(a(),u("ul",xe,[(a(!0),u(m,null,j(h(r),e=>(a(),u("li",{key:e.id},[c(N,{kanji:String.fromCodePoint(e.id)},null,8,["kanji"])]))),128))]))])):A("",!0)}}),$e=y(Re,[["__scopeId","data-v-37e6699a"]]),Ie={class:"search-field"},Se=w({__name:"DictionaryView",setup(o){const t=G(),s=U(),r=k({get(){return typeof t.query.search!="string"?"":t.query.search},set(i){s.replace({query:{search:i||void 0}})}});return(i,n)=>(a(),u(m,null,[d("label",Ie,[c(J,{icon:"search",class:"icon"}),q(d("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),type:"search","aria-label":"search",placeholder:"Search for words, kanji, meanings, etc."},null,512),[[X,r.value]])]),r.value?(a(),u(m,{key:0},[c($e,{class:"kanji-results",phrase:r.value},null,8,["phrase"]),c(We,{class:"word-results",phrase:r.value},null,8,["phrase"])],64)):(a(),V(ce,{key:1,class:"bookmark-results"}))],64))}}),Pe=y(Se,[["__scopeId","data-v-5c4cb6f2"]]);export{Pe as default};
