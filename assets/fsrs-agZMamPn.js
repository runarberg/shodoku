import{g as p,v as d,W as w,b as g}from"./reviews-CJ8qnqBF.js";import{u as v,d as o}from"./db-DMt_gcjs.js";import{c as f,B as c,D as b,x as j}from"./index-BciHhrDw.js";const m=new RegExp("\\p{Script=Han}","u"),K=new RegExp("^\\p{Script=Han}$","u"),R=/[\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Han}\u{2e80}-\u{2fd5}\u{3000}-\u{303f}\u{31f0}-\u{31ff}\u{3220}-\u{3243}\u{3280}-\u{337f}\u{ff5f}-\u{ff9f}\u{ff01}-\u{ff5e}]/u;function z(t){return R.test(t)}function E(t){return m.test(t)}function h(t){return K.test(t)}function l(){return f(()=>{const t=p({enable_fuzz:d.value});return w(t)})}function _(t){const n=l(),{result:r}=v(f(()=>{const s=c(t);return async()=>{const i=(await o).transaction("progress").store,a=await i.get([s,"kanji-read"]),u=await i.get([s,"kanji-write"]),e=new Date;return{read:a?n.value.get_retrievability(a.fsrs,e,!1):null,write:u?n.value.get_retrievability(u.fsrs,e,!1):null}}}));return r}function D(t){const n=l(),r=b(new Set);return j(()=>c(t),async s=>{if(!s)return;const i=new Date;for(const a of s)if(h(a)){const u=a.codePointAt(0)??0,e=await(await o).get("progress",[u,"kanji-read"]);if(e){if(e.fsrs.state!==g.Review)continue;n.value.get_retrievability(e.fsrs,i,!1)>.99&&r.add(a)}}},{immediate:!0}),r}export{_ as a,z as b,m as c,D as d,E as h,h as i,l as u};
