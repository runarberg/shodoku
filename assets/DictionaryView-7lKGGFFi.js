import{d as w,k as P,o as a,a as u,b as d,F as m,j,e as c,u as h,G as q,g as L,h as A,_ as y,C as O,x as S,L as z,c as k,p as T,w as G,t as D,f as I,M as U,N as H,m as J,n as Q,E as X}from"./index-BOg8xiez.js";import{W as Y,v as Z}from"./WordListItem-CWrO8dFk.js";import{c as ee,w as F}from"./reviews-vBeA8rIc.js";import{d as se}from"./channels-Cq-RpcWF.js";import{h as V,b,i as re}from"./fsrs-CiIXS6Cp.js";import{c as te,B as ae,_ as ne,e as oe}from"./WordWritingSelect-ZaqMOUmN.js";import{W as E}from"./WordKanjiListItem-7AIzJ1bl.js";import"./index-TyJKmroR.js";import"./db-3hrw4Sm5.js";import"./iterators-PeFxZeGd.js";const ue={class:"word-search-results"},ie={class:"results-list"},le=w({__name:"BookmarkedWords",setup(o){const t=ee(async()=>{const n=[],e=(await se).transaction("bookmarked-words").store.index("bookmarkedAt").iterate(null,"prev");for await(const l of e)n.push(l.primaryKey);return n},[]),s=P(20);function r(){s.value+=20}function i([{isIntersecting:n}]){n&&r()}return(n,e)=>(a(),u("section",ue,[e[2]||(e[2]=d("h3",null,"Bookmarked Words",-1)),d("ul",ie,[(a(!0),u(m,null,j(h(t).slice(0,s.value),l=>(a(),u("li",{key:l},[c(Y,{word:l},null,8,["word"])]))),128))]),s.value<h(t).length?q((a(),u("button",{key:0,class:"next-page-button",onClick:e[0]||(e[0]=l=>r())},e[1]||(e[1]=[L(" Load More ")]))),[[h(Z),i]]):A("",!0)]))}}),ce=y(le,[["__scopeId","data-v-8a1217ab"]]);function de(o){return new Worker("/assets/search-kanji.worker-CVf2lNVP.js",{name:o==null?void 0:o.name})}function me(o){return new Worker("/assets/search-words.worker-Cf1PrufV.js",{name:o==null?void 0:o.name})}const R=new de,$=new me;function fe(o){const t=O([]);F(()=>S(o),async r=>{t.splice(0,t.length),r.length>0&&$.postMessage(r)},{debounce:300,immediate:!0});function s(r){const i=r.data;i.phrase===S(o)&&t.push(i)}return $.addEventListener("message",s),z(()=>{$.removeEventListener("message",s)}),t}function pe(o){const t=P([]);F(()=>S(o),async r=>{r.length===0||V(r)?t.value=[]:R.postMessage(r)},{debounce:300,immediate:!0});function s(r){t.value=r.data}return R.addEventListener("message",s),z(()=>{R.removeEventListener("message",s)}),t}const he={class:"word-search-result-item"},_e={class:"meaning"},ge=w({__name:"WordSearchResultItem",props:{result:{}},setup(o){const t=o,s=te(()=>t.result.id),r=k(()=>{var e,l;return s.value?(l=(e=s.value.readings)==null?void 0:e.at(0))==null?void 0:l.text:t.result.readings.at(0)}),i=k(()=>{var W,v,K,B,C,M,N;const{match:e,readings:l,writings:_}=t.result;if(s.value){let g;return V(e)?g=(W=s.value.furigana)==null?void 0:W.find(x=>x.writing===e):b(e)&&(g=(v=s.value.furigana)==null?void 0:v.find(x=>x.reading===e)),g||(g=(K=s.value.furigana)==null?void 0:K.at(0)),g?g.furigana:((C=(B=s.value.writings)==null?void 0:B.at(0))==null?void 0:C.text)??((N=(M=s.value.readings)==null?void 0:M.at(0))==null?void 0:N.text)??e}if(V(e))return[{ruby:e,rt:l.at(0)}];const[f]=_;if(b(e))return f?[{ruby:f,rt:e}]:e;const[p]=l;return f&&p?[{ruby:p,rt:p}]:f??p??e}),n=k(()=>{var _,f;const{match:e,glossary:l}=t.result;if(s.value){if(b(e))return((_=s.value.meanings)==null?void 0:_.at(0))??l.at(0)??e;const p=(f=s.value.meanings)==null?void 0:f.find(W=>{var v;return(v=W.glossary)==null?void 0:v.includes(e)});if(p)return p}return b(e)?l.at(0)??e:e});return(e,l)=>{const _=T("RouterLink");return a(),u("div",he,[c(ae,{"word-id":e.result.id,reading:r.value,class:"bookmark-button"},null,8,["word-id","reading"]),c(_,{to:h(U)(e.result.id),class:"word"},{default:G(()=>[typeof i.value=="string"?(a(),u(m,{key:0},[L(D(i.value),1)],64)):(a(),I(ne,{key:1,furigana:i.value},null,8,["furigana"]))]),_:1},8,["to"]),d("div",_e,[typeof n.value=="string"?(a(),u(m,{key:0},[L(D(n.value),1)],64)):(a(),I(oe,{key:1,meaning:n.value},null,8,["meaning"]))])])}}}),ve=y(ge,[["__scopeId","data-v-3a6c2f15"]]),ke={class:"word-search-results"},we={class:"results-list"},ye=w({__name:"WordSearchResults",props:{phrase:{}},setup(o){const t=o,s=fe(()=>t.phrase);return(r,i)=>(a(),u("section",ke,[i[0]||(i[0]=d("h3",null,"Words",-1)),d("ul",we,[(a(!0),u(m,null,j(h(s),n=>(a(),u("li",{key:n.id},[c(ve,{result:n},null,8,["result"])]))),128))])]))}}),We=y(ye,[["__scopeId","data-v-884f1e39"]]),be={key:0,class:"kanji-search-results"},je={key:0,class:"results-list"},xe={key:1,class:"results-list"},Re=w({__name:"KanjiSearchResults",props:{phrase:{}},setup(o){const t=o,s=k(()=>{const i=new Set;for(const n of t.phrase)re(n)&&i.add(n);return i}),r=pe(()=>t.phrase);return(i,n)=>s.value.size>0||h(r).length>0?(a(),u("section",be,[n[0]||(n[0]=d("h3",null,"Kanji",-1)),s.value.size>0?(a(),u("ul",je,[(a(!0),u(m,null,j(s.value,e=>(a(),u("li",{key:e},[c(E,{kanji:e},null,8,["kanji"])]))),128))])):(a(),u("ul",xe,[(a(!0),u(m,null,j(h(r),e=>(a(),u("li",{key:e.id},[c(E,{kanji:String.fromCodePoint(e.id)},null,8,["kanji"])]))),128))]))])):A("",!0)}}),$e=y(Re,[["__scopeId","data-v-37e6699a"]]),Le={class:"search-field"},Se=w({__name:"DictionaryView",setup(o){const t=J(),s=Q(),r=k({get(){return typeof t.query.search!="string"?"":t.query.search},set(i){s.replace({query:{search:i||void 0}})}});return(i,n)=>(a(),u(m,null,[d("label",Le,[c(X,{icon:"search",class:"icon"}),q(d("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),type:"search","aria-label":"search",placeholder:"Search for new words, kanji, meanings, etc."},null,512),[[H,r.value]])]),r.value?(a(),u(m,{key:0},[c($e,{class:"kanji-results",phrase:r.value},null,8,["phrase"]),c(We,{class:"word-results",phrase:r.value},null,8,["phrase"])],64)):(a(),I(ce,{key:1,class:"bookmark-results"}))],64))}}),qe=y(Se,[["__scopeId","data-v-acb4ae58"]]);export{qe as default};
