import{G,q as j,H,d as w,I as S,a as k,e as c,D as v,i as y,g as h,J as U,u,y as K,K as q,L as J,o as n,_ as E,b as m,A as M,M as W,w as g,T as Y,h as _,t as I,N as T,O as z,c as x,P as Q,Q as X,F as $,l as V,R as Z,s as ee}from"./index-6ufKAMkN.js";import{K as te,a as ae,_ as oe,b as ne,c as le}from"./KanjiWordList-DwAnrinI.js";import{p as se,S as ie}from"./reviews-vv4OOlcX.js";import{b as re}from"./fsrs-D5mfOv5x.js";import{a as ce,u as ue}from"./formats-CYYAzfAw.js";import{g as de}from"./WordWritingSelect-9Bqfxk3-.js";import{e as L,c as pe}from"./decks-DSZdWDh0.js";import{c as fe}from"./decks-BkI394ym.js";import{A as me,a as ke}from"./AppNumberInput-CByc6bl-.js";import{A as ge}from"./AppCheckbox-Bwnpuap_.js";import{u as ve,a as be}from"./kanji-BxdS7aig.js";import{p as ye}from"./CardRetrievabilityLabel-D-GUgiVV.js";import"./kanji-components-vEMXEWrB.js";import"./index-BzyXrToT.js";import"./db-CAXDHHnL.js";import"./WordListItem-C29Mm46w.js";const F=Symbol("menu-injection-key");function O(){return{open:j(!1)}}function je(){const e=O();return H(F,e),e}function _e(){return G(F,O,!0)}const $e=["aria-label","popovertarget","disabled"],he=["id"],we={role:"list",class:"menu"},De=w({__name:"AppMenu",props:{open:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},toggleIcon:{default:null}},emits:["update:open"],setup(e,{emit:d}){J(i=>({v273f2af2:u(A)}));const r=e,p=d,l=j(null),a=j(null),t=j(null),s=je(),b=q(),A=`--${b}`.replace(":","-anchor-");function D(){s.open.value=!1}function o(i){i.relatedTarget instanceof Element&&!t.value?.contains(i.relatedTarget)&&D()}function f(i){s.open.value=i.newState==="open"}function N(i){if(i.newState==="open"&&!("anchorName"in document.documentElement.style)){const C=l.value?.getBoundingClientRect(),B=a.value?.style;B&&C&&(B.insetBlockStart=`${C.bottom+window.scrollY}px`,B.insetInlineEnd=`calc(100% - ${C.right}px)`)}}return S(s.open,i=>{i?a.value?.showPopover():a.value?.hidePopover(),p("update:open",i)}),S(()=>r.open,i=>{i!==s.open.value&&(s.open.value=i)}),(i,C)=>(n(),k("div",{ref_key:"menuEl",ref:t,class:"app-menu popover-container",onFocusout:C[0]||(C[0]=B=>o(B))},[c("button",{ref_key:"toggleButton",ref:l,class:K(["toggle-button",{open:u(s).open.value}]),"aria-label":i.$slots.toggle?void 0:"Options",popovertarget:u(b),disabled:e.disabled},[v(i.$slots,"toggle",{},()=>[e.toggleIcon?(n(),y(U,{key:0,icon:e.toggleIcon,class:"toggle-icon"},null,8,["icon"])):h("",!0)],!0)],10,$e),c("div",{id:u(b),ref_key:"popoverEl",ref:a,class:"popover",popover:"",onBeforetoggle:N,onToggle:f},[c("menu",we,[v(i.$slots,"default",{},void 0,!0)])],40,he)],544))}}),Ce=E(De,[["__scopeId","data-v-658aa91b"]]),Ie={class:"app-menu-item"},Ae={class:"text"},Be=w({__name:"AppMenuItem",props:{prefixIcon:{default:null},to:{default:null},disabled:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},replace:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:d}){const r=e,p=d,{open:l}=_e();function a(t){r.disabled||(r.persistent||(l.value=!1),p("click",t))}return(t,s)=>(n(),k("li",Ie,[m(M,{type:"button",inline:"",class:"button",disabled:e.disabled,"prefix-icon":e.prefixIcon,to:e.to,replace:e.replace,onClick:a},W({default:g(()=>[c("span",Ae,[v(t.$slots,"default",{},void 0,!0)])]),_:2},[t.$slots.prefix?{name:"prefix",fn:g(()=>[v(t.$slots,"prefix",{},void 0,!0)]),key:"0"}:void 0]),1032,["disabled","prefix-icon","to","replace"])]))}}),P=E(Be,[["__scopeId","data-v-746e6864"]]),Me=["aria-labelledby"],xe={class:"header"},Ee=["id"],Ne={class:"body"},Ve=["id"],Ke={class:"footer"},Se={class:"buttons"},Te=w({__name:"AppDialog",props:{title:{default:null},cancelLabel:{default:null},confirmDisabled:{type:Boolean,default:!1},confirmLabel:{default:null}},emits:["cancel","close","confirm"],setup(e,{expose:d,emit:r}){const p=r,l=j(!1),a=j(null),t=q();function s(o=""){p("close"),l.value=!1,a.value?.open&&a.value.close(o)}function b(){p("cancel"),s("")}function A(){s("confirmed"),p("confirm")}function D(){l.value=!0,a.value?.showModal()}return d({close:s,show:D}),(o,f)=>(n(),y(Y,{to:"[id='app:dialogs']"},[c("dialog",z(o.$attrs,{ref_key:"dialog",ref:a,"aria-labelledby":`${u(t)}/title`,class:"app-dialog",onCancel:T(b,["prevent"])}),[c("header",xe,[c("strong",{id:`${u(t)}/title`,class:"title"},[v(o.$slots,"title",{},()=>[_(I(e.title),1)],!0)],8,Ee),m(M,{"aria-label":"close",class:"close-button",inline:"",onClick:b},{default:g(()=>[m(U,{icon:"x-mark"})]),_:1})]),c("div",Ne,[v(o.$slots,"default",{},void 0,!0),c("form",{id:`${u(t)}/form`,class:"form",method:"dialog",onSubmit:T(A,["prevent"])},[v(o.$slots,"form",{},void 0,!0)],40,Ve)]),c("footer",Ke,[v(o.$slots,"footer",{},void 0,!0),c("div",Se,[v(o.$slots,"buttons",{},void 0,!0),e.cancelLabel||o.$slots.cancel?(n(),y(M,{key:0,onClick:b},{default:g(()=>[v(o.$slots,"cancel",{},()=>[_(I(e.cancelLabel),1)],!0)]),_:3})):h("",!0),e.confirmLabel||o.$slots.confirm?(n(),y(M,{key:1,type:"submit",filled:"",form:`${u(t)}/form`,disabled:e.confirmDisabled},{default:g(()=>[v(o.$slots,"confirm",{},()=>[_(I(e.confirmLabel),1)],!0)]),_:3},8,["form","disabled"])):h("",!0)])])],16,Me)]))}}),Le=E(Te,[["__scopeId","data-v-95bc6f59"]]),Pe=w({__name:"KanjiManageDecksDeckItem",props:{kanji:{},deck:{}},setup(e){const d=e,r=x(()=>d.deck.cards.includes(d.kanji.codepoint));async function p(){const l=Q(d.deck),{cards:a}=l,{codepoint:t}=d.kanji;r.value?L({...l,cards:a.filter(s=>s!==t)}):a.includes(t)||L({...l,cards:[...a,t]})}return(l,a)=>(n(),y(ge,{"model-value":r.value,"onUpdate:modelValue":p},{label:g(()=>[c("span",{class:K(["label",{active:r.value}])},I(e.deck.label),3)]),_:1},8,["model-value"]))}}),R=E(Pe,[["__scopeId","data-v-8897b10f"]]),Re={class:"list"},Ue={key:0},qe=["open"],Fe={class:"category-summary"},Oe={class:"list"},Ge=w({__name:"KanjiManageDecksDialog",props:{kanji:{}},setup(e,{expose:d}){const r=e,p=j(null),l=ce(),a=j(!1),t=X({label:"",priority:1}),s=x(()=>se(l.value??[],de(D=>D.category)));async function b(){a.value=!1,t.label="",t.priority=1,p.value?.show()}function A(){a.value&&pe({label:t.label,priority:t.priority,cards:[r.kanji.codepoint],cardTypes:["kanji-write","kanji-read"]})}return d({show:b}),(D,o)=>(n(),y(Le,{ref_key:"dialog",ref:p,title:` ${e.kanji.literal}: Manage Decks`,"cancel-label":a.value?"Cancel":null,"confirm-label":a.value?"Cretate Deck":"Close",onConfirm:A},{form:g(()=>[c("ul",Re,[(n(!0),k($,null,V(s.value,([f,N])=>(n(),k($,{key:f},[f!=="custom"?(n(),k("li",Ue,[c("details",{class:"category-details",open:N.some(({cards:i})=>i.includes(e.kanji.codepoint))},[c("summary",Fe,I(u(fe)(f)),1),c("ul",Oe,[(n(!0),k($,null,V(N,i=>(n(),k("li",{key:i.name},[m(R,{kanji:e.kanji,deck:i},null,8,["kanji","deck"])]))),128))])],8,qe)])):h("",!0)],64))),128)),(n(!0),k($,null,V(s.value.get("custom")??[],f=>(n(),k("li",{key:f.name},[m(R,{kanji:e.kanji,deck:f},null,8,["kanji","deck"])]))),128))]),c("div",{class:K(["create-new-fields",{expanded:a.value}])},[a.value?(n(),k($,{key:1},[m(me,{modelValue:t.label,"onUpdate:modelValue":o[1]||(o[1]=f=>t.label=f),class:"name-field",label:"Deck Name",required:""},null,8,["modelValue"]),m(ke,{modelValue:t.priority,"onUpdate:modelValue":o[2]||(o[2]=f=>t.priority=f),class:"priority-field",label:"Priority",min:"1",required:""},null,8,["modelValue"])],64)):(n(),y(M,{key:0,class:"create-new-expand-button","prefix-icon":"plus",inline:"",onClick:o[0]||(o[0]=f=>a.value=!0)},{default:g(()=>[...o[5]||(o[5]=[_(" Create New ",-1)])]),_:1}))],2)]),default:g(()=>[c("p",null,[o[3]||(o[3]=_(" Select a decks to add/remove ",-1)),c("strong",null,I(e.kanji.literal),1),o[4]||(o[4]=_(" to/from. ",-1))])]),_:1},8,["title","cancel-label","confirm-label"]))}}),He=E(Ge,[["__scopeId","data-v-a1ee2006"]]),Je=w({__name:"KanjiExploreActions",props:{kanji:{}},setup(e){const d=e,r=j(null),p=ue(()=>d.kanji.codepoint),l=re(()=>d.kanji.codepoint,["kanji-write","kanji-read"]),a=x(()=>{for(const{fsrs:t}of l.value.values())if(t.state!==ie.New)return!1;return!0});return(t,s)=>(n(),y(Ce,{"toggle-icon":"ellipsis-vertical"},{default:g(()=>[m(P,{onClick:s[0]||(s[0]=b=>r.value?.show())},{default:g(()=>[u(p).length===0?(n(),k($,{key:0},[_("Add to deck")],64)):(n(),k($,{key:1},[_("Manage decks")],64))]),_:1}),u(p).length>0&&a.value?(n(),y(P,{key:0,to:{name:u(Z),query:{"card-id":e.kanji.codepoint,"card-type":"kanji-write",singleton:""}},replace:""},{default:g(()=>[...s[1]||(s[1]=[_(" Review now ",-1)])]),_:1},8,["to"])):h("",!0),m(He,{ref_key:"manageDecksDialog",ref:r,kanji:e.kanji},null,8,["kanji"])]),_:1}))}}),We={key:0,class:"kanji-card"},dt=w({__name:"KanjiView",setup(e){const d=ee(),r=x(()=>{const t=d.params.kanji;return typeof t!="string"||[...t].length!==1?null:t.codePointAt(0)??null}),p=x(()=>r.value?.toString(16).padStart(5,"0")??null),l=ve(r),a=be(r);return ye(p),(t,s)=>u(l)?(n(),k("article",We,[m(te,{class:"title",kanji:u(l)},{actions:g(()=>[m(Je,{kanji:u(l)},null,8,["kanji"])]),_:1},8,["kanji"]),m(ae,{class:"readings",kanji:u(l)},null,8,["kanji"]),m(oe,{class:"strokes",kanji:u(l).literal},null,8,["kanji"]),m(ne,{class:"components"}),u(a)?(n(),y(le,{key:0,class:"words","kanji-vocab":u(a)},null,8,["kanji-vocab"])):h("",!0)])):h("",!0)}});export{dt as default};
//# sourceMappingURL=KanjiView-HoMmcYu_.js.map
