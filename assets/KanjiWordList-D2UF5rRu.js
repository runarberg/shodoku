import{l as V,m as E,g as b,x as Le,y as de,v as ce,s as je,z as Ne,A as se,d as N,B as xe,c as h,o as f,_ as D,u as x,f as I,e as $,b as k,t as A,n as be,F as S,a as O,h as W,i as L,w as G,C as J,D as te,j as $e,E as De,G as Re,H as We}from"./index-uL2dLKam.js";import{A as X}from"./AppButton-niJYO7_s.js";import{A as z,u as Oe,d as Se}from"./db-ywXYyXbd.js";import{s as Be,d as Ge,t as H,n as qe,a as ne,b as fe,c as Ye,i as me,e as Te,g as Xe,h as ze}from"./index-v4MgLGDb.js";import{d as He}from"./decks-huPVwMnz.js";import{b as Fe,_ as Ue,V as ye,W as Je,h as Qe,c as Ze,B as et,d as tt}from"./WordWritingSelect-R_mn7F66.js";const ge="http://kanjivg.tagaini.net",ie=Symbol("kanjivg"),nt=new DOMParser;function at(e){var o;const n=[];let t=e.closest("[data-position]");for(;t instanceof SVGElement;)n.push(t.dataset.position),t=((o=t.parentElement)==null?void 0:o.closest("[data-position]"))??null;return n}function Rn(e){const n=V(null),t=V(null);E(()=>ce(e),async s=>{if(!s)return;const u=await(await fetch(`/kanjivg/kanji/${s}.svg`)).text(),a=nt.parseFromString(u,"image/svg+xml");if(a.documentElement instanceof SVGSVGElement){const{x:i,y:l,width:d,height:m}=a.documentElement.viewBox.baseVal;t.value=`${i},${l},${d},${m}`}const c=a.getElementById(`kvg:${s}`);if(c){for(const i of[...c==null?void 0:c.querySelectorAll("*"),c])if(i instanceof SVGElement){for(const l of[...i.attributes])l.namespaceURI===ge&&(i.dataset[l.localName]=l.value,i.removeAttributeNS(ge,l.localName));i.removeAttribute("xmlns:kvg")}}n.value=c},{immediate:!0});const o=b(()=>{const s=n.value;if(!s)return new Map;const r=new Map,u={};function a(i){if(i.dataset.part&&Number.parseInt(i.dataset.part)>1)return;const l=i.dataset.element,d={element:l,original:i.dataset.original??null,position:at(i),radical:i.dataset.radical??null};let m=r.get(l);m?m.push(d):(m=[d],r.set(l,m)),d.radical&&(u[d.radical]=l)}s.dataset.radical&&a(s);for(const i of s.querySelectorAll("g[data-element]"))a(i);const c=new Map;for(const i of["general","tradit","nelson"]){const l=u[i],d=r.get(l);d&&(c.set(l,d),r.delete(l))}for(const[i,l]of r)c.set(i,l);return c});Le(ie,{strokesEl:n,viewBox:t,components:o})}function Me(){const e=de(ie,null);return b(()=>{var t;return((t=e==null?void 0:e.strokesEl.value)==null?void 0:t.cloneNode(!0))??null})}function Ce(){const e=de(ie,null);return b(()=>(e==null?void 0:e.viewBox.value)??"0,0,109,109")}function ot(){const e=de(ie,null);return b(()=>(e==null?void 0:e.components.value)??new Map)}function*st(e){for(const n of e.split(`
`)){const[t,o,s,r,u]=n.split(",");if(!o)continue;const a={id:Number.parseInt(t),literal:o.at(0)??"",strokes:Number.parseInt(s),meaning:r,reading:u};for(const c of o)yield[c,a]}}const it=Ne("radicals",()=>{const e=V(!1),n=V(null),t=se(new Map);async function o(){if(!e.value){e.value=!0,n.value=null;try{const u=await(await fetch("/data/radicals.csv")).text();for(const[a,c]of st(u))t.set(a,c)}catch(r){n.value=r}finally{e.value=!1}}}async function s(r){const u=r.codePointAt(0);if(!u)return;u===19994&&t.set(r,{id:u,literal:r,strokes:5,meaning:"North",reading:"ほく"});const a=u==null?void 0:u.toString(16).padStart(5,"0"),i=await(await fetch(`/data/kanji-v1/${a}.json`)).json(),l=i.kunYomi.find(d=>!/[.-]/.test(d))??i.kunYomi.at(0)??"";t.set(r,{id:u,literal:r,strokes:i.strokeCount,meaning:i.meanings.at(0)??"",reading:l})}return o(),{radicals:t,sync:o,syncing:e,tryKanji:s}});function rt(e){const n=it();return je(()=>{const t=ce(e);t&&!n.syncing&&!n.radicals.has(t)&&n.tryKanji(t)}),b(()=>{const t=ce(e);return t?n.radicals.get(t)??null:null})}const lt=N({__name:"KanjiStrokesGroup",props:{strokes:{}},setup(e){const n=e,t=V(null);function o(){var s;(s=t.value)==null||s.replaceChildren(n.strokes??"")}return E(()=>n.strokes,o),xe(()=>{o()}),(s,r)=>(f(),h("g",{ref_key:"container",ref:t,class:"kanji-strokes"},null,512))}}),Ie=D(lt,[["__scopeId","data-v-53c78976"]]),ct={class:"kanji-component-item"},ut=["viewBox"],dt={class:"component-info"},ft={class:"literal"},pt={class:"meaning"},vt={key:0,lang:"ja"},ht=N({__name:"KanjiComponentItem",props:{literal:{},parts:{}},setup(e){const n=e,t=Me(),o=Ce(),s=b(()=>{for(const a of n.parts)if(a.radical)return a.radical;return null}),r=rt(()=>n.literal);function u(a){return`oklch(from var(--accent-color) l c ${a+3})`}return je(()=>{const a=t.value;if(!a)return;a.dataset.element===n.literal&&(a.dataset.radical==="general"||a.dataset.radical==="tradit"?a.style.color="var(--green)":a.dataset.radical==="nelson"?a.style.color="var(--orange)":a.style.color=u(180));let c=-1;for(const i of a.querySelectorAll(`g[data-element="${n.literal}"]`)){if(i.dataset.radical==="general"||i.dataset.radical==="tradit"){i.style.color="var(--green)";continue}if(i.dataset.radical==="nelson"){i.style.color="var(--orange)";continue}(!i.dataset.part||i.dataset.part==="1")&&(c+=1),i.style.color=u(240+63*c)}}),(a,c)=>{var i,l;return f(),h("div",ct,[x(t)?(f(),h("svg",{key:0,viewBox:x(o),class:"kanji-component-strokes"},[I(Ie,{class:"strokes-group",strokes:x(t)},null,8,["strokes"])],8,ut)):$("",!0),k("div",dt,[k("span",ft,A(a.literal),1),k("p",pt,[k("strong",null,A((i=x(r))==null?void 0:i.meaning),1),(l=x(r))!=null&&l.reading?(f(),h("span",vt," ("+A(x(r).reading)+")",1)):$("",!0)]),s.value?(f(),h("span",{key:0,class:be(["is-radical",{"is-nelson":s.value==="nelson"}])},[s.value==="nelson"?(f(),h(S,{key:0},[O("Nelson radical")],64)):(f(),h(S,{key:1},[O("Radical")],64))],2)):$("",!0)])])}}}),mt=D(ht,[["__scopeId","data-v-ce0ca725"]]),yt={class:"component-list"},gt=N({__name:"KanjiComponents",setup(e){const n=ot();return(t,o)=>(f(),h("section",null,[k("h2",null,[o[0]||(o[0]=O(" Components ")),x(n).size>0?(f(),h(S,{key:0},[O(" ("+A(x(n).size)+")",1)],64)):$("",!0)]),k("ul",yt,[(f(!0),h(S,null,W(x(n),([s,r])=>(f(),h("li",{key:s},[I(mt,{literal:s,parts:r},null,8,["literal","parts"])]))),128))])]))}}),Wn=D(gt,[["__scopeId","data-v-6768574a"]]),kt={class:"kanji-readings"},_t={class:"dd-items"},wt={class:"dd-items"},jt=N({__name:"KanjiReadings",props:{kanji:{}},setup(e){return(n,t)=>(f(),h("section",null,[t[2]||(t[2]=k("h2",null,"Readings",-1)),k("dl",kt,[t[0]||(t[0]=k("dt",null,"Kun",-1)),k("div",_t,[(f(!0),h(S,null,W(n.kanji.kunYomi,o=>(f(),h("dd",null,A(o),1))),256))]),t[1]||(t[1]=k("dt",null,"On",-1)),k("div",wt,[(f(!0),h(S,null,W(n.kanji.onYomi,o=>(f(),h("dd",null,A(o),1))),256))])])]))}}),On=D(jt,[["__scopeId","data-v-f6c59d96"]]),xt={class:"kanji-strokes-background"},bt=["x","y","width","height"],$t=["x1","y1","x2","y2"],St=["x1","y1","x2","y2"],Bt=["x1","y1","x2","y2"],Mt=["x1","y1","x2","y2"],Ct=["x1","y1","x2","y2"],It=["x1","y1","x2","y2"],Kt=N({__name:"KanjiStrokesBackground",props:{viewBox:{}},setup(e){const n=e,t=b(()=>{const[r,u,a,c]=n.viewBox.split(",");return{x:Number.parseInt(r),y:Number.parseInt(u),width:Number.parseInt(a),height:Number.parseInt(c)}}),o=b(()=>{const{x:r,width:u}=t.value;return r+u/2}),s=b(()=>{const{y:r,height:u}=t.value;return r+u/2});return(r,u)=>(f(),h("g",xt,[k("rect",{class:"background",x:t.value.x,y:t.value.y,width:t.value.width,height:t.value.width,rx:"5"},null,8,bt),k("line",{class:"midline",x1:t.value.x+1,y1:s.value,x2:t.value.x+t.value.width-1,y2:s.value},null,8,$t),k("line",{class:"midline",x1:o.value,y1:t.value.y+1,x2:o.value,y2:t.value.y+t.value.height-1},null,8,St),k("line",{class:"quartline",x1:o.value/2,y1:t.value.y+1,x2:o.value/2,y2:t.value.y+t.value.height-1},null,8,Bt),k("line",{class:"quartline",x1:3*o.value/2,y1:t.value.y+1,x2:3*o.value/2,y2:t.value.y+t.value.height-1},null,8,Mt),k("line",{class:"quartline",x1:t.value.x+1,y1:s.value/2,x2:t.value.x+t.value.width-1,y2:s.value/2},null,8,Ct),k("line",{class:"quartline",x1:t.value.x+1,y1:3*s.value/2,x2:t.value.x+t.value.width-1,y2:3*s.value/2},null,8,It)]))}}),At=D(Kt,[["__scopeId","data-v-1b492e2c"]]),Vt=1e-12,ke=112e-18,Et=e=>e>=-ke&&e<=ke,Ke=(e,n)=>Math.sqrt(e*e+n*n),F=(e,n)=>({x:e,y:n}),Pt=e=>Ke(e.x,e.y),Lt=e=>F(-e.x,-e.y),Q=(e,n)=>F(e.x+n.x,e.y+n.y),P=(e,n)=>F(e.x-n.x,e.y-n.y),Y=(e,n)=>F(e.x*n,e.y*n),R=(e,n)=>e.x*n.x+e.y*n.y,pe=(e,n)=>Ke(e.x-n.x,e.y-n.y),q=(e,n=1)=>Y(e,n/(Pt(e)||1/0)),Ae=(e,n)=>({p:e,i:n}),Nt=(e,n,t)=>{n&&(e.unshift(e[e.length-1]),e.push(e[1]));const o=e.length;if(o===0)return[];const s=[Ae(e[0])];return ue(e,s,t,0,o-1,P(e[1],e[0]),P(e[o-2],e[o-1])),n&&(s.shift(),s.pop()),s},ue=(e,n,t,o,s,r,u)=>{if(s-o===1){const m=e[o],_=e[s],v=pe(m,_)/3;_e(n,[m,Q(m,q(r,v)),Q(_,q(u,v)),_]);return}const a=Ot(e,o,s);let c=Math.max(t,t*t),i,l=!0;for(let m=0;m<=4;m++){const _=Dt(e,o,s,a,r,u),v=Gt(e,o,s,_,a);if(v.error<t&&l){_e(n,_);return}if(i=v.index,v.error>=c)break;l=Rt(e,o,s,a,_),c=v.error}const d=P(e[i-1],e[i+1]);ue(e,n,t,o,i,r,d),ue(e,n,t,i,s,Lt(d),u)},_e=(e,n)=>{const t=e[e.length-1];t.o=P(n[1],n[0]),e.push(Ae(n[3],P(n[2],n[3])))},Dt=(e,n,t,o,s,r)=>{const u=Vt,a=Math.abs,c=e[n],i=e[t],l=[[0,0],[0,0]],d=[0,0];for(let w=0,M=t-n+1;w<M;w++){const g=o[w],y=1-g,C=3*g*y,U=y*y*y,T=C*y,ve=C*g,Pe=g*g*g,Z=q(s,T),ee=q(r,ve),he=P(P(e[n+w],Y(c,U+T)),Y(i,ve+Pe));l[0][0]+=R(Z,Z),l[0][1]+=R(Z,ee),l[1][0]=l[0][1],l[1][1]+=R(ee,ee),d[0]+=R(Z,he),d[1]+=R(ee,he)}const m=l[0][0]*l[1][1]-l[1][0]*l[0][1];let _,v;if(a(m)>u){const w=l[0][0]*d[1]-l[1][0]*d[0];_=(d[0]*l[1][1]-d[1]*l[0][1])/m,v=w/m}else{const w=l[0][0]+l[0][1],M=l[1][0]+l[1][1];_=v=a(w)>u?d[0]/w:a(M)>u?d[1]/M:0}const K=pe(i,c),B=u*K;let p,j;if(_<B||v<B)_=v=K/3;else{const w=P(i,c);p=q(s,_),j=q(r,v),R(p,w)-R(j,w)>K*K&&(_=v=K/3,p=j=null)}return[c,Q(c,p||q(s,_)),Q(i,j||q(r,v)),i]},Rt=(e,n,t,o,s)=>{for(let r=n;r<=t;r++)o[r-n]=Wt(s,e[r],o[r-n]);for(let r=1,u=o.length;r<u;r++)if(o[r]<=o[r-1])return!1;return!0},Wt=(e,n,t)=>{const o=[],s=[];for(let l=0;l<=2;l++)o[l]=Y(P(e[l+1],e[l]),3);for(let l=0;l<=1;l++)s[l]=Y(P(o[l+1],o[l]),2);const r=ae(3,e,t),u=ae(2,o,t),a=ae(1,s,t),c=P(r,n),i=R(u,u)+R(c,a);return Et(i)?t:t-R(c,u)/i},ae=(e,n,t)=>{const o=n.slice();for(let s=1;s<=e;s++)for(let r=0;r<=e-s;r++)o[r]=Q(Y(o[r],1-t),Y(o[r+1],t));return o[0]},Ot=(e,n,t)=>{const o=[0];for(let s=n+1;s<=t;s++)o[s-n]=o[s-n-1]+pe(e[s],e[s-1]);for(let s=1,r=t-n;s<=r;s++)o[s]/=o[r];return o},Gt=(e,n,t,o,s)=>{let r=Math.floor((t-n+1)/2),u=0;for(let a=n+1;a<t;a++){const c=ae(3,o,s[a-n]),i=P(c,e[a]),l=i.x*i.x+i.y*i.y;l>=u&&(u=l,r=a)}return{error:u,index:r}},qt=(e,n,t)=>{const o=e.length,s=10**t,r=t<16?v=>Math.round(v*s)/s:v=>v,u=(v,K)=>r(v)+","+r(K);let a=!0,c,i,l,d;const m=[],_=(v,K)=>{var j,w,M,g;const B=v.p.x,p=v.p.y;if(a)m.push("M"+u(B,p)),a=!1;else{const y=B+(((j=v.i)==null?void 0:j.x)??0),C=p+(((w=v.i)==null?void 0:w.y)??0);if(y===B&&C===p&&l===c&&d===i){if(!K){const U=B-c,T=p-i;m.push(U===0?"v"+r(T):T===0?"h"+r(U):"l"+u(U,T))}}else m.push("c"+u(l-c,d-i)+" "+u(y-c,C-i)+" "+u(B-c,p-i))}c=B,i=p,l=B+(((M=v.o)==null?void 0:M.x)??0),d=p+(((g=v.o)==null?void 0:g.y)??0)};if(!o)return"";for(let v=0;v<o;v++)_(e[v]);return n&&o>0&&(_(e[0],!0),m.push("z")),m.join("")},Yt=(e,n={})=>e.length===0?"":qt(Nt(e.map(typeof e[0].x=="number"?t=>F(t.x,t.y):t=>F(t[0],t[1])),n.closed,n.tolerance??2.5),n.closed,n.precision??5),Tt=["x","y","width","height"],Xt={class:"practice-strokes"},zt=["d"],Ht=["points"],Ft=N({__name:"KanjiStrokesPracticeCanvas",props:{practiceStrokes:{},animate:{type:Boolean},animatePause:{type:Boolean}},emits:["stroke"],setup(e,{emit:n}){const t=e,o=n,s=V(null),r=b(()=>{var p;return(p=s.value)==null?void 0:p.closest("svg")}),u=b(()=>{var p;return(p=r.value)==null?void 0:p.viewBox.baseVal}),a=se([]);function c(p){var M;if(!r.value)return{x:p.x,y:p.y};const j=r.value.createSVGPoint();j.x=p.x,j.y=p.y;const w=j.matrixTransform((M=r.value.getScreenCTM())==null?void 0:M.inverse());return{x:w.x,y:w.y}}function i(p){p.isPrimary&&a.push(c(p))}function l(p){var j;a.length===0||!p.isPrimary||((j=s.value)==null||j.setPointerCapture(p.pointerId),a.push(c(p)))}function d(p){var j;p.isPrimary&&(a.length>1&&o("stroke",Yt(a)),(j=s.value)==null||j.releasePointerCapture(p.pointerId),a.splice(0,a.length))}function m(p){const j=p.getTotalLength();return[{strokeDasharray:j,strokeDashoffset:j},{strokeDasharray:j,strokeDashoffset:0}]}const _={duration:500,easing:"ease-in-out"},v=[];function K(){var p;if(s.value){for(const j of(p=s.value)==null?void 0:p.querySelectorAll("path.stroke")){const w=j.animate(m(j),_);w.pause(),v.push(w)}B()}}async function B(){let p=v.at(0);for(;p;)p.play(),await p.finished,v.shift(),p=v.at(0),p&&await Be(100)}return E(()=>t.animate,p=>{p&&K()}),E(()=>t.animatePause,p=>{var j,w;p?(j=v.at(0))==null||j.pause():(w=v.at(0))==null||w.play()}),(p,j)=>(f(),h("g",{ref_key:"el",ref:s,class:"kanji-strokes-practice-canvas canvas",onPointerdown:i,onPointermove:l,onPointerup:d},[u.value?(f(),h("rect",{key:0,class:"background",x:u.value.x,y:u.value.y,width:u.value.width,height:u.value.height},null,8,Tt)):$("",!0),k("g",Xt,[(f(!0),h(S,null,W(p.practiceStrokes,(w,M)=>(f(),h("path",{class:"stroke practice-stroke",key:M,d:w},null,8,zt))),128))]),k("polyline",{class:"stroke current-stroke",points:x(a).map(({x:w,y:M})=>`${w},${M}`).join(" ")},null,8,Ht)],544))}}),Ut=D(Ft,[["__scopeId","data-v-b739eea3"]]),Jt={class:"strokes-figure"},Qt=["viewBox"],Zt={class:"controls"},en=N({__name:"KanjiStrokes",props:{kanji:{},autoHint:{type:Boolean,default:!1},practiceMode:{type:Boolean,default:!1},practiceReview:{type:Boolean,default:!1}},emits:["practiceDone"],setup(e,{emit:n}){const t=e,o=n,s=V(null),r=Me(),u=Ce(),a=b(()=>{var g;return((g=r.value)==null?void 0:g.querySelectorAll("path"))??[]}),c=se([]),i=b(()=>c.length>0),l=V(!1),d=V(!1),m=se([]);function _(g){const y=g.getTotalLength();return[{strokeDasharray:y,strokeDashoffset:y},{strokeDasharray:y,strokeDashoffset:0}]}const v={duration:500,easing:"ease-in-out"};function K(){for(const g of a.value){const y=g.animate(_(g),v);y.pause(),c.push(y)}B()}async function B(){let g=c.at(0);for(;g;)g.play(),await g.finished,c.shift(),g=c.at(0),g&&await Be(100)}function p(){var g;(g=c.at(0))==null||g.pause(),l.value=!0}function j(){var g;(g=c.at(0))==null||g.play(),l.value=!1}function w(g=m.length){const y=a.value[g];if(!y)return;y.style.display="block",y.animate(_(y),v).finished.then(()=>{y.style.removeProperty("display")})}function M(g){m.push(g),t.practiceMode&&m.length===a.value.length&&o("practiceDone"),t.practiceMode&&t.autoHint&&m.length<a.value.length&&w()}return E(d,g=>{if(g){for(const y of c)y.cancel();c.splice(0,c.length),l.value=!1}else m.splice(0,m.length)}),E(()=>t.practiceMode,g=>{for(const y of a.value)for(const C of y.getAnimations())C.cancel();t.practiceReview&&m.length===a.value.length?d.value=!0:g!==d.value&&(d.value=g)},{immediate:!0}),E(a,()=>{m.splice(0,m.length)}),(g,y)=>(f(),h("section",null,[k("h2",null,[y[7]||(y[7]=O(" Strokes ")),!g.practiceMode&&a.value.length>0?(f(),h(S,{key:0},[O(" ("+A(a.value.length)+") ",1)],64)):$("",!0)]),k("figure",Jt,[x(r)?(f(),h("svg",{key:0,ref_key:"svgEl",ref:s,viewBox:x(u),class:"svg"},[I(At,{viewBox:x(u)},null,8,["viewBox"]),I(Ie,{strokes:x(r),class:be(["strokes",{comparing:i.value||a.value.length<=x(m).length,practicing:d.value}])},null,8,["strokes","class"]),d.value?(f(),L(Ut,{key:0,"practice-strokes":x(m),animate:i.value,"animate-pause":l.value,onStroke:y[0]||(y[0]=C=>M(C))},null,8,["practice-strokes","animate","animate-pause"])):$("",!0)],8,Qt)):$("",!0),k("figcaption",Zt,[i.value?(f(),h(S,{key:0},[l.value?(f(),L(X,{key:0,"aria-label":"Play",onClick:y[1]||(y[1]=C=>j())},{default:G(()=>[I(z,{icon:"play"})]),_:1})):(f(),L(X,{key:1,"aria-label":"Pause",onClick:y[2]||(y[2]=C=>p())},{default:G(()=>[I(z,{icon:"pause"})]),_:1}))],64)):(f(),h(S,{key:1},[d.value&&x(m).length<a.value.length?(f(),L(X,{key:0,"aria-lable":"hint",onClick:y[3]||(y[3]=C=>w())},{default:G(()=>[I(z,{icon:"help-circle"})]),_:1})):(f(),L(X,{key:1,"aria-label":"Play Stroke Order",onClick:y[4]||(y[4]=C=>K())},{default:G(()=>[I(z,{icon:"play"})]),_:1}))],64)),g.practiceMode?$("",!0):(f(),L(X,{key:2,"aria-lable":"Practice Drawing","aria-pressed":`${d.value}`,filled:d.value,onClick:y[5]||(y[5]=C=>d.value=!d.value)},{default:G(()=>[I(z,{icon:"draw"})]),_:1},8,["aria-pressed","filled"])),d.value?(f(),h(S,{key:3},[y[8]||(y[8]=k("hr",{class:"rule"},null,-1)),I(X,{"aria-label":"Undo",onClick:y[6]||(y[6]=C=>x(m).pop())},{default:G(()=>[I(z,{icon:"rotate-left"})]),_:1})],64)):$("",!0)])])]))}}),Gn=D(en,[["__scopeId","data-v-36d42ce4"]]),tn={class:"kanji-title"},nn={class:"main-meaning meaning"},an={class:"labels"},on={key:0,class:"label freq"},sn={key:0,class:"additional-meanings"},rn={class:"meaning"},ln=N({__name:"KanjiTitle",props:{kanji:{},hideLiteral:{type:Boolean},hideMeaning:{type:Boolean}},setup(e){const n=e,t=b(()=>{const{freq:s}=n.kanji;if(!s)return null;if(s<=50)return 50;if(s<=100)return 100;if(s<=200)return 200;if(s<=500)return 500;if(s<=1e3)return 1e3}),{result:o}=Oe(b(()=>{const s=n.kanji.codepoint;return async()=>(await Se).transaction("decks").store.index("cards").getAll(IDBKeyRange.only(s))}));return(s,r)=>{var a,c;const u=$e("RouterLink");return f(),h("header",tn,[J(k("h2",{class:"literal",lang:"ja"},A(s.kanji.literal),513),[[te,!s.hideLiteral]]),J(k("p",nn,[k("strong",null,A((a=s.kanji.meanings)==null?void 0:a.at(0)),1)],512),[[te,!s.hideMeaning]]),k("aside",an,[t.value?(f(),h("span",on,"Top "+A(t.value),1)):$("",!0),x(o)?(f(!0),h(S,{key:1},W(x(o),i=>(f(),L(u,{to:{name:x(De),query:{deck:i.name}},key:i.name,class:"label deck"},{default:G(()=>[O(A(x(He)(i)),1)]),_:2},1032,["to"]))),128)):$("",!0)]),((c=s.kanji.meanings)==null?void 0:c.length)>1?J((f(),h("ul",sn,[(f(!0),h(S,null,W(s.kanji.meanings.slice(1),i=>(f(),h("li",rn,A(i),1))),256))],512)),[[te,!s.hideMeaning]]):$("",!0)])}}}),qn=D(ln,[["__scopeId","data-v-0c7cade2"]]),Ve=Te?window:void 0;function oe(e){var n;const t=H(e);return(n=t==null?void 0:t.$el)!=null?n:t}function cn(...e){let n,t,o,s;if(typeof e[0]=="string"||Array.isArray(e[0])?([t,o,s]=e,n=Ve):[n,t,o,s]=e,!n)return ne;Array.isArray(t)||(t=[t]),Array.isArray(o)||(o=[o]);const r=[],u=()=>{r.forEach(l=>l()),r.length=0},a=(l,d,m,_)=>(l.addEventListener(d,m,_),()=>l.removeEventListener(d,m,_)),c=E(()=>[oe(n),H(s)],([l,d])=>{if(u(),!l)return;const m=Xe(d)?{...d}:d;r.push(...t.flatMap(_=>o.map(v=>a(l,_,v,m))))},{immediate:!0,flush:"post"}),i=()=>{c(),u()};return fe(i),i}function un(){const e=V(!1),n=Re();return n&&xe(()=>{e.value=!0},n),e}function dn(e){const n=un();return b(()=>(n.value,!!e()))}function we(e,n,t={}){const{root:o,rootMargin:s="0px",threshold:r=0,window:u=Ve,immediate:a=!0}=t,c=dn(()=>u&&"IntersectionObserver"in u),i=b(()=>{const v=H(e);return(Array.isArray(v)?v:[v]).map(oe).filter(qe)});let l=ne;const d=V(a),m=c.value?E(()=>[i.value,oe(o),d.value],([v,K])=>{if(l(),!d.value||!v.length)return;const B=new IntersectionObserver(n,{root:oe(K),rootMargin:s,threshold:r});v.forEach(p=>p&&B.observe(p)),l=()=>{B.disconnect(),l=ne}},{immediate:a,flush:"post"}):ne,_=()=>{l(),m(),d.value=!1};return fe(_),{isSupported:c,isActive:d,pause(){l(),d.value=!1},resume(){d.value=!0},stop:_}}function re(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}const fn={[Ge.mounted](e,n){typeof n.value=="function"?we(e,n.value):we(e,...n.value)}};function Ee(e){const n=window.getComputedStyle(e);if(n.overflowX==="scroll"||n.overflowY==="scroll"||n.overflowX==="auto"&&e.clientWidth<e.scrollWidth||n.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const t=e.parentNode;return!t||t.tagName==="BODY"?!1:Ee(t)}}function pn(e){const n=e||window.event,t=n.target;return Ee(t)?!1:n.touches.length>1?!0:(n.preventDefault&&n.preventDefault(),!1)}const le=new WeakMap;function vn(e,n=!1){const t=V(n);let o=null,s="";E(Ye(e),a=>{const c=re(H(a));if(c){const i=c;if(le.get(i)||le.set(i,i.style.overflow),i.style.overflow!=="hidden"&&(s=i.style.overflow),i.style.overflow==="hidden")return t.value=!0;if(t.value)return i.style.overflow="hidden"}},{immediate:!0});const r=()=>{const a=re(H(e));!a||t.value||(me&&(o=cn(a,"touchmove",c=>{pn(c)},{passive:!1})),a.style.overflow="hidden",t.value=!0)},u=()=>{const a=re(H(e));!a||!t.value||(me&&(o==null||o()),a.style.overflow=s,le.delete(a),t.value=!1)};return fe(u),b({get(){return t.value},set(a){a?r():u()}})}function hn(){let e=!1;const n=V(!1);return(t,o)=>{if(n.value=o.value,e)return;e=!0;const s=vn(t,o.value);E(n,r=>s.value=r)}}hn();const mn={class:"vocabulary-word"},yn={class:"word",lang:"ja"},gn={class:"meaning"},kn={key:1,class:"additional-meanings-details"},_n={class:"additional-meanings"},wn={class:"additional-meaning-item"},jn={class:"actions"},xn=N({__name:"VocabularyWord",props:{word:{},kanji:{default:null},hideKanji:{type:Boolean,default:!1},hideReading:{type:Boolean,default:!1},hideMeaning:{type:Boolean,default:!1}},setup(e){const n=e,t=b(()=>{const{kanji:a,word:c}=n;return c.meanings?a?c.meanings.filter(i=>i.info&&i.info.startsWith("esp. ")&&Qe.test(i.info)?i.info.includes(a):i.useWithWriting?i.useWithWriting.some(l=>l.includes(a)):!0):c.meanings:[]}),o=Fe(()=>n.word),s=b(()=>t.value.at(0)),r=V(null),u=b(()=>t.value.slice(1));return E(()=>n.word.id,(a,c)=>{a!==c&&(r.value=null)}),(a,c)=>{const i=$e("RouterLink");return f(),h("div",mn,[k("p",yn,[I(i,{to:x(We)(a.word.id),class:"word-link"},{default:G(()=>[typeof r.value=="string"?(f(),h(S,{key:0},[O(A(r.value),1)],64)):(f(),L(Ue,{key:1,furigana:r.value||x(o),"hide-kanji":a.hideKanji,"hide-reading":a.hideReading,kanji:a.kanji},null,8,["furigana","hide-kanji","hide-reading","kanji"]))]),_:1},8,["to"])]),J(k("div",gn,[s.value?(f(),L(ye,{key:0,meaning:s.value},null,8,["meaning"])):$("",!0),u.value.length>0?(f(),h("details",kn,[k("summary",null,A(u.value.length)+" more",1),k("ul",_n,[(f(!0),h(S,null,W(u.value,l=>(f(),h("li",wn,[I(ye,{meaning:l},null,8,["meaning"])]))),256))])])):$("",!0)],512),[[te,!a.hideMeaning]]),k("div",jn,[!a.hideKanji&&!a.hideReading?(f(),L(Je,{key:0,modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=l=>r.value=l),word:a.word,default:x(o)},null,8,["modelValue","word","default"])):$("",!0)])])}}}),bn=D(xn,[["__scopeId","data-v-39d1c950"]]),$n={class:"word-list-item"},Sn={class:"bullet"},Bn={key:1,"aria-label":"Sentences",class:"sentences-section"},Mn={class:"sentences"},Cn=N({__name:"WordListItem",props:{word:{},kanji:{},hideKanji:{type:Boolean},hideReading:{type:Boolean},hideMeaning:{type:Boolean}},setup(e){const n=e,t=Ze(()=>n.word.word);return(o,s)=>(f(),h("article",$n,[k("aside",Sn,[I(et,{"word-id":o.word.word,class:"bookmark-button"},null,8,["word-id"])]),x(t)?(f(),L(bn,{key:0,word:x(t),kanji:o.kanji,"hide-kanji":o.hideKanji,"hide-reading":o.hideReading,"hide-meaning":o.hideMeaning,class:"word-section"},null,8,["word","kanji","hide-kanji","hide-reading","hide-meaning"])):$("",!0),o.word.sentences?(f(),h("section",Bn,[k("ul",Mn,[(f(!0),h(S,null,W(o.word.sentences,r=>(f(),h("li",{key:r,class:"sentence-item"},[I(tt,{"sentence-id":r,"hide-kanji":o.hideKanji?o.kanji:null,"hide-reading":o.hideReading?o.kanji:null,"hide-meaning":o.hideMeaning},null,8,["sentence-id","hide-kanji","hide-reading","hide-meaning"])]))),128))])])):$("",!0)]))}}),In=D(Cn,[["__scopeId","data-v-5c9848e0"]]),Kn={class:"kanji-word-list"},An=N({__name:"KanjiWordList",props:{kanjiVocab:{},hideKanji:{type:Boolean},hideReading:{type:Boolean},hideMeaning:{type:Boolean}},setup(e){const n=e,t=ze(async()=>{const{words:a}=n.kanjiVocab,c=[],i=[],{store:l}=(await Se).transaction("bookmarked-words");for(const d of a)await l.count(d.word)?c.push(d):i.push(d);return{bookmarked:c,rest:i}},null),o=V(20),s=b(()=>{const a=o.value;if(t.value){const{bookmarked:c,rest:i}=t.value;return[c,i.slice(0,a)]}return[n.kanjiVocab.words.slice(0,a)]});function r(){o.value+=20}function u([{isIntersecting:a}]){a&&r()}return E(()=>n.kanjiVocab.codepoint,(a,c)=>{a!==c&&(o.value=20)}),(a,c)=>(f(),h("section",null,[k("h2",null,"Words ("+A(a.kanjiVocab.words.length)+")",1),k("ul",Kn,[(f(!0),h(S,null,W(s.value,i=>(f(),h(S,null,[(f(!0),h(S,null,W(i,l=>(f(),h("li",{key:l.word},[I(In,{word:l,kanji:a.kanjiVocab.literal,"hide-kanji":a.hideKanji,"hide-reading":a.hideReading,"hide-meaning":a.hideMeaning},null,8,["word","kanji","hide-kanji","hide-reading","hide-meaning"])]))),128))],64))),256))]),o.value<a.kanjiVocab.words.length?J((f(),h("button",{key:0,class:"next-page-button",onClick:c[0]||(c[0]=i=>r())},c[1]||(c[1]=[O(" Load More ")]))),[[x(fn),u]]):$("",!0)]))}}),Yn=D(An,[["__scopeId","data-v-f05f9361"]]);export{qn as K,On as a,Gn as b,Yn as c,Wn as d,Rn as p};
