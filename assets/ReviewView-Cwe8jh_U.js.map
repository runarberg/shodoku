{"version":3,"file":"ReviewView-Cwe8jh_U.js","sources":["../../src/components/RateButtons.vue","../../src/components/ReviewAdvanceButtons.vue","../../src/components/ReviewCardKana.vue","../../src/components/ReviewCardKanji.vue","../../src/components/ReviewCard.vue","../../src/components/ReviewRemainCount.vue","../../src/types.ts","../../src/views/ReviewView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { Card as FSRSCard, Rating, RecordLogItem } from \"ts-fsrs\";\nimport { computed } from \"vue\";\n\nimport { useFsrs } from \"../helpers/fsrs.ts\";\nimport { formatRelativeTime } from \"../helpers/time.ts\";\nimport AppButton from \"./AppButton.vue\";\n\nconst props = defineProps<{\n  progress: FSRSCard;\n}>();\n\nconst emit = defineEmits<{\n  rate: [next: RecordLogItem];\n}>();\n\nconst fsrs = useFsrs();\nconst ratings = computed(() => fsrs.value.repeat(props.progress, new Date()));\n\nfunction nextReview(next: FSRSCard): string {\n  const currentReviewTime = next.last_review?.getTime() ?? Date.now();\n  const nextReviewTime = next.due.getTime();\n\n  return formatRelativeTime(nextReviewTime - currentReviewTime);\n}\n\nfunction rateCard(rating: Rating) {\n  if (rating === Rating.Manual) {\n    // Not implemented\n    return;\n  }\n\n  emit(\"rate\", fsrs.value.next(props.progress, new Date(), rating));\n}\n</script>\n\n<template>\n  <div class=\"rate-buttons\">\n    <AppButton\n      v-for=\"{ log, card: next } of ratings\"\n      :key=\"log.rating\"\n      class=\"rating-button\"\n      :data-rating=\"Rating[log.rating]\"\n      @click=\"rateCard(log.rating)\"\n    >\n      <span class=\"rate-button-content\">\n        <span class=\"rating\">{{ Rating[log.rating] }}</span>\n        <small class=\"next-review-time\">{{ nextReview(next) }}</small>\n      </span>\n    </AppButton>\n  </div>\n</template>\n\n<style scoped>\n.rate-buttons {\n  column-gap: 1ex;\n  display: flex;\n}\n\n.rating-button {\n  background: var(--background-strong);\n  border-color: currentColor;\n\n  &[data-rating=\"Again\"] {\n    color: var(--pink);\n  }\n\n  &[data-rating=\"Hard\"] {\n    color: var(--orange);\n  }\n\n  &[data-rating=\"Good\"] {\n    color: var(--green);\n  }\n\n  &[data-rating=\"Easy\"] {\n    color: var(--blue);\n  }\n\n  & .rate-button-content {\n    align-items: center;\n    column-gap: 0.5ex;\n    display: flex;\n\n    @media screen and (max-width: 60ch) {\n      flex-direction: column;\n    }\n  }\n\n  & .next-review-time {\n    font-weight: normal;\n    font-size: 0.7em;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { Card as FSRSCard, RecordLogItem } from \"ts-fsrs\";\n\nimport { kanjiRoute } from \"../router.ts\";\nimport AppButton from \"./AppButton.vue\";\nimport RateButtons from \"./RateButtons.vue\";\n\ndefineProps<{\n  progress: FSRSCard;\n  isRating?: boolean;\n  mode: \"read\" | \"write\";\n}>();\n\ndefineEmits<{\n  answer: [];\n  rate: [value: RecordLogItem];\n}>();\n</script>\n\n<template>\n  <div class=\"advance-buttons\">\n    <RateButtons\n      v-if=\"isRating\"\n      :progress=\"progress\"\n      @rate=\"$emit('rate', $event)\"\n    />\n\n    <template v-else>\n      <AppButton filled @click=\"$emit('answer')\">\n        Show\n        <template v-if=\"mode === 'read'\"> Reading </template>\n        <template v-else> Writing </template>\n      </AppButton>\n\n      <AppButton\n        v-if=\"\n          'singleton' in $route.query && typeof $route.params.kanji === 'string'\n        \"\n        :to=\"kanjiRoute($route.params.kanji)\"\n        replace\n      >\n        Cancel\n      </AppButton>\n    </template>\n  </div>\n</template>\n\n<style scoped>\n.advance-buttons {\n  backdrop-filter: blur(2em);\n  display: flex;\n  column-gap: 1ex;\n  inline-size: max-content;\n  inset-block-start: 0;\n  padding-block: 1em 1ex;\n  padding-inline-end: 1em;\n  position: sticky;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { Card as FSRSCard, RecordLogItem } from \"ts-fsrs\";\nimport { computed } from \"vue\";\n\nimport { randomYoon, useKanaInfo } from \"../helpers/kana\";\nimport KanaExamples from \"./KanaExamples.vue\";\nimport KanaStrokes from \"./KanaStrokes.vue\";\nimport KanaTitle from \"./KanaTitle.vue\";\nimport ReviewAdvanceButtons from \"./ReviewAdvanceButtons.vue\";\n\nconst props = defineProps<{\n  cardId: number;\n  progress: FSRSCard;\n  isNew?: boolean;\n  isRating?: boolean;\n  mode: \"read\" | \"write\";\n}>();\n\ndefineEmits<{\n  answer: [];\n  rate: [next: RecordLogItem];\n}>();\n\nfunction isYoon(codePoint: number) {\n  return [0x3083, 0x3085, 0x3087, 0x30e3, 0x30e5, 0x30e7].includes(codePoint);\n}\n\nconst kana = computed(() => {\n  const { cardId } = props;\n\n  if (isYoon(cardId)) {\n    return randomYoon(String.fromCodePoint(cardId));\n  }\n\n  return String.fromCodePoint(cardId);\n});\n\nconst kanaInfo = useKanaInfo(kana);\n</script>\n\n<template>\n  <section v-if=\"kanaInfo\">\n    <KanaTitle\n      :kana=\"kana\"\n      :kana-info=\"kanaInfo\"\n      :hide-kana=\"!isRating && !isNew && mode === 'write'\"\n      :hide-romaji=\"!isRating && mode === 'read'\"\n      actions=\"review\"\n      class=\"title\"\n    />\n\n    <KanaStrokes\n      class=\"strokes\"\n      :kana=\"kana\"\n      :auto-hint=\"isNew && !isRating && mode === 'write'\"\n      :practice-mode=\"!isRating && mode === 'write'\"\n      @practice-done=\"$emit('answer')\"\n    />\n\n    <ReviewAdvanceButtons\n      :progress=\"progress\"\n      :is-rating=\"isRating\"\n      :mode=\"mode\"\n      @answer=\"$emit('answer')\"\n      @rate=\"$emit('rate', $event)\"\n    />\n\n    <KanaExamples\n      v-if=\"kanaInfo?.vocab\"\n      :vocab=\"kanaInfo.vocab\"\n      :hide-romaji=\"!isRating && mode === 'read'\"\n      :hide-kana=\"!isRating && !isNew && mode === 'write'\"\n      :target-kana=\"kana\"\n    />\n  </section>\n</template>\n","<script setup lang=\"ts\">\nimport { Card as FSRSCard, RecordLogItem } from \"ts-fsrs\";\n\nimport { useKanji, useKanjiVocab } from \"../helpers/kanji.ts\";\nimport { provideKanjiVG } from \"../helpers/kanjivg.ts\";\nimport KanjiComponents from \"./KanjiComponents.vue\";\nimport KanjiReadings from \"./KanjiReadings.vue\";\nimport KanjiStrokes from \"./KanjiStrokes.vue\";\nimport KanjiTitle from \"./KanjiTitle.vue\";\nimport KanjiWordList from \"./KanjiWordList.vue\";\nimport ReviewAdvanceButtons from \"./ReviewAdvanceButtons.vue\";\n\nconst props = defineProps<{\n  cardId: number;\n  progress: FSRSCard;\n  isNew?: boolean;\n  isRating?: boolean;\n  mode: \"read\" | \"write\";\n}>();\n\ndefineEmits<{\n  answer: [];\n  rate: [next: RecordLogItem];\n}>();\n\nconst kanji = useKanji(() => props.cardId);\nconst kanjiVocab = useKanjiVocab(() => props.cardId);\n\nprovideKanjiVG(() => props.cardId.toString(16).padStart(5, \"0\"));\n</script>\n\n<template>\n  <section v-if=\"kanji\">\n    <KanjiTitle\n      class=\"title\"\n      :kanji=\"kanji\"\n      :hide-literal=\"!isRating && !isNew && mode === 'write'\"\n      :hide-meaning=\"!isRating && mode === 'read'\"\n    />\n\n    <KanjiReadings\n      class=\"readings\"\n      :kanji=\"kanji\"\n      :hide-readings=\"mode === 'read' && !isRating\"\n    />\n\n    <KanjiStrokes\n      class=\"strokes\"\n      :kanji=\"kanji.literal\"\n      :auto-hint=\"isNew && !isRating && mode === 'write'\"\n      :practice-mode=\"!isRating && mode === 'write'\"\n      @practice-done=\"$emit('answer')\"\n    />\n\n    <ReviewAdvanceButtons\n      :progress=\"progress\"\n      :is-rating=\"isRating\"\n      :mode=\"mode\"\n      @answer=\"$emit('answer')\"\n      @rate=\"$emit('rate', $event)\"\n    />\n\n    <KanjiComponents\n      class=\"components\"\n      :hide=\"!isRating && !(mode === 'write' && isNew)\"\n    />\n\n    <KanjiWordList\n      v-if=\"kanjiVocab\"\n      class=\"words\"\n      :kanji-vocab=\"kanjiVocab\"\n      :hide-kanji=\"!isRating && !isNew && mode === 'write'\"\n      :hide-reading=\"!isRating && mode === 'read'\"\n      :hide-meaning=\"!isRating && mode === 'read'\"\n    />\n  </section>\n</template>\n","<script setup lang=\"ts\">\nimport { asyncComputed } from \"@vueuse/core\";\nimport { RecordLogItem, State } from \"ts-fsrs\";\nimport { computed } from \"vue\";\n\nimport { db } from \"../db/index.ts\";\nimport { CardProgress, Optional } from \"../types.ts\";\nimport ReviewCardKana from \"./ReviewCardKana.vue\";\nimport ReviewCardKanji from \"./ReviewCardKanji.vue\";\n\nconst props = defineProps<{\n  card: Optional<CardProgress, \"fsrs\">;\n  isRating?: boolean;\n}>();\n\ndefineEmits<{\n  answer: [];\n  rate: [value: { progress: CardProgress; next: RecordLogItem }];\n}>();\n\nconst progress = asyncComputed(async () => {\n  const { cardId, cardType, fsrs } = props.card;\n\n  if (fsrs) {\n    return fsrs;\n  }\n\n  const card = await (await db).get(\"progress\", [cardId, cardType]);\n\n  return card?.fsrs;\n}, props.card.fsrs);\n\nconst isNewCard = computed(() => progress.value?.state === State.New);\n</script>\n\n<template>\n  <section v-if=\"progress\">\n    <component\n      :is=\"card.cardType.startsWith('kana-') ? ReviewCardKana : ReviewCardKanji\"\n      :card-id=\"card.cardId\"\n      :progress=\"progress\"\n      :is-new=\"isNewCard\"\n      :is-rating=\"isRating\"\n      :mode=\"card.cardType.endsWith('-write') ? 'write' : 'read'\"\n      @answer=\"$emit('answer')\"\n      @rate=\"\n        $emit('rate', {\n          progress: { ...card, fsrs: progress },\n          next: $event,\n        })\n      \"\n    />\n  </section>\n</template>\n","<script setup lang=\"ts\">\nimport { useRemainingCount } from \"../store/reviews.ts\";\n\nconst remainingCount = useRemainingCount();\n</script>\n\n<template>\n  <div v-if=\"remainingCount\" class=\"review-remaining-count\">\n    <span class=\"review-count\">\n      {{ remainingCount.due }}\n    </span>\n    <span class=\"new-count\">(+ {{ remainingCount.new }})</span>\n    <span class=\"learning-count\"> {{ remainingCount.learning }}</span>\n  </div>\n</template>\n\n<style scoped>\n.review-remaining-count {\n  column-gap: 0.8ex;\n  display: inline-flex;\n  font-size: 0.8em;\n  font-weight: 600;\n}\n\n.review-count {\n  color: var(--blue);\n}\n\n.new-count {\n  color: var(--green);\n}\n\n.learning-count {\n  color: var(--orange);\n}\n</style>\n","import { StoreNames } from \"idb\";\nimport { type Card as FSRSCard, ReviewLog } from \"ts-fsrs\";\n\nimport { DB } from \"./db/schema.ts\";\n\nexport type Optional<T, Keys extends keyof T> = Omit<T, Keys> &\n  Partial<Pick<T, Keys>>;\n\nexport type KanaInfo = {\n  literal: string;\n  reading: string;\n  base?: string | string[];\n  dakuten?: string;\n  handakuten?: string;\n  youon?: string[];\n  hiragana?: string;\n  katakana?: string;\n  vocab?: KanaInfoVocabularyWord[];\n};\n\nexport type KanaInfoVocabularyWord = {\n  kana: string;\n  romaji: string;\n  en: string;\n  wordId?: number;\n};\n\nexport type HiraganaInfo = KanaInfo & { katakana: string };\nexport type KatakanaInfo = KanaInfo & { hiragana: string };\n\nexport type KanjiInfo = {\n  codepoint: number;\n  literal: string;\n  meanings: string[];\n  kunYomi: string[];\n  onYomi: string[];\n  strokeCount: number;\n  radical: number;\n  freq?: number;\n  grade?: string;\n};\n\nexport type KanjiComponent = {\n  element: string;\n  original: string | null;\n  position: string[];\n  radical: string | null;\n  depth: number;\n  phon: string | null;\n};\n\nexport type KanjiComponentInfo = {\n  literal: string;\n  radical?: { original: string; number: number; en: string; jp: string };\n  meaning?: string;\n  reading?: string;\n  strokeCount: number;\n  variations?: string[];\n  variationOf?: string[];\n  kanji: Record<number, string[]>;\n};\n\nexport type WordWriting = {\n  text: string;\n  priority?: { freq?: number };\n  irregular?: boolean;\n  rare?: boolean;\n  outdated?: boolean;\n  searchOnly?: boolean;\n};\n\nexport type WordReading = {\n  text: string;\n  priority?: { freq?: number };\n  irregular?: boolean;\n  rare?: boolean;\n  outdated?: boolean;\n  searchOnly?: boolean;\n};\n\nexport type WordMeaning = {\n  pos?: string[];\n  info?: string;\n  glossary?: string[];\n  useWithWriting?: string[];\n  kanaPreferred?: boolean;\n};\n\nexport type Furigana = Array<{\n  ruby: string;\n  rt?: string;\n}>;\n\nexport type Word = {\n  id: number;\n  writings?: WordWriting[];\n  readings?: WordReading[];\n  meanings?: WordMeaning[];\n  furigana?: Array<{\n    writing: string;\n    reading: string;\n    furigana: Furigana;\n  }>;\n};\n\nexport type BookmarkedWord = {\n  wordId: number;\n  bookmarkedAt: Date;\n  reading?: string | null;\n};\n\nexport type WordSentenceIndex = Array<{\n  sentence: number;\n  meaning: number;\n}>;\n\nexport type SentenceWord = {\n  word: number;\n  furigana: Furigana;\n};\n\nexport type Sentence = {\n  sentence: string;\n  meaning: string;\n  words: SentenceWord[];\n};\n\nexport type KanjiVocab = {\n  codepoint: number;\n  literal: string;\n  words: number[];\n};\n\nexport type Radical = {\n  id: number;\n  literal: string;\n  strokes: number;\n  meaning: string;\n  reading: string;\n};\n\n// A description of a deck for deck browser.\nexport type DeckTemplate = {\n  name: string;\n  label: string;\n  priority: number;\n  content: string;\n};\n\nexport type Deck = {\n  name: string;\n  label: string;\n  category: string;\n  priority: number;\n  cards: number[];\n  cardTypes: CardType[];\n  active: boolean;\n  createdAt: Date;\n  updatedAt?: Date;\n};\n\nexport type CardType =\n  | \"kanji-read\"\n  | \"kanji-write\"\n  | \"kana-read\"\n  | \"kana-write\";\n\nexport function isCardType(thing: string): thing is CardType {\n  return (\n    thing === \"kanji-read\" ||\n    thing === \"kanji-write\" ||\n    thing === \"kana-read\" ||\n    thing === \"kana-write\"\n  );\n}\n\nexport type Card = {\n  id: number;\n  value: string;\n  types: CardType[];\n  createdAt: Date;\n  updatedAt?: Date;\n};\n\nexport type CardProgress = {\n  cardId: number;\n  cardType: CardType;\n  fsrs: FSRSCard;\n};\n\nexport type CardReview = {\n  id: number;\n  cardId: number;\n  cardType: CardType;\n  log: ReviewLog;\n};\n\nexport type SyncPatchStore = {\n  name: StoreNames<DB>;\n  add?: string[];\n  put?: string[];\n  delete?: string[];\n};\n\ntype SyncPatchPreference = [name: string, value: string | null];\n\nexport type SyncPatch = {\n  hash: string;\n  parent: string | null;\n  syncedAt: Date;\n  dbVersion: number;\n  patchVersion: number;\n  stores: SyncPatchStore[];\n  preferences: SyncPatchPreference[];\n};\n\nexport type SyncStagingStore<\n  StoreName extends StoreNames<DB> = StoreNames<DB>,\n> = {\n  id?: number;\n  store: StoreName;\n  key: DB[StoreName][\"key\"];\n  op: \"add\" | \"put\" | \"delete\";\n};\n\nexport type SyncStagingPreference = {\n  id?: number;\n  name: string;\n  value: string | null;\n};\n","<script setup lang=\"ts\">\nimport { RecordLogItem } from \"ts-fsrs\";\nimport { computed, ref, watchEffect } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\n\nimport AppLoading from \"../components/AppLoading.vue\";\nimport ReviewCard from \"../components/ReviewCard.vue\";\nimport ReviewRemainCount from \"../components/ReviewRemainCount.vue\";\nimport { kanaRoute, kanjiRoute, reviewSummaryRoute } from \"../router.ts\";\nimport useReviewsStore from \"../store/reviews.ts\";\nimport { CardProgress, CardType, isCardType, Optional } from \"../types.ts\";\n\nconst el = ref<HTMLElement | null>(null);\nconst route = useRoute();\nconst router = useRouter();\n\nconst reviewsStore = useReviewsStore();\n\nconst cardType = computed<CardType | null>(() => {\n  const { \"card-type\": queryValue } = route.query;\n\n  if (typeof queryValue !== \"string\" || !isCardType(queryValue)) {\n    return null;\n  }\n\n  return queryValue;\n});\n\nconst cardId = computed(() => {\n  const { \"card-id\": queryValue } = route.query;\n\n  if (typeof queryValue !== \"string\") {\n    return null;\n  }\n\n  const id = Number.parseInt(queryValue);\n\n  if (!Number.isFinite(id)) {\n    return null;\n  }\n\n  return id;\n});\n\nconst currentCard = computed<Optional<CardProgress, \"fsrs\"> | null>(() => {\n  if (!cardId.value || !cardType.value) {\n    return null;\n  }\n\n  const found = reviewsStore.queue.find(\n    (other) =>\n      other.cardId === cardId.value && other.cardType === cardType.value,\n  );\n\n  return found ?? { cardId: cardId.value, cardType: cardType.value };\n});\n\nconst isRating = computed(() => \"rating\" in route.query);\nconst loading = computed(() => !currentCard.value && reviewsStore.refreshing);\n\nreviewsStore.refreshQueues();\n\nwatchEffect(() => {\n  if (\n    reviewsStore.queue.length === 0 &&\n    !reviewsStore.refreshing &&\n    !isRating.value &&\n    !(\"singleton\" in route.query)\n  ) {\n    router.replace(reviewSummaryRoute);\n  }\n});\n\nwatchEffect(() => {\n  if (currentCard.value) {\n    return;\n  }\n\n  const [nextCard] = reviewsStore.queue;\n\n  if (nextCard) {\n    router.replace({\n      query: {\n        \"card-id\": nextCard.cardId,\n        \"card-type\": nextCard.cardType,\n        rating: undefined,\n      },\n    });\n  }\n});\n\ntype HandleRateParams = {\n  progress: CardProgress;\n  next: RecordLogItem;\n};\n\nfunction handleRate({ progress, next }: HandleRateParams) {\n  reviewsStore.rateCard(progress, next);\n\n  if (\"singleton\" in route.query) {\n    if (progress.cardType.startsWith(\"kanji-\")) {\n      router.replace(kanjiRoute(String.fromCodePoint(progress.cardId)));\n    } else if (progress.cardType.startsWith(\"kana-\")) {\n      router.replace(kanaRoute(String.fromCodePoint(progress.cardId)));\n    }\n    return;\n  }\n\n  const [nextCard] = reviewsStore.queue;\n  if (nextCard) {\n    router.replace({\n      query: {\n        \"card-id\": String.fromCodePoint(nextCard.cardId),\n        \"card-type\": nextCard.cardType,\n        rating: undefined,\n      },\n    });\n    el.value?.scrollIntoView({ behavior: \"instant\", block: \"start\" });\n  } else {\n    router.replace(reviewSummaryRoute);\n  }\n}\n</script>\n\n<template>\n  <article ref=\"el\">\n    <header class=\"header\">\n      <strong class=\"title\">\n        <template v-if=\"cardType?.endsWith('-read')\"> Reading </template>\n        <template v-else-if=\"cardType?.endsWith('-write')\"> Writing </template>\n        Review\n      </strong>\n\n      <ReviewRemainCount class=\"counts\" />\n    </header>\n\n    <section v-if=\"loading\" class=\"loading\">\n      <p>Loading next cardâ€¦</p>\n      <AppLoading class=\"loading-icon\" />\n    </section>\n\n    <template v-else-if=\"currentCard\">\n      <ReviewCard\n        :card=\"currentCard\"\n        :is-rating=\"isRating\"\n        @answer=\"$router.replace({ query: { ...$route.query, rating: '' } })\"\n        @rate=\"handleRate($event)\"\n      />\n    </template>\n  </article>\n</template>\n\n<style scoped>\n.header {\n  display: flex;\n  margin-block-end: 1em;\n\n  & .title {\n    font-size: 1.5em;\n  }\n}\n\n.loading {\n  text-align: center;\n\n  & .loading-icon {\n    color: var(--accent-color);\n    font-size: 50cqmin;\n    opacity: 0.5;\n  }\n}\n\n.counts {\n  margin-inline-start: auto;\n}\n</style>\n"],"names":["props","__props","emit","__emit","fsrs","useFsrs","ratings","computed","nextReview","next","currentReviewTime","nextReviewTime","formatRelativeTime","rateCard","rating","Rating","_openBlock","_createElementBlock","_hoisted_1","_Fragment","_renderList","log","_createBlock","AppButton","_unref","$event","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","_hoisted_4","isRating","RateButtons","progress","_cache","$emit","_createVNode","mode","$route","kanjiRoute","isYoon","codePoint","kana","cardId","randomYoon","kanaInfo","useKanaInfo","KanaTitle","isNew","KanaStrokes","ReviewAdvanceButtons","KanaExamples","kanji","useKanji","kanjiVocab","useKanjiVocab","provideKanjiVG","KanjiTitle","KanjiReadings","KanjiStrokes","KanjiComponents","KanjiWordList","asyncComputed","cardType","db","isNewCard","State","_resolveDynamicComponent","card","ReviewCardKana","ReviewCardKanji","remainingCount","useRemainingCount","isCardType","thing","el","ref","route","useRoute","router","useRouter","reviewsStore","useReviewsStore","queryValue","id","currentCard","other","loading","watchEffect","reviewSummaryRoute","nextCard","handleRate","kanaRoute","ReviewRemainCount","AppLoading","ReviewCard","$router"],"mappings":"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"}