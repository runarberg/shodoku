import{d as S,G as N,o as f,c as h,u as d,t as C,e as v,b as j,_ as O,g as p,i as L,w as R,n as W,J as F,K,l as I,m as Q,L as H}from"./index-PWB7_iI1.js";const U=new URL("sprite-CAd12IH0.svg",import.meta.url).href,Y=["data-icon","aria-hidden","aria-labelledby","aria-describedby"],z=["id"],G=["id"],J=["href"],X=S({__name:"AppIcon",props:{icon:{},title:{default:""},description:{default:""}},setup(e){const t=N();return(n,r)=>(f(),h("svg",{"data-icon":n.icon,"aria-hidden":!n.title&&!n.description,"aria-labelledby":`${d(t)}/title`,"aria-describedby":`${d(t)}/desc`,class:"app-icon",preserveAspectRatio:"xMidYMid meet"},[n.title?(f(),h("title",{key:0,id:`${d(t)}/title`},C(n.title),9,z)):v("",!0),n.description?(f(),h("desc",{key:1,id:`${d(t)}/desc`},C(n.description),9,G)):v("",!0),j("use",{href:`${d(U)}#${n.icon}`},null,8,J)],8,Y))}}),Z=O(X,[["__scopeId","data-v-e711c5a6"]]),q={class:"content"},ee=S({__name:"AppButton",props:{to:{},filled:{type:Boolean},prefixIcon:{}},setup(e){const t=e,n=p(()=>t.to?"RouterLink":"button");return(r,s)=>(f(),L(F(n.value),{to:r.to,class:W(["app-button",{filled:r.filled}])},{default:R(()=>[r.prefixIcon?(f(),L(Z,{key:0,icon:r.prefixIcon,class:"prefix-icon"},null,8,["icon"])):v("",!0),j("span",q,[K(r.$slots,"default")])]),_:3},8,["to","class"]))}}),ye=O(ee,[["__scopeId","data-v-68589028"]]),g=(e,t)=>t.some(n=>e instanceof n);let _,k;function te(){return _||(_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ne(){return k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const B=new WeakMap,m=new WeakMap,y=new WeakMap;function re(e){const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{n(u(e.result)),s()},a=()=>{r(e.error),s()};e.addEventListener("success",o),e.addEventListener("error",a)});return y.set(t,e),t}function se(e){if(B.has(e))return;const t=new Promise((n,r)=>{const s=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{n(),s()},a=()=>{r(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)});B.set(e,t)}let b={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return B.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return u(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function T(e){b=e(b)}function oe(e){return ne().includes(e)?function(...t){return e.apply(D(this),t),u(this.request)}:function(...t){return u(e.apply(D(this),t))}}function ae(e){return typeof e=="function"?oe(e):(e instanceof IDBTransaction&&se(e),g(e,te())?new Proxy(e,b):e)}function u(e){if(e instanceof IDBRequest)return re(e);if(m.has(e))return m.get(e);const t=ae(e);return t!==e&&(m.set(e,t),y.set(t,e)),t}const D=e=>y.get(e);function ie(e,t,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const a=indexedDB.open(e,t),l=u(a);return r&&a.addEventListener("upgradeneeded",i=>{r(u(a.result),i.oldVersion,i.newVersion,u(a.transaction),i)}),n&&a.addEventListener("blocked",i=>n(i.oldVersion,i.newVersion,i)),l.then(i=>{o&&i.addEventListener("close",()=>o()),s&&i.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const ce=["get","getKey","getAll","getAllKeys","count"],de=["put","add","delete","clear"],w=new Map;function P(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=de.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ce.includes(n)))return;const o=async function(a,...l){const i=this.transaction(a,s?"readwrite":"readonly");let c=i.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),s&&i.done]))[0]};return w.set(t,o),o}T(e=>({...e,get:(t,n,r)=>P(t,n)||e.get(t,n,r),has:(t,n)=>!!P(t,n)||e.has(t,n)}));const ue=["continue","continuePrimaryKey","advance"],M={},E=new WeakMap,V=new WeakMap,le={get(e,t){if(!ue.includes(t))return e[t];let n=M[t];return n||(n=M[t]=function(...r){E.set(this,V.get(this)[t](...r))}),n}};async function*fe(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const n=new Proxy(t,le);for(V.set(n,t),y.set(n,D(t));t;)yield n,t=await(E.get(n)||t.continue()),E.delete(n)}function x(e,t){return t===Symbol.asyncIterator&&g(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&g(e,[IDBIndex,IDBObjectStore])}T(e=>({...e,get(t,n,r){return x(t,n)?fe:e.get(t,n,r)},has(t,n){return x(t,n)||e.has(t,n)}}));const he=ie("shodoku",1,{upgrade(e,t){if(t<1){const n=e.createObjectStore("decks",{keyPath:"name"});n.createIndex("category","category"),n.createIndex("category+priority",["category","priority"]),n.createIndex("cards","cards",{multiEntry:!0});const r=e.createObjectStore("cards",{keyPath:"id"});r.createIndex("decks","decks",{multiEntry:!0}),r.createIndex("position",["position.priority","position.order"]);const s=e.createObjectStore("progress",{keyPath:["cardId","cardType"]});s.createIndex("cardId+cardType+state",["cardId","cardType","fsrs.state"]),s.createIndex("state+due",["fsrs.state","fsrs.due"]);const o=e.createObjectStore("reviews",{keyPath:"id",autoIncrement:!0});o.createIndex("cardId","cardId"),o.createIndex("review","log.review"),o.createIndex("state+review",["log.state","log.review"])}}}),$="live-query-channel",A=new BroadcastChannel($),Ie=new BroadcastChannel($);function me(e){const t=I(!0),n=I(null),r=I(null);async function s(){t.value=!0,r.value=null;const o=d(e);try{n.value=await o()}catch(a){r.value=a,n.value=null}finally{t.value=!1}}return A.addEventListener("message",s),Q(()=>d(e),s,{immediate:!0}),H(()=>{A.removeEventListener("message",s)}),{error:p(()=>r.value),result:p(()=>n.value),loading:p(()=>t.value)}}export{ye as A,Z as a,he as d,Ie as l,me as u};
