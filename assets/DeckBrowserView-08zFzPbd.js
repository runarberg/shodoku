import{d as I,Y as G,Z as P,c as j,a as d,N as ee,e as p,b as u,A as N,w as y,h as g,t as C,o as l,_ as K,P as J,Q as te,i as w,$ as Q,F as A,q as h,I as ae,u as o,K as O,g as D,l as V,z as Z,m as H,D as se,x as le,O as E,a0 as oe}from"./index-sZE7bAWT.js";import{k as $,j as ne,a as re,n as ie,g as ce,b as ue}from"./decks-BkI394ym.js";import{c as M,e as de,r as U,a as pe,d as me,b as ke,f as fe}from"./decks-Dqx20Gkd.js";import{d as q,u as W}from"./db-CaAx7W_9.js";import{p as X,d as ye,m as ge}from"./reviews-BjQG9Nhh.js";import{A as ve,a as be}from"./AppNumberInput-DZAkqObI.js";import{A as _e}from"./AppTextArea-B8NFmrxA.js";import{H as Ae,a as De,b as we,c as $e,d as Ie,e as Te}from"./kana-RsG-lPzR.js";function Ce(m,t){return async e=>{let a=t;for await(const n of e)a=m(a,n);return a}}function Be(){return m=>[...m]}function Ne(m){return function*(t){for(const e of t)yield m(e)}}function he(m){return function*(t){for(const e of t)m(e)&&(yield e)}}function Ke(){return function*(m){const t=new Set;for(const e of m)t.has(e)||(yield e,t.add(e))}}const je={class:"form-body"},Ve={class:"buttons"},Ee=I({__name:"CustomDeckForm",props:G({labelFieldDisabled:{type:Boolean,default:!1},priorityFieldDisabled:{type:Boolean,default:!1},confirmIcon:{default:null},confirmLabel:{default:"confirm"}},{label:{},labelModifiers:{},priority:{},priorityModifiers:{},cards:{},cardsModifiers:{}}),emits:G(["submit","reset"],["update:label","update:priority","update:cards"]),setup(m){const t=P(m,"label"),e=P(m,"priority"),a=P(m,"cards"),n=j({get(){return a.value?a.value.map(s=>String.fromCodePoint(s)).join(""):""},set(s){a.value=X(s,he(ye),Ne(i=>i.codePointAt(0)),Ke(),Be())}});return(s,i)=>(l(),d("form",{onSubmit:i[3]||(i[3]=ee(r=>s.$emit("submit"),["prevent"])),onReset:i[4]||(i[4]=r=>s.$emit("reset"))},[p("div",je,[u(ve,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=r=>t.value=r),class:"name-field",label:"Deck Name",disabled:s.labelFieldDisabled,required:""},null,8,["modelValue","disabled"]),u(be,{modelValue:e.value,"onUpdate:modelValue":i[1]||(i[1]=r=>e.value=r),class:"priority-field",label:"Priority",min:"1",disabled:s.priorityFieldDisabled,required:""},null,8,["modelValue","disabled"]),u(_e,{modelValue:n.value,"onUpdate:modelValue":i[2]||(i[2]=r=>n.value=r),class:"kanji-field",label:"Kanji",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",placeholder:"Type or paste in your kanji here: 日月火時漢字読書"},null,8,["modelValue"])]),p("div",Ve,[u(N,{type:"reset"},{default:y(()=>[...i[5]||(i[5]=[g(" Cancel ",-1)])]),_:1}),u(N,{type:"submit","prefix-icon":s.confirmIcon,filled:""},{default:y(()=>[g(C(s.confirmLabel),1)]),_:1},8,["prefix-icon"])])],32))}}),x=K(Ee,[["__scopeId","data-v-a5ea0a3c"]]),Le=I({__name:"CustomDeckCreate",emits:["cancel","success"],setup(m,{emit:t}){const e=t,a=J({label:"",priority:1,cards:[]});async function n(){const i=await X((await q).transaction("decks").store.index("category").iterate("custom"),ge(r=>r.value.cards.length),Ce((r,f)=>r+f,0));i&&(a.priority=Math.ceil(i/12))}async function s(){const i=await M({label:a.label,priority:a.priority,cards:Q(a.cards),cardTypes:["kanji-write","kanji-read"]});e("success",i)}return te(()=>{n()}),(i,r)=>(l(),w(x,{cards:a.cards,"onUpdate:cards":r[0]||(r[0]=f=>a.cards=f),label:a.label,"onUpdate:label":r[1]||(r[1]=f=>a.label=f),priority:a.priority,"onUpdate:priority":r[2]||(r[2]=f=>a.priority=f),"confirm-icon":"plus","confirm-label":"Create",onSubmit:s,onReset:r[3]||(r[3]=f=>i.$emit("cancel"))},null,8,["cards","label","priority"]))}}),Re=I({__name:"DeckActivateButton",props:{isActive:{type:Boolean,default:!1},toggling:{type:Boolean,default:!1}},emits:["activate","deactivate"],setup(m,{emit:t}){const e=m,a=t;function n(){e.isActive?a("deactivate"):a("activate")}return(s,i)=>(l(),w(N,{class:"activate-button",filled:s.isActive,disabled:s.toggling,"prefix-icon":s.toggling?void 0:s.isActive?"checkmark":"plus","aria-pressed":s.isActive,onClick:n},{default:y(()=>[s.toggling?(l(),d(A,{key:0},[i[0]||(i[0]=p("span",{class:"loading-icon"},"時",-1)),i[1]||(i[1]=g(" Loading ",-1))],64)):s.isActive?(l(),d(A,{key:1},[g(" Active ")],64)):(l(),d(A,{key:2},[g(" Add ")],64))]),_:1},8,["filled","disabled","prefix-icon","aria-pressed"]))}}),Y=K(Re,[["__scopeId","data-v-8468a69b"]]),Se=I({__name:"CustomDeckEdit",props:{deck:{}},emits:["cancel","success"],setup(m,{emit:t}){const e=m,a=t,n=J({label:e.deck.label,priority:e.deck.priority,cards:e.deck.cards});async function s(){await de({...e.deck,label:n.label,priority:n.priority,cards:Q(n.cards)}),a("success")}return(i,r)=>(l(),w(x,{cards:n.cards,"onUpdate:cards":r[0]||(r[0]=f=>n.cards=f),label:n.label,"onUpdate:label":r[1]||(r[1]=f=>n.label=f),priority:n.priority,"onUpdate:priority":r[2]||(r[2]=f=>n.priority=f),"confirm-label":"Update","label-field-disabled":e.deck.category!=="custom","priority-field-disabled":e.deck.category!=="custom",onSubmit:s,onReset:r[3]||(r[3]=f=>i.$emit("cancel"))},null,8,["cards","label","priority","label-field-disabled","priority-field-disabled"]))}}),Fe=["aria-labelledby"],Ue={class:"header"},Me=["id"],Ye={class:"kanji-list"},Pe=I({__name:"DeckBrowserItem",props:{deck:{},template:{},category:{},togglingCategory:{type:Boolean,default:!1}},setup(m){const t=m,e=h(!1),a=h(!1),n=O(),s=h(null),i=j(()=>t.deck?.active);async function r(){e.value=!0;try{t.deck?await pe(t.deck.name):await M({name:t.template.name,label:t.template.label,priority:t.template.priority,category:t.category,cards:s.value?.map(c=>c.codePointAt(0)??NaN)??[],cardTypes:["kanji-write","kanji-read"]})}catch(c){console.error(c)}finally{e.value=!1}}async function f(){if(t.deck){e.value=!0;try{await me(t.deck.name)}catch(c){console.error(c)}finally{e.value=!1}}}return ae(()=>t.template?.content,async c=>{if(!c){s.value=null;return}const B=await(await fetch(c)).text();s.value=B.split(`
`).filter(b=>b)},{immediate:!0}),(c,k)=>{const B=Z("RouterLink");return a.value&&c.deck?(l(),w(Se,{key:0,deck:c.deck,onCancel:k[0]||(k[0]=b=>a.value=!1),onSuccess:k[1]||(k[1]=b=>a.value=!1)},null,8,["deck"])):(l(),d("article",{key:1,"aria-labelledby":o(n)},[p("header",Ue,[p("strong",{id:o(n)},C(c.deck?.label??c.template?.label),9,Me),u(Y,{toggling:e.value||c.togglingCategory,"is-active":i.value,onActivate:r,onDeactivate:f},null,8,["toggling","is-active"]),c.deck?.active||c.deck?.category==="custom"?(l(),w(N,{key:0,class:"edit-button",onClick:k[2]||(k[2]=b=>a.value=!0)},{default:y(()=>[...k[5]||(k[5]=[g(" Edit ",-1)])]),_:1})):c.deck&&!c.deck.active&&c.deck.category!=="custom"?(l(),w(N,{key:1,class:"edit-button",onClick:k[3]||(k[3]=b=>o(U)(c.deck.name))},{default:y(()=>[...k[6]||(k[6]=[g(" Reset ",-1)])]),_:1})):D("",!0),c.deck?.category==="custom"?(l(),w(N,{key:2,class:"delete-button",onClick:k[4]||(k[4]=b=>o(U)(c.deck.name))},{default:y(()=>[...k[7]||(k[7]=[g(" Delete ",-1)])]),_:1})):D("",!0)]),p("ol",Ye,[c.deck?(l(!0),d(A,{key:0},V(c.deck.cards,b=>(l(),d("li",{key:b,class:"kanji"},[u(B,{to:o(H)(String.fromCodePoint(b))},{default:y(()=>[g(C(String.fromCodePoint(b)),1)]),_:2},1032,["to"])]))),128)):s.value?(l(!0),d(A,{key:1},V(s.value,b=>(l(),d("li",{key:b,class:"kanji"},[u(B,{to:o(H)(b)},{default:y(()=>[g(C(b),1)]),_:2},1032,["to"])]))),128)):D("",!0)])],8,Fe))}}}),z=K(Pe,[["__scopeId","data-v-24a893c0"]]),Oe=["aria-labelledby"],qe={class:"controls"},Ge=["id"],He={key:2,class:"deck-list"},ze=I({__name:"DeckBrowserCategory",props:{title:{},category:{},deckTemplates:{}},setup(m){const t=m,e=h(!1),a=h(!1),n=O(),{result:s}=W(j(()=>{const{category:_}=t;return async()=>{const v=new Map,T=(await q).transaction("decks").store.index("category+priority").iterate(IDBKeyRange.bound([_,Number.NEGATIVE_INFINITY],[_,Number.POSITIVE_INFINITY],!0,!0));for await(const F of T)v.set(F.primaryKey,F.value);return v}})),i=j(()=>t.deckTemplates?t.deckTemplates.length:s.value?.size??0),r=j(()=>{if(!s.value)return 0;let _=0;for(const[,{active:v}]of s.value)v&&(_+=1);return _}),f=h(!1),c=j(()=>t.deckTemplates?r.value>=t.deckTemplates.length:!0);async function k(_){f.value=!0;try{await ke(t.category,_)}catch(v){console.error(v)}finally{f.value=!1}}async function B(){f.value=!0;try{await fe(t.category)}catch(_){console.error(_)}finally{f.value=!1}}function b(){a.value=!0,e.value=!1}return(_,v)=>(l(),d("article",{"aria-labelledby":o(n)},[p("div",qe,[p("strong",{id:o(n),class:"title"},C(_.title),9,Ge),_.deckTemplates?(l(),w(Y,{key:0,toggling:f.value,"is-active":c.value,onActivate:v[0]||(v[0]=T=>k(_.deckTemplates)),onDeactivate:B},null,8,["toggling","is-active"])):e.value?D("",!0):(l(),w(N,{key:1,class:"create-custom-button","prefix-icon":"plus",onClick:v[1]||(v[1]=T=>e.value=!0)},{default:y(()=>[...v[4]||(v[4]=[g(" Create New ",-1)])]),_:1}))]),i.value>0?(l(),w(N,{key:0,class:"expand-button","aria-pressed":a.value,onClick:v[2]||(v[2]=T=>a.value=!a.value)},{default:y(()=>[a.value?(l(),d(A,{key:0},[g(" Hide ")],64)):(l(),d(A,{key:1},[g(" Show ")],64)),g(" ("+C(i.value)+" decks) ",1)]),_:1},8,["aria-pressed"])):D("",!0),e.value?(l(),w(Le,{key:1,class:"custom-deck-create",onCancel:v[3]||(v[3]=T=>e.value=!1),onSuccess:b})):D("",!0),a.value?(l(),d("ol",He,[_.deckTemplates?(l(!0),d(A,{key:0},V(_.deckTemplates,T=>(l(),d("li",{key:T.name},[u(z,{deck:o(s)?.get(T.name),template:T,category:_.category,"toggling-category":f.value},null,8,["deck","template","category","toggling-category"])]))),128)):o(s)?(l(!0),d(A,{key:1},V(o(s),([T,F])=>(l(),d("li",{key:T},[u(z,{deck:F},null,8,["deck"])]))),128)):D("",!0)])):D("",!0)],8,Oe))}}),S=K(ze,[["__scopeId","data-v-937c40f4"]]),Je=I({__name:"DeckBrowserCustom",setup(m){return(t,e)=>(l(),w(S,{title:"Custom",category:"custom"}))}}),Qe={class:"deck-browser-kana-deck-item"},Ze={class:"header"},We={class:"kana-title"},Xe={class:"body"},xe=I({__name:"DeckBrowserKanaItem",props:{template:{},togglingCategory:{type:Boolean},isActive:{type:Boolean}},setup(m){const t=m,e=h(!1);async function a(){e.value=!0;try{await M(t.template)}catch(s){console.error(s)}finally{e.value=!1}}async function n(){e.value=!0;try{await U(t.template.name)}catch(s){console.error(s)}finally{e.value=!1}}return(s,i)=>(l(),d("article",Qe,[p("header",Ze,[p("strong",We,C(s.template.label),1),u(Y,{toggling:e.value||s.togglingCategory,"is-active":s.isActive,onActivate:a,onDeactivate:n},null,8,["toggling","is-active"])]),p("div",Xe,[se(s.$slots,"default")])]))}}),L=K(xe,[["__scopeId","data-v-e59ee8fd"]]),et={class:"kana-table"},tt={key:0},at={key:0,class:"aiueo"},st={key:0},lt={class:"consonant"},ot=I({__name:"KanaTable",props:{headings:{},rows:{}},setup(m){return(t,e)=>{const a=Z("RouterLink");return l(),d("table",et,[t.headings?(l(),d("thead",tt,[p("tr",null,[(l(!0),d(A,null,V(t.headings,(n,s)=>(l(),d("th",{key:s},[n?(l(),d("span",at,C(n),1)):D("",!0)]))),128))])])):D("",!0),p("tbody",null,[(l(!0),d(A,null,V(t.rows,({heading:n,cells:s},i)=>(l(),d("tr",{key:i},[n?(l(),d("th",st,[p("span",lt,C(n),1)])):D("",!0),(l(!0),d(A,null,V(s,(r,f)=>(l(),d("td",{key:f},[r?(l(),w(a,{key:0,class:"kana-literal",to:o(le)(r)},{default:y(()=>[g(C(r),1)]),_:2},1032,["to"])):D("",!0)]))),128))]))),128))])])}}}),R=K(ot,[["__scopeId","data-v-f41c3b1c"]]),nt=["aria-labelledby"],rt={class:"controls"},it=["id"],ct={key:0,class:"deck-list"},ut=I({__name:"DeckBrowserKana",setup(m){const t=h(!1),e=O(),a=h(!1),{result:n}=W(j(()=>async()=>{const c=new Map,k=(await q).transaction("decks").store.index("category+priority").iterate(IDBKeyRange.bound(["kana",Number.NEGATIVE_INFINITY],["kana",Number.POSITIVE_INFINITY],!0,!0));for await(const B of k)c.set(B.primaryKey,B.value);return c}),new Map),s=Object.keys($).length,i=j(()=>n.value.size===s);async function r(){a.value=!0;const c=n.value;try{for(const k of Object.values($))c.has(k.name)||await M(k)}catch(k){console.error(k)}finally{a.value=!1}}async function f(){a.value=!0;try{for(const c of n.value.keys())await U(c)}catch(c){console.error(c)}finally{a.value=!1}}return(c,k)=>(l(),d("article",{"aria-labelledby":o(e)},[p("div",rt,[p("strong",{id:o(e),class:"title"},"Kana",8,it),u(Y,{toggling:a.value,"is-active":i.value,onActivate:r,onDeactivate:f},null,8,["toggling","is-active"])]),u(N,{class:"expand-button","aria-pressed":t.value,onClick:k[0]||(k[0]=B=>t.value=!t.value)},{default:y(()=>[t.value?(l(),d(A,{key:0},[g("Hide ")],64)):(l(),d(A,{key:1},[g("Show ")],64)),g(" ("+C(o(s))+" decks) ",1)]),_:1},8,["aria-pressed"]),t.value?(l(),d("ol",ct,[p("li",null,[u(L,{template:o($).hiragana,"toggling-category":a.value,"is-active":o(n).has("hiragana")},{default:y(()=>[u(R,E({class:"kana-table"},o(Ae)),null,16)]),_:1},8,["template","toggling-category","is-active"])]),p("li",null,[u(L,{template:o($).katakana,"toggling-category":a.value,"is-active":o(n).has("katakana")},{default:y(()=>[u(R,E({class:"kana-table"},o(De)),null,16)]),_:1},8,["template","toggling-category","is-active"])]),p("li",null,[u(L,{template:o($).hiraganaDakuten,"toggling-category":a.value,"is-active":o(n).has(o($).hiraganaDakuten.name)},{default:y(()=>[u(R,E({class:"kana-table"},o(we)),null,16)]),_:1},8,["template","toggling-category","is-active"])]),p("li",null,[u(L,{template:o($).hiraganaYoon,"toggling-category":a.value,"is-active":o(n).has(o($).hiraganaYoon.name)},{default:y(()=>[u(R,E({class:"kana-table"},o($e)),null,16)]),_:1},8,["template","toggling-category","is-active"])]),p("li",null,[u(L,{template:o($).katakanaDakuten,"toggling-category":a.value,"is-active":o(n).has(o($).katakanaDakuten.name)},{default:y(()=>[u(R,E({class:"kana-table"},o(Ie)),null,16)]),_:1},8,["template","toggling-category","is-active"])]),p("li",null,[u(L,{template:o($).katakanaYoon,"toggling-category":a.value,"is-active":o(n).has(o($).katakanaYoon.name)},{default:y(()=>[u(R,E({class:"kana-table"},o(Te)),null,16)]),_:1},8,["template","toggling-category","is-active"])])])):D("",!0)],8,nt))}}),dt=K(ut,[["__scopeId","data-v-678701c1"]]),pt={class:"categories"},mt=I({__name:"DeckBrowser",setup(m){return(t,e)=>(l(),d("ul",pt,[p("li",null,[u(dt)]),p("li",null,[u(S,{title:"JLPT",category:"jlpt","deck-templates":o(ne)},null,8,["deck-templates"])]),p("li",null,[u(S,{title:"Jōyō Kanji",category:"jouyou","deck-templates":o(re)},null,8,["deck-templates"])]),p("li",null,[u(S,{title:"News Frequency",category:"news","deck-templates":o(ie)},null,8,["deck-templates"])]),p("li",null,[u(S,{title:"Genki",category:"genki","deck-templates":o(ce)},null,8,["deck-templates"])]),p("li",null,[u(S,{title:"Basic Kanji Book",category:"basic-kanji","deck-templates":o(ue)},null,8,["deck-templates"])]),p("li",null,[u(Je)])]))}}),kt=K(mt,[["__scopeId","data-v-45aa42ba"]]),ft={class:"article-header"},yt={class:"actions"},gt=I({__name:"DeckBrowserView",setup(m){return(t,e)=>(l(),d("article",null,[p("header",ft,[e[1]||(e[1]=p("h2",{class:"title"},"Add Decks",-1)),p("div",yt,[u(N,{to:o(oe),"prefix-icon":"arrow-left"},{default:y(()=>[...e[0]||(e[0]=[g(" Back to your decks ",-1)])]),_:1},8,["to"])])]),u(kt)]))}}),Tt=K(gt,[["__scopeId","data-v-a1e5f41b"]]);export{Tt as default};
//# sourceMappingURL=DeckBrowserView-08zFzPbd.js.map
