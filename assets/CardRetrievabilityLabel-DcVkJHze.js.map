{"version":3,"file":"CardRetrievabilityLabel-DcVkJHze.js","sources":["../../src/helpers/kanjivg.ts","../../src/components/KanjiStrokesBackground.vue","../../node_modules/@luncheon/simplify-svg-path/index.js","../../src/components/KanjiStrokesPracticeCanvas.vue","../../src/components/StrokesFigure.vue","../../src/components/AppLabel.vue","../../src/components/CardRetrievabilityLabel.vue"],"sourcesContent":["import {\n  computed,\n  ComputedRef,\n  inject,\n  InjectionKey,\n  MaybeRefOrGetter,\n  provide,\n  Ref,\n  ref,\n  toValue,\n  watch,\n} from \"vue\";\n\nimport { KanjiComponent } from \"../types.ts\";\n\ntype KanjiVGStore = {\n  strokesEl: Ref<SVGGElement | null>;\n  viewBox: Ref<string | null>;\n  components: ComputedRef<Map<string, KanjiComponent>>;\n  syncing: Ref<boolean>;\n};\n\nconst KANJIVG_NAMESPACE = \"http://kanjivg.tagaini.net\";\nconst KANJIVG_KEY: InjectionKey<KanjiVGStore> = Symbol(\"kanjivg\");\n\nconst RADICAL_TYPES = [\"general\", \"tradit\", \"nelson\"];\n\nconst parser = new DOMParser();\n\nfunction countDepth(el: SVGGElement) {\n  let count = 0;\n  let closest: SVGGElement | null | undefined = el;\n\n  while (closest) {\n    count += 1;\n    closest = closest.parentElement?.closest(\"g\");\n  }\n\n  return count;\n}\n\nfunction gatherPositions(el: SVGElement): string[] {\n  const positions = [];\n\n  let ancestor = el.closest(\"[data-position]\");\n  while (ancestor instanceof SVGElement) {\n    positions.push(ancestor.dataset.position as string);\n    ancestor = ancestor.parentElement?.closest(\"[data-position]\") ?? null;\n  }\n\n  return positions;\n}\n\nexport async function fetchKanjiVG(hex: string): Promise<{\n  rect: DOMRect | null;\n  strokes: SVGGElement | null;\n}> {\n  const response = await fetch(`/kanjivg/kanji/${hex}.svg`);\n  const svgText = await response.text();\n  const svg = parser.parseFromString(svgText, \"image/svg+xml\");\n\n  let rect: DOMRect | null = null;\n  if (svg.documentElement instanceof SVGSVGElement) {\n    rect = svg.documentElement.viewBox.baseVal;\n  }\n\n  const strokes = svg.getElementById(`kvg:${hex}`) as SVGGElement | null;\n\n  if (strokes) {\n    for (const el of [...strokes.querySelectorAll(\"*\"), strokes]) {\n      if (!(el instanceof SVGElement)) {\n        continue;\n      }\n\n      for (const attr of [...el.attributes]) {\n        if (attr.namespaceURI === KANJIVG_NAMESPACE) {\n          el.dataset[attr.localName] = attr.value;\n          el.removeAttributeNS(KANJIVG_NAMESPACE, attr.localName);\n        }\n      }\n\n      el.removeAttribute(\"xmlns:kvg\");\n    }\n  }\n\n  return { strokes, rect };\n}\n\nexport function provideKanjiVG(hex: MaybeRefOrGetter<string | null>) {\n  const strokesEl = ref<SVGGElement | null>(null);\n  const viewBox = ref<string | null>(null);\n  const syncing = ref(false);\n\n  watch(\n    () => toValue(hex),\n    async (hexValue, oldHexValue) => {\n      if (!hexValue) {\n        strokesEl.value = null;\n        viewBox.value = null;\n\n        return;\n      }\n\n      if (hexValue === oldHexValue) {\n        return;\n      }\n\n      syncing.value = true;\n\n      try {\n        const { strokes, rect } = await fetchKanjiVG(hexValue);\n\n        strokesEl.value = strokes;\n        if (rect) {\n          viewBox.value = `${rect.x},${rect.y},${rect.width},${rect.height}`;\n        }\n      } finally {\n        syncing.value = false;\n      }\n    },\n    { immediate: true },\n  );\n\n  const components = computed(() => {\n    const group = strokesEl.value;\n\n    if (!group) {\n      return new Map();\n    }\n\n    const map = new Map<string, KanjiComponent[]>();\n    const radicals: Record<string, string> = {};\n\n    function insertComponent(el: SVGGElement) {\n      if (el.dataset.part && Number.parseInt(el.dataset.part) > 1) {\n        return;\n      }\n\n      const literal = el.dataset.element as string;\n      const info = {\n        element: literal,\n        original: el.dataset.original ?? null,\n        position: gatherPositions(el),\n        radical: el.dataset.radical ?? null,\n        phon: el.dataset.phon ?? null,\n        depth: countDepth(el),\n      };\n\n      let found = map.get(literal);\n      if (!found) {\n        found = [info];\n        map.set(literal, found);\n      } else {\n        found.push(info);\n      }\n\n      if (info.radical) {\n        radicals[info.radical] = literal;\n      }\n    }\n\n    if (group.dataset.radical) {\n      insertComponent(group);\n    }\n\n    for (const el of group.querySelectorAll<SVGGElement>(\"g[data-element]\")) {\n      insertComponent(el);\n    }\n\n    const sorted = new Map<string, KanjiComponent[]>();\n    for (const type of RADICAL_TYPES) {\n      const literal = radicals[type];\n      const component = map.get(literal);\n      if (component) {\n        component.sort((a, b) => {\n          if (a.radical) {\n            if (b.radical) {\n              return (\n                RADICAL_TYPES.indexOf(a.radical) -\n                RADICAL_TYPES.indexOf(b.radical)\n              );\n            }\n\n            return 1;\n          }\n          if (b.radical) {\n            return -1;\n          }\n\n          return a.depth - b.depth;\n        });\n\n        sorted.set(literal, component);\n        map.delete(literal);\n      }\n    }\n\n    for (const [literal, component] of [...map].sort(\n      ([, a], [, b]) =>\n        Math.min(...a.map(({ depth }) => depth)) -\n        Math.min(...b.map(({ depth }) => depth)),\n    )) {\n      sorted.set(literal, component);\n    }\n\n    return sorted;\n  });\n\n  provide(KANJIVG_KEY, { strokesEl, viewBox, components, syncing });\n}\n\nexport function useKanjiVG(): ComputedRef<SVGGElement | null> {\n  const store = inject(KANJIVG_KEY, null);\n\n  return computed(() => {\n    const clone = store?.strokesEl.value?.cloneNode(true) as SVGGElement | null;\n\n    return clone ?? null;\n  });\n}\n\nexport function useKanjiVGViewBox(): ComputedRef<string> {\n  const store = inject(KANJIVG_KEY, null);\n\n  return computed(() => store?.viewBox.value ?? \"0,0,109,109\");\n}\n\nexport function useKanjiVGComponents(): ComputedRef<\n  Map<string, KanjiComponent[]>\n> {\n  const store = inject(KANJIVG_KEY, null);\n\n  return computed(() => store?.components.value ?? new Map());\n}\n\nexport function useKanjiVGSyncing(): ComputedRef<boolean> {\n  const store = inject(KANJIVG_KEY, null);\n\n  return computed(() => store?.syncing.value ?? false);\n}\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\";\n\nconst props = defineProps<{\n  viewBox: string;\n}>();\n\nconst box = computed(() => {\n  const [x, y, width, height] = props.viewBox.split(\",\");\n\n  return {\n    x: Number.parseInt(x),\n    y: Number.parseInt(y),\n    width: Number.parseInt(width),\n    height: Number.parseInt(height),\n  };\n});\n\nconst midLineX = computed(() => {\n  const { x, width } = box.value;\n\n  return x + width / 2;\n});\n\nconst midLineY = computed(() => {\n  const { y, height } = box.value;\n\n  return y + height / 2;\n});\n</script>\n\n<template>\n  <g class=\"kanji-strokes-background\">\n    <rect\n      class=\"background\"\n      :x=\"box.x\"\n      :y=\"box.y\"\n      :width=\"box.width\"\n      :height=\"box.width\"\n      rx=\"5\"\n    />\n\n    <line\n      class=\"midline\"\n      :x1=\"box.x + 1\"\n      :y1=\"midLineY\"\n      :x2=\"box.x + box.width - 1\"\n      :y2=\"midLineY\"\n    />\n\n    <line\n      class=\"midline\"\n      :x1=\"midLineX\"\n      :y1=\"box.y + 1\"\n      :x2=\"midLineX\"\n      :y2=\"box.y + box.height - 1\"\n    />\n\n    <line\n      class=\"quartline\"\n      :x1=\"midLineX / 2\"\n      :y1=\"box.y + 1\"\n      :x2=\"midLineX / 2\"\n      :y2=\"box.y + box.height - 1\"\n    />\n\n    <line\n      class=\"quartline\"\n      :x1=\"(3 * midLineX) / 2\"\n      :y1=\"box.y + 1\"\n      :x2=\"(3 * midLineX) / 2\"\n      :y2=\"box.y + box.height - 1\"\n    />\n\n    <line\n      class=\"quartline\"\n      :x1=\"box.x + 1\"\n      :y1=\"midLineY / 2\"\n      :x2=\"box.x + box.width - 1\"\n      :y2=\"midLineY / 2\"\n    />\n\n    <line\n      class=\"quartline\"\n      :x1=\"box.x + 1\"\n      :y1=\"(3 * midLineY) / 2\"\n      :x2=\"box.x + box.width - 1\"\n      :y2=\"(3 * midLineY) / 2\"\n    />\n  </g>\n</template>\n\n<style scoped>\n.background {\n  fill: var(--background-strong);\n}\n\n.midline,\n.quartline {\n  stroke: light-dark(var(--light-gray), var(--dark-gray));\n}\n\n.midline {\n  stroke-width: 1px;\n  stroke-dasharray: 4;\n  stroke-dashoffset: 8;\n}\n\n.quartline {\n  stroke-width: 0.5px;\n  stroke-dasharray: 2;\n  stroke-dashoffset: 0;\n}\n</style>\n","/*\n * simplify-svg-path\n *\n * The logic is a copy of Paper.js v0.12.11.\n */\n/*\n * Paper.js - The Swiss Army Knife of Vector Graphics Scripting.\n * http://paperjs.org/\n *\n * Copyright (c) 2011 - 2020, Jürg Lehni & Jonathan Puckey\n * http://juerglehni.com/ & https://puckey.studio/\n *\n * Distributed under the MIT license. See LICENSE file for details.\n *\n * All rights reserved.\n */\n// An Algorithm for Automatically Fitting Digitized Curves\n// by Philip J. Schneider\n// from \"Graphics Gems\", Academic Press, 1990\n// Modifications and optimizations of original algorithm by Jürg Lehni.\nconst EPSILON = 1e-12;\nconst MACHINE_EPSILON = 1.12e-16;\nconst isMachineZero = (val) => val >= -MACHINE_EPSILON && val <= MACHINE_EPSILON;\n// `Math.sqrt(x * x + y * y)` seems to be faster than `Math.hypot(x, y)`\nconst hypot = (x, y) => Math.sqrt(x * x + y * y);\nconst point = (x, y) => ({ x, y });\nconst pointLength = (p) => hypot(p.x, p.y);\nconst pointNegate = (p) => point(-p.x, -p.y);\nconst pointAdd = (p1, p2) => point(p1.x + p2.x, p1.y + p2.y);\nconst pointSubtract = (p1, p2) => point(p1.x - p2.x, p1.y - p2.y);\nconst pointMultiplyScalar = (p, n) => point(p.x * n, p.y * n);\nconst pointDot = (p1, p2) => p1.x * p2.x + p1.y * p2.y;\nconst pointDistance = (p1, p2) => hypot(p1.x - p2.x, p1.y - p2.y);\nconst pointNormalize = (p, length = 1) => pointMultiplyScalar(p, length / (pointLength(p) || Infinity));\nconst createSegment = (p, i) => ({ p, i });\nconst fit = (points, closed, error) => {\n    // We need to duplicate the first and last segment when simplifying a\n    // closed path.\n    if (closed) {\n        points.unshift(points[points.length - 1]);\n        points.push(points[1]); // The point previously at index 0 is now 1.\n    }\n    const length = points.length;\n    if (length === 0) {\n        return [];\n    }\n    // To support reducing paths with multiple points in the same place\n    // to one segment:\n    const segments = [createSegment(points[0])];\n    fitCubic(points, segments, error, 0, length - 1, \n    // Left Tangent\n    pointSubtract(points[1], points[0]), \n    // Right Tangent\n    pointSubtract(points[length - 2], points[length - 1]));\n    // Remove the duplicated segments for closed paths again.\n    if (closed) {\n        segments.shift();\n        segments.pop();\n    }\n    return segments;\n};\n// Fit a Bezier curve to a (sub)set of digitized points\nconst fitCubic = (points, segments, error, first, last, tan1, tan2) => {\n    //  Use heuristic if region only has two points in it\n    if (last - first === 1) {\n        const pt1 = points[first], pt2 = points[last], dist = pointDistance(pt1, pt2) / 3;\n        addCurve(segments, [pt1, pointAdd(pt1, pointNormalize(tan1, dist)), pointAdd(pt2, pointNormalize(tan2, dist)), pt2]);\n        return;\n    }\n    // Parameterize points, and attempt to fit curve\n    const uPrime = chordLengthParameterize(points, first, last);\n    let maxError = Math.max(error, error * error), split, parametersInOrder = true;\n    // Try not 4 but 5 iterations\n    for (let i = 0; i <= 4; i++) {\n        const curve = generateBezier(points, first, last, uPrime, tan1, tan2);\n        //  Find max deviation of points to fitted curve\n        const max = findMaxError(points, first, last, curve, uPrime);\n        if (max.error < error && parametersInOrder) {\n            addCurve(segments, curve);\n            return;\n        }\n        split = max.index;\n        // If error not too large, try reparameterization and iteration\n        if (max.error >= maxError)\n            break;\n        parametersInOrder = reparameterize(points, first, last, uPrime, curve);\n        maxError = max.error;\n    }\n    // Fitting failed -- split at max error point and fit recursively\n    const tanCenter = pointSubtract(points[split - 1], points[split + 1]);\n    fitCubic(points, segments, error, first, split, tan1, tanCenter);\n    fitCubic(points, segments, error, split, last, pointNegate(tanCenter), tan2);\n};\nconst addCurve = (segments, curve) => {\n    const prev = segments[segments.length - 1];\n    prev.o = pointSubtract(curve[1], curve[0]);\n    segments.push(createSegment(curve[3], pointSubtract(curve[2], curve[3])));\n};\n// Use least-squares method to find Bezier control points for region.\nconst generateBezier = (points, first, last, uPrime, tan1, tan2) => {\n    const epsilon = /*#=*/ EPSILON, abs = Math.abs, pt1 = points[first], pt2 = points[last], \n    // Create the C and X matrices\n    C = [\n        [0, 0],\n        [0, 0],\n    ], X = [0, 0];\n    for (let i = 0, l = last - first + 1; i < l; i++) {\n        const u = uPrime[i], t = 1 - u, b = 3 * u * t, b0 = t * t * t, b1 = b * t, b2 = b * u, b3 = u * u * u, a1 = pointNormalize(tan1, b1), a2 = pointNormalize(tan2, b2), tmp = pointSubtract(pointSubtract(points[first + i], pointMultiplyScalar(pt1, b0 + b1)), pointMultiplyScalar(pt2, b2 + b3));\n        C[0][0] += pointDot(a1, a1);\n        C[0][1] += pointDot(a1, a2);\n        // C[1][0] += a1.dot(a2);\n        C[1][0] = C[0][1];\n        C[1][1] += pointDot(a2, a2);\n        X[0] += pointDot(a1, tmp);\n        X[1] += pointDot(a2, tmp);\n    }\n    // Compute the determinants of C and X\n    const detC0C1 = C[0][0] * C[1][1] - C[1][0] * C[0][1];\n    let alpha1;\n    let alpha2;\n    if (abs(detC0C1) > epsilon) {\n        // Kramer's rule\n        const detC0X = C[0][0] * X[1] - C[1][0] * X[0], detXC1 = X[0] * C[1][1] - X[1] * C[0][1];\n        // Derive alpha values\n        alpha1 = detXC1 / detC0C1;\n        alpha2 = detC0X / detC0C1;\n    }\n    else {\n        // Matrix is under-determined, try assuming alpha1 == alpha2\n        const c0 = C[0][0] + C[0][1], c1 = C[1][0] + C[1][1];\n        alpha1 = alpha2 = abs(c0) > epsilon ? X[0] / c0 : abs(c1) > epsilon ? X[1] / c1 : 0;\n    }\n    // If alpha negative, use the Wu/Barsky heuristic (see text)\n    // (if alpha is 0, you get coincident control points that lead to\n    // divide by zero in any subsequent NewtonRaphsonRootFind() call.\n    const segLength = pointDistance(pt2, pt1), eps = epsilon * segLength;\n    let handle1, handle2;\n    if (alpha1 < eps || alpha2 < eps) {\n        // fall back on standard (probably inaccurate) formula,\n        // and subdivide further if needed.\n        alpha1 = alpha2 = segLength / 3;\n    }\n    else {\n        // Check if the found control points are in the right order when\n        // projected onto the line through pt1 and pt2.\n        const line = pointSubtract(pt2, pt1);\n        // Control points 1 and 2 are positioned an alpha distance out\n        // on the tangent vectors, left and right, respectively\n        handle1 = pointNormalize(tan1, alpha1);\n        handle2 = pointNormalize(tan2, alpha2);\n        if (pointDot(handle1, line) - pointDot(handle2, line) > segLength * segLength) {\n            // Fall back to the Wu/Barsky heuristic above.\n            alpha1 = alpha2 = segLength / 3;\n            handle1 = handle2 = null; // Force recalculation\n        }\n    }\n    // First and last control points of the Bezier curve are\n    // positioned exactly at the first and last data points\n    return [pt1, pointAdd(pt1, handle1 || pointNormalize(tan1, alpha1)), pointAdd(pt2, handle2 || pointNormalize(tan2, alpha2)), pt2];\n};\n// Given set of points and their parameterization, try to find\n// a better parameterization.\nconst reparameterize = (points, first, last, u, curve) => {\n    for (let i = first; i <= last; i++) {\n        u[i - first] = findRoot(curve, points[i], u[i - first]);\n    }\n    // Detect if the new parameterization has reordered the points.\n    // In that case, we would fit the points of the path in the wrong order.\n    for (let i = 1, l = u.length; i < l; i++) {\n        if (u[i] <= u[i - 1])\n            return false;\n    }\n    return true;\n};\n// Use Newton-Raphson iteration to find better root.\nconst findRoot = (curve, point, u) => {\n    const curve1 = [], curve2 = [];\n    // Generate control vertices for Q'\n    for (let i = 0; i <= 2; i++) {\n        curve1[i] = pointMultiplyScalar(pointSubtract(curve[i + 1], curve[i]), 3);\n    }\n    // Generate control vertices for Q''\n    for (let i = 0; i <= 1; i++) {\n        curve2[i] = pointMultiplyScalar(pointSubtract(curve1[i + 1], curve1[i]), 2);\n    }\n    // Compute Q(u), Q'(u) and Q''(u)\n    const pt = evaluate(3, curve, u), pt1 = evaluate(2, curve1, u), pt2 = evaluate(1, curve2, u), diff = pointSubtract(pt, point), df = pointDot(pt1, pt1) + pointDot(diff, pt2);\n    // u = u - f(u) / f'(u)\n    return isMachineZero(df) ? u : u - pointDot(diff, pt1) / df;\n};\n// Evaluate a bezier curve at a particular parameter value\nconst evaluate = (degree, curve, t) => {\n    // Copy array\n    const tmp = curve.slice();\n    // Triangle computation\n    for (let i = 1; i <= degree; i++) {\n        for (let j = 0; j <= degree - i; j++) {\n            tmp[j] = pointAdd(pointMultiplyScalar(tmp[j], 1 - t), pointMultiplyScalar(tmp[j + 1], t));\n        }\n    }\n    return tmp[0];\n};\n// Assign parameter values to digitized points\n// using relative distances between points.\nconst chordLengthParameterize = (points, first, last) => {\n    const u = [0];\n    for (let i = first + 1; i <= last; i++) {\n        u[i - first] = u[i - first - 1] + pointDistance(points[i], points[i - 1]);\n    }\n    for (let i = 1, m = last - first; i <= m; i++) {\n        u[i] /= u[m];\n    }\n    return u;\n};\n// Find the maximum squared distance of digitized points to fitted curve.\nconst findMaxError = (points, first, last, curve, u) => {\n    let index = Math.floor((last - first + 1) / 2), maxDist = 0;\n    for (let i = first + 1; i < last; i++) {\n        const P = evaluate(3, curve, u[i - first]);\n        const v = pointSubtract(P, points[i]);\n        const dist = v.x * v.x + v.y * v.y; // squared\n        if (dist >= maxDist) {\n            maxDist = dist;\n            index = i;\n        }\n    }\n    return {\n        error: maxDist,\n        index: index,\n    };\n};\nconst getSegmentsPathData = (segments, closed, precision) => {\n    const length = segments.length;\n    const precisionMultiplier = 10 ** precision;\n    const round = precision < 16 ? (n) => Math.round(n * precisionMultiplier) / precisionMultiplier : (n) => n;\n    const formatPair = (x, y) => round(x) + ',' + round(y);\n    let first = true;\n    let prevX, prevY, outX, outY;\n    const parts = [];\n    const addSegment = (segment, skipLine) => {\n        const curX = segment.p.x;\n        const curY = segment.p.y;\n        if (first) {\n            parts.push('M' + formatPair(curX, curY));\n            first = false;\n        }\n        else {\n            const inX = curX + (segment.i?.x ?? 0);\n            const inY = curY + (segment.i?.y ?? 0);\n            if (inX === curX && inY === curY && outX === prevX && outY === prevY) {\n                // l = relative lineto:\n                if (!skipLine) {\n                    const dx = curX - prevX;\n                    const dy = curY - prevY;\n                    parts.push(dx === 0 ? 'v' + round(dy) : dy === 0 ? 'h' + round(dx) : 'l' + formatPair(dx, dy));\n                }\n            }\n            else {\n                // c = relative curveto:\n                parts.push('c' +\n                    formatPair(outX - prevX, outY - prevY) +\n                    ' ' +\n                    formatPair(inX - prevX, inY - prevY) +\n                    ' ' +\n                    formatPair(curX - prevX, curY - prevY));\n            }\n        }\n        prevX = curX;\n        prevY = curY;\n        outX = curX + (segment.o?.x ?? 0);\n        outY = curY + (segment.o?.y ?? 0);\n    };\n    if (!length)\n        return '';\n    for (let i = 0; i < length; i++)\n        addSegment(segments[i]);\n    // Close path by drawing first segment again\n    if (closed && length > 0) {\n        addSegment(segments[0], true);\n        parts.push('z');\n    }\n    return parts.join('');\n};\nconst simplifySvgPath = (points, options = {}) => {\n    if (points.length === 0) {\n        return '';\n    }\n    return getSegmentsPathData(fit(points.map(typeof points[0].x === 'number' ? (p) => point(p.x, p.y) : (p) => point(p[0], p[1])), options.closed, options.tolerance ?? 2.5), options.closed, options.precision ?? 5);\n};\nexport default simplifySvgPath;\n","<script setup lang=\"ts\">\nimport simplifySvgPath from \"@luncheon/simplify-svg-path\";\nimport { computed, ref, shallowReactive, watch } from \"vue\";\n\nimport { sleep } from \"../helpers/time.ts\";\n\nconst props = defineProps<{\n  animatePause?: boolean;\n}>();\n\nconst emit = defineEmits<{\n  stroke: [];\n}>();\n\ntype Point = { x: number; y: number };\n\nconst el = ref<SVGGElement | null>(null);\nconst svg = computed(() => el.value?.closest(\"svg\"));\nconst viewBox = computed(() => svg.value?.viewBox.baseVal);\nconst strokes = shallowReactive<string[]>([]);\nconst points = shallowReactive<Point[]>([]);\nconst hinting = ref<string | null>(null);\nconst preAnimation = ref(false);\n\nfunction toSVGCoords(event: PointerEvent): Point {\n  if (!svg.value) {\n    return { x: event.x, y: event.y };\n  }\n\n  const p = svg.value.createSVGPoint();\n  p.x = event.x;\n  p.y = event.y;\n\n  const domPoint = p.matrixTransform(svg.value.getScreenCTM()?.inverse());\n\n  return { x: domPoint.x, y: domPoint.y };\n}\n\nfunction handlePointerDown(event: PointerEvent) {\n  if (!event.isPrimary) {\n    return;\n  }\n\n  event.preventDefault();\n  el.value?.setPointerCapture(event.pointerId);\n  points.push(toSVGCoords(event));\n}\n\nfunction handlePointerMove(event: PointerEvent) {\n  if (points.length === 0 || !event.isPrimary) {\n    return;\n  }\n\n  points.push(toSVGCoords(event));\n}\n\nfunction handlePointerUp(event: PointerEvent) {\n  if (!event.isPrimary) {\n    return;\n  }\n\n  if (points.length > 1) {\n    strokes.push(simplifySvgPath(points));\n    emit(\"stroke\");\n  }\n\n  el.value?.releasePointerCapture(event.pointerId);\n  points.splice(0, points.length);\n\n  svg.value?.parentElement?.click();\n}\n\nfunction strokeKeyframes(stroke: SVGPathElement): Keyframe[] {\n  const l = stroke.getTotalLength();\n\n  return [\n    { strokeDasharray: l, strokeDashoffset: l },\n    { strokeDasharray: l, strokeDashoffset: 0 },\n  ];\n}\n\nconst strokeAnimationOptions = {\n  duration: 500,\n  easing: \"ease-in-out\",\n};\n\nconst animations: Animation[] = [];\n\nasync function startAnimation(): Promise<void> {\n  if (!el.value) {\n    return;\n  }\n\n  for (const stroke of el.value.querySelectorAll<SVGPathElement>(\n    \".practice-strokes .stroke\",\n  )) {\n    const animation = stroke.animate(\n      strokeKeyframes(stroke),\n      strokeAnimationOptions,\n    );\n\n    animation.pause();\n    animations.push(animation);\n  }\n\n  preAnimation.value = false;\n  await playAnimations();\n}\n\nasync function playAnimations(): Promise<void> {\n  let animation = animations.at(0);\n  while (animation) {\n    animation.play();\n    await animation.finished;\n\n    animations.shift();\n    animation = animations.at(0);\n\n    if (animation) {\n      await sleep(100);\n    }\n  }\n}\n\nwatch(\n  () => props.animatePause,\n  (shouldPause) => {\n    if (shouldPause) {\n      animations.at(0)?.pause();\n    } else {\n      animations.at(0)?.play();\n    }\n  },\n);\n\nconst hintPath = ref<SVGPathElement | null>(null);\nwatch(hintPath, (stroke) => {\n  if (stroke) {\n    const animation = stroke.animate(\n      strokeKeyframes(stroke),\n      strokeAnimationOptions,\n    );\n\n    animation.finished.then(() => {\n      hinting.value = null;\n    });\n  }\n});\n\nfunction clear() {\n  strokes.splice(0, strokes.length);\n}\n\nfunction pop() {\n  strokes.pop();\n}\n\nfunction push(d: string) {\n  strokes.push(d);\n}\n\nfunction hint(d: string) {\n  hinting.value = d;\n}\n\ndefineExpose({\n  clear,\n  pop,\n  push,\n  hint,\n  animate: startAnimation,\n  prepareForAnimation() {\n    preAnimation.value = true;\n  },\n});\n</script>\n\n<template>\n  <g\n    ref=\"el\"\n    class=\"kanji-strokes-practice-canvas canvas\"\n    @pointerdown=\"handlePointerDown\"\n    @pointermove=\"handlePointerMove\"\n    @pointerup=\"handlePointerUp\"\n  >\n    <rect\n      v-if=\"viewBox\"\n      class=\"background\"\n      :x=\"viewBox.x\"\n      :y=\"viewBox.y\"\n      :width=\"viewBox.width\"\n      :height=\"viewBox.height\"\n    />\n    <g v-show=\"!preAnimation\" class=\"practice-strokes\">\n      <path\n        v-for=\"(stroke, i) of strokes\"\n        :key=\"i\"\n        class=\"stroke practice-stroke\"\n        :d=\"stroke\"\n      />\n    </g>\n\n    <path v-if=\"hinting\" ref=\"hintPath\" class=\"stroke hint\" :d=\"hinting\" />\n\n    <polyline\n      class=\"stroke current-stroke\"\n      :points=\"points.map(({ x, y }) => `${x},${y}`).join(' ')\"\n    />\n  </g>\n</template>\n\n<style scoped>\n.canvas {\n  cursor: crosshair;\n  touch-action: none;\n}\n\n.background {\n  fill: transparent;\n  stroke: none;\n}\n\n.stroke {\n  fill: none;\n  stroke: currentcolor;\n  stroke-width: 3px;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n\n  &.hint {\n    color: light-dark(var(--light-gray), var(--dark-gray));\n  }\n}\n</style>\n","<script lang=\"ts\" setup>\nimport { computed, ref, shallowReactive, watch } from \"vue\";\n\nimport { sleep } from \"../helpers/time.ts\";\nimport AppButton from \"./AppButton.vue\";\nimport AppIcon from \"./AppIcon.vue\";\nimport KanjiStrokesBackground from \"./KanjiStrokesBackground.vue\";\nimport KanjiStrokesPracticeCanvas from \"./KanjiStrokesPracticeCanvas.vue\";\n\nconst practicing = defineModel<boolean>(\"practicing\", { default: false });\nconst autoHint = defineModel<boolean>(\"auto-hint\", { default: false });\n\nconst props = withDefaults(\n  defineProps<{\n    charStrokes: string[][];\n    viewBox?: string;\n    practiceMode?: boolean;\n  }>(),\n  {\n    viewBox: \"0,0,109,109\",\n    practiceMode: false,\n  },\n);\n\nconst emit = defineEmits<{\n  practiceDone: [];\n}>();\n\nconst strokePaths = ref<SVGPathElement[]>([]);\nconst practiceCanvases = ref<\n  Array<InstanceType<typeof KanjiStrokesPracticeCanvas>>\n>([]);\n\nconst animations = shallowReactive<Animation[]>([]);\nconst animating = computed(() => animations.length > 0);\nconst animationPaused = ref(false);\n\nconst comparing = ref(false);\n\nconst strokes = computed(() => props.charStrokes.flat());\n\nconst practiceStrokeSequence = shallowReactive<number[]>([]);\nconst practiceStrokeCount = computed(() => practiceStrokeSequence.length);\n\nfunction strokeKeyframes(stroke: SVGPathElement): Keyframe[] {\n  const l = stroke.getTotalLength();\n\n  return [\n    { strokeDasharray: l, strokeDashoffset: l },\n    { strokeDasharray: l, strokeDashoffset: 0 },\n  ];\n}\n\nconst strokeAnimationOptions = {\n  duration: 500,\n  easing: \"ease-in-out\",\n};\n\nfunction animate() {\n  for (const path of strokePaths.value) {\n    const animation = path.animate(\n      strokeKeyframes(path),\n      strokeAnimationOptions,\n    );\n\n    animation.pause();\n    animations.push(animation);\n  }\n\n  playAnimations();\n  playPracticeAnimations();\n}\n\nasync function playAnimations() {\n  let animation = animations.at(0);\n  while (animation) {\n    animation.play();\n    await animation.finished;\n\n    animations.shift();\n    animation = animations.at(0);\n\n    if (animation) {\n      await sleep(100);\n    }\n  }\n}\n\nasync function playPracticeAnimations() {\n  for (const canvas of practiceCanvases.value) {\n    canvas.prepareForAnimation();\n  }\n\n  for (const canvas of practiceCanvases.value) {\n    await canvas.animate();\n    await sleep(100);\n  }\n}\n\nfunction pauseAnimation() {\n  animations.at(0)?.pause();\n  animationPaused.value = true;\n}\n\nfunction resumeAnimation() {\n  animations.at(0)?.play();\n  animationPaused.value = false;\n}\n\nfunction handleNewPracticeStroke(i: number) {\n  practiceStrokeSequence.push(i);\n\n  const count = practiceStrokeCount.value;\n\n  if (props.practiceMode && count === strokes.value.length) {\n    emit(\"practiceDone\");\n  }\n\n  if (props.practiceMode && autoHint.value && count < strokes.value.length) {\n    showHint();\n  }\n}\n\nfunction findNextStroke() {\n  if (practiceStrokeCount.value >= strokes.value.length) {\n    return null;\n  }\n\n  const counts = Array.from({ length: props.charStrokes.length }, () => 0);\n  for (const index of practiceStrokeSequence) {\n    counts[index] += 1;\n  }\n\n  let path: string | undefined;\n  let index = -1;\n  for (const paths of props.charStrokes) {\n    index += 1;\n    path = paths.at(counts[index]);\n\n    if (path) {\n      break;\n    }\n  }\n\n  if (!path) {\n    return null;\n  }\n\n  const canvas = practiceCanvases.value.at(index);\n\n  if (!canvas) {\n    return null;\n  }\n\n  return { path, canvas, index };\n}\n\nfunction showHint() {\n  const next = findNextStroke();\n\n  if (!next) {\n    return;\n  }\n\n  const { path, canvas } = next;\n  canvas.hint(path);\n}\n\nfunction pushPracticeStroke() {\n  const next = findNextStroke();\n\n  if (!next) {\n    return;\n  }\n\n  const { path, canvas, index } = next;\n\n  canvas.push(path);\n  handleNewPracticeStroke(index);\n}\n\nfunction popPracticeStroke() {\n  const lastIndex = practiceStrokeSequence.pop();\n\n  if (lastIndex != null) {\n    practiceCanvases.value.at(lastIndex)?.pop();\n  }\n}\n\nfunction clearPracticeStrokes() {\n  for (const canvas of practiceCanvases.value) {\n    canvas.clear();\n  }\n\n  practiceStrokeSequence.splice(0, practiceStrokeSequence.length);\n  comparing.value = false;\n}\n\nfunction clearAnimations() {\n  for (const animation of animations) {\n    animation.cancel();\n  }\n  animations.splice(0, animations.length);\n  animationPaused.value = false;\n\n  for (const path of strokePaths.value) {\n    for (const animation of path.getAnimations()) {\n      animation.cancel();\n    }\n  }\n}\n\nwatch(practicing, (practiceStarted) => {\n  comparing.value = false;\n\n  if (practiceStarted) {\n    clearAnimations();\n  } else {\n    clearPracticeStrokes();\n  }\n});\n\nwatch(\n  () => props.practiceMode,\n  (isPracticeMode, wasPracticeMode) => {\n    if (isPracticeMode === false && wasPracticeMode === true) {\n      // Practice is done.\n      if (practiceStrokeCount.value === 0) {\n        // User may be using a pen and paper, just show the answer.\n        practicing.value = false;\n      } else if (practiceStrokeCount.value < strokes.value.length) {\n        // User clicked the “show answer” button before they finished\n        // writing out the character.\n        comparing.value = true;\n      }\n    }\n  },\n);\n\nwatch(\n  strokes,\n  (newValue, oldValue) => {\n    if (newValue !== oldValue) {\n      // We have a new kanji.\n      clearPracticeStrokes();\n      clearAnimations();\n      comparing.value = false;\n\n      if (practicing.value !== props.practiceMode) {\n        // And maybe toggle the practice mode.\n        practicing.value = props.practiceMode;\n      }\n\n      if (autoHint.value) {\n        requestAnimationFrame(async () => {\n          showHint();\n        });\n      }\n    }\n  },\n  { immediate: true },\n);\n</script>\n\n<template>\n  <figure class=\"strokes-figure\">\n    <div class=\"svgs\">\n      <svg\n        v-for=\"(paths, i) of charStrokes\"\n        :key=\"i\"\n        class=\"svg\"\n        :class=\"{ practicing }\"\n        :viewBox=\"viewBox\"\n        @touchstart=\"\n          if (practicing) {\n            $event.preventDefault();\n          }\n        \"\n      >\n        <KanjiStrokesBackground :viewBox=\"viewBox\" />\n\n        <g\n          class=\"strokes\"\n          :class=\"{\n            comparing:\n              animating || comparing || strokes.length <= practiceStrokeCount,\n            practicing,\n          }\"\n        >\n          <path\n            v-for=\"(path, j) of paths\"\n            :key=\"j\"\n            ref=\"strokePaths\"\n            class=\"stroke-path\"\n            :d=\"path\"\n          />\n        </g>\n\n        <KanjiStrokesPracticeCanvas\n          v-if=\"practicing\"\n          ref=\"practiceCanvases\"\n          :animate-pause=\"animationPaused\"\n          @stroke=\"handleNewPracticeStroke(i)\"\n        />\n      </svg>\n    </div>\n\n    <figcaption class=\"controls\">\n      <template v-if=\"animating\">\n        <AppButton\n          v-if=\"animationPaused\"\n          aria-label=\"Play\"\n          @click=\"resumeAnimation()\"\n        >\n          <AppIcon icon=\"play\" />\n        </AppButton>\n\n        <AppButton v-else aria-label=\"Pause\" @click=\"pauseAnimation()\">\n          <AppIcon icon=\"pause\" />\n        </AppButton>\n      </template>\n\n      <template v-else>\n        <AppButton\n          v-if=\"practicing && practiceStrokeCount < strokes.length\"\n          aria-label=\"Show Hint\"\n          @click=\"showHint()\"\n        >\n          <AppIcon icon=\"help-circle\" />\n        </AppButton>\n\n        <AppButton v-else aria-label=\"Animate Stroke Order\" @click=\"animate()\">\n          <AppIcon icon=\"play\" />\n        </AppButton>\n      </template>\n\n      <AppButton\n        v-if=\"!practiceMode\"\n        aria-lable=\"Practice Drawing\"\n        :aria-pressed=\"`${practicing}`\"\n        :filled=\"practicing\"\n        @click=\"practicing = !practicing\"\n      >\n        <AppIcon icon=\"draw\" />\n      </AppButton>\n\n      <template v-if=\"practicing\">\n        <hr class=\"rule\" />\n\n        <AppButton\n          aria-label=\"Start Over\"\n          :disabled=\"practiceStrokeCount === 0\"\n          @click=\"clearPracticeStrokes()\"\n        >\n          <AppIcon icon=\"rotate-left\" />\n        </AppButton>\n\n        <AppButton\n          aria-label=\"Skip Backward\"\n          :disabled=\"practiceStrokeCount === 0\"\n          @click=\"popPracticeStroke()\"\n        >\n          <AppIcon icon=\"skip-backward\" />\n        </AppButton>\n\n        <AppButton\n          aria-label=\"Skip Backward\"\n          :disabled=\"practiceStrokeCount === strokes.length\"\n          @click=\"pushPracticeStroke()\"\n        >\n          <AppIcon icon=\"skip-forward\" />\n        </AppButton>\n      </template>\n    </figcaption>\n  </figure>\n</template>\n\n<style scoped>\n.strokes-figure {\n  display: grid;\n  grid-template:\n    \"svgs . controls .\"\n    / minmax(15em, 25em) 1ex auto minmax(0, 1fr);\n  margin: 0;\n}\n\n.svgs {\n  align-items: start;\n  column-gap: 3px;\n  grid-area: svgs;\n  display: flex;\n}\n\n.svg {\n  touch-action: manipulation;\n  max-inline-size: 100%;\n\n  &.practicing {\n    touch-action: none;\n  }\n\n  & .strokes.practicing :deep(path) {\n    color: light-dark(var(--light-gray), var(--dark-gray));\n    display: none;\n  }\n\n  & .strokes.practicing.comparing :deep(path) {\n    display: block;\n  }\n}\n\n.stroke-path {\n  fill: none;\n  stroke: currentcolor;\n  stroke-width: 3px;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n\n.controls {\n  align-self: start;\n  display: flex;\n  flex-direction: column;\n  grid-area: controls;\n  row-gap: 1ex;\n\n  & .rule {\n    background: var(--accent-color);\n    block-size: 1px;\n    border: none;\n    inline-size: 100%;\n  }\n}\n</style>\n","<template>\n  <span class=\"app-label\"><slot /></span>\n</template>\n\n<style scoped>\n.app-label {\n  align-items: center;\n  border-radius: 1ex;\n  display: flex;\n  font-size: 0.65em;\n  font-weight: 600;\n  padding: 0.5ex 1ex;\n}\n\n:slotted(a) {\n  color: inherit;\n  text-decoration: none;\n}\n</style>\n","<script lang=\"ts\" setup>\nimport { computed } from \"vue\";\n\nimport { formatPercent } from \"../helpers/formats.ts\";\nimport { type CardRetrievability } from \"../helpers/fsrs.ts\";\nimport AppLabel from \"./AppLabel.vue\";\n\nconst props = defineProps<{\n  r?: CardRetrievability;\n  label?: string;\n}>();\n\nconst grade = computed<\"good\" | \"fair\" | \"poor\">(() => {\n  if (typeof props.r !== \"number\") {\n    return \"poor\";\n  }\n\n  if (props.r > 0.9) {\n    return \"good\";\n  }\n\n  if (props.r > 0.7) {\n    return \"fair\";\n  }\n\n  return \"poor\";\n});\n</script>\n\n<template>\n  <AppLabel\n    v-if=\"r\"\n    class=\"card-retrievability-label\"\n    title=\"Writing Retrievability\"\n    :data-r=\"grade\"\n  >\n    <span class=\"prefix\">\n      <slot name=\"label\">{{ label }}</slot>\n    </span>\n\n    <template v-if=\"typeof r === 'number'\">\n      {{ formatPercent(r) }}\n    </template>\n\n    <template v-else>{{ r }}</template>\n  </AppLabel>\n</template>\n\n<style scoped>\n.card-retrievability-label {\n  column-gap: 0.5ex;\n  color: var(--background-strong);\n\n  &[data-r=\"good\"] {\n    background: var(--green);\n  }\n\n  &[data-r=\"fair\"] {\n    background: var(--gold);\n  }\n\n  &[data-r=\"poor\"] {\n    background: var(--orange);\n  }\n}\n\n.prefix {\n  line-height: 1.2;\n}\n</style>\n"],"names":["KANJIVG_NAMESPACE","KANJIVG_KEY","RADICAL_TYPES","parser","countDepth","el","count","closest","gatherPositions","positions","ancestor","fetchKanjiVG","hex","svgText","svg","rect","strokes","attr","provideKanjiVG","strokesEl","ref","viewBox","syncing","watch","toValue","hexValue","oldHexValue","components","computed","group","map","radicals","insertComponent","literal","info","found","sorted","type","component","a","b","depth","provide","useKanjiVG","store","inject","useKanjiVGViewBox","useKanjiVGComponents","useKanjiVGSyncing","props","__props","box","x","y","width","height","midLineX","midLineY","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","EPSILON","MACHINE_EPSILON","isMachineZero","val","hypot","point","pointLength","p","pointNegate","pointAdd","p1","p2","pointSubtract","pointMultiplyScalar","n","pointDot","pointDistance","pointNormalize","length","createSegment","i","fit","points","closed","error","segments","fitCubic","first","last","tan1","tan2","pt1","pt2","dist","addCurve","uPrime","chordLengthParameterize","maxError","split","parametersInOrder","curve","generateBezier","max","findMaxError","reparameterize","tanCenter","prev","epsilon","abs","C","X","l","u","t","b0","b1","b2","b3","a1","a2","tmp","detC0C1","alpha1","alpha2","detC0X","c0","c1","segLength","eps","handle1","handle2","line","findRoot","curve1","curve2","pt","evaluate","diff","df","degree","j","m","index","maxDist","P","v","getSegmentsPathData","precision","precisionMultiplier","round","formatPair","prevX","prevY","outX","outY","parts","addSegment","segment","skipLine","curX","curY","inX","inY","dx","dy","simplifySvgPath","options","emit","__emit","shallowReactive","hinting","preAnimation","toSVGCoords","event","domPoint","handlePointerDown","handlePointerMove","handlePointerUp","strokeKeyframes","stroke","strokeAnimationOptions","animations","startAnimation","animation","playAnimations","sleep","shouldPause","hintPath","clear","pop","push","d","hint","__expose","_withDirectives","_hoisted_2","_Fragment","_renderList","_unref","practicing","_useModel","autoHint","strokePaths","practiceCanvases","animating","animationPaused","comparing","practiceStrokeSequence","practiceStrokeCount","animate","path","playPracticeAnimations","canvas","pauseAnimation","resumeAnimation","handleNewPracticeStroke","showHint","findNextStroke","counts","paths","next","pushPracticeStroke","popPracticeStroke","lastIndex","clearPracticeStrokes","clearAnimations","practiceStarted","isPracticeMode","wasPracticeMode","newValue","oldValue","_normalizeClass","_cache","$event","_createVNode","KanjiStrokesBackground","_createBlock","KanjiStrokesPracticeCanvas","_hoisted_5","AppButton","AppIcon","_renderSlot","_ctx","grade","AppLabel","_createTextVNode","_toDisplayString","formatPercent"],"mappings":"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","x_google_ignoreList":[2]}