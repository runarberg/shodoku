import{d as b,n as q,m as y,a as i,e as m,S as D,g as P,F as _,l as g,b as f,u,h as W,o as a,_ as w,L as U,C as F,$ as E,Y as G,w as x,A as M,E as z,G as A,t as h,a0 as N,P as O,M as B,c as j,x as T,a1 as Y,i as C,k as H,q as Q,a2 as Z}from"./index-CvwMh420.js";import{v as J}from"./index-wSyqKWt5.js";import{d as X}from"./db-CNlb8ZXY.js";import{W as ee}from"./WordListItem-DG-v67Ly.js";import{l as K,d as se,o as R}from"./reviews-BBX2ZUfX.js";import{W as V}from"./WordKanjiListItem-BEWdaN8y.js";import{a as te,B as ae,_ as ne,c as re}from"./WordWritingSelect-CSCIfy6F.js";import"./kanji-Gig8OntP.js";import"./fsrs-BBura_Wb.js";const oe={class:"word-search-results"},ie={class:"results-list"},le=b({__name:"BookmarkedWords",setup(c){const r=q(async()=>{const t=[],e=(await X).transaction("bookmarked-words").store.index("bookmarkedAt").iterate(null,"prev");for await(const o of e)t.push(o.primaryKey);return t},[]),s=y(20);function l(){s.value+=20}function n([{isIntersecting:t}]){t&&l()}return(t,e)=>(a(),i("section",oe,[e[2]||(e[2]=m("h3",null,"Bookmarked Words",-1)),m("ul",ie,[(a(!0),i(_,null,g(u(r).slice(0,s.value),o=>(a(),i("li",{key:o},[f(ee,{word:o},null,8,["word"])]))),128))]),s.value<u(r).length?D((a(),i("button",{key:0,class:"next-page-button",onClick:e[0]||(e[0]=o=>l())},e[1]||(e[1]=[W(" Load More ")]))),[[u(J),n]]):P("",!0)]))}}),ce=w(le,[["__scopeId","data-v-8a1217ab"]]);function ue(c){return new Worker("/assets/component-picker.worker-D024QUGA.js",{name:c?.name})}const S=new ue;function de(){const c=y(new Map),r=y(new Set),s=y(new Map),l=U(new Set);function n(t){t.data.type==="all-radicals"?c.value=t.data.allRadicals:t.data.type==="kanji-selection"&&(s.value=t.data.kanjiSelection,r.value=t.data.filteredRadicals)}return S.addEventListener("message",n),S.postMessage("init"),E(()=>{S.removeEventListener("message",n)}),F(l,()=>{if(l.size===0){r.value=new Set,s.value=new Map;return}S.postMessage(G(l))}),{allRadicals:c,filteredRadicals:r,selectedRadicals:l,kanjiSelection:s}}const pe={class:"component-picker"},me={class:"control-buttons"},ke={key:0,class:"empty-message"},fe={key:1,class:"list kanji-list"},_e=["aria-labelledby"],ve=["id"],ge={class:"list kanji-literal-list"},he=["onClick"],ye={class:"list radical-list"},be=["aria-labelledby"],we=["id"],$e={class:"list radical-literal-list"},je=["aria-pressed","disabled","onClick"],We=b({__name:"ComponentPicker",emits:["select","close"],setup(c){const{allRadicals:r,filteredRadicals:s,kanjiSelection:l,selectedRadicals:n}=de(),t=A();function e(o){n.has(o)?n.delete(o):n.add(o)}return(o,d)=>(a(),i("div",pe,[m("div",me,[f(M,{class:"clear-button",inline:"",disabled:u(n).size===0,onClick:d[0]||(d[0]=p=>u(n).clear())},{default:x(()=>d[2]||(d[2]=[W(" Clear ")])),_:1,__:[2]},8,["disabled"]),f(M,{class:"close-button",inline:"",onClick:d[1]||(d[1]=p=>o.$emit("close"))},{default:x(()=>[f(z,{icon:"x-mark"})]),_:1})]),u(n).size===0?(a(),i("p",ke," Select one or more components below. Pick any of the resulting kanji. ")):(a(),i("ol",fe,[(a(!0),i(_,null,g(u(l),([p,v])=>(a(),i("li",{key:p,"aria-labelledby":`${u(t)}/kanji-list/${p}`,class:"kanji-list-item"},[m("strong",{id:`${u(t)}/kanji-list/${p}`,class:"stroke-count-label"},h(p),9,ve),m("ol",ge,[(a(!0),i(_,null,g(v,k=>(a(),i("li",{key:k,class:"kanji-literal-list-item"},[m("button",{class:"kanji-select-button",onClick:$=>o.$emit("select",k)},h(k),9,he)]))),128))])],8,_e))),128))])),m("ol",ye,[(a(!0),i(_,null,g(u(r),([p,v])=>(a(),i("li",{key:p,"aria-labelledby":`${u(t)}/radical-list/${p}`,class:"radical-list-item"},[m("strong",{id:`${u(t)}/radical-list/${p}`,class:"stroke-count-label"},h(p),9,we),m("ol",$e,[(a(!0),i(_,null,g(v,k=>(a(),i("li",{key:k,class:"radical-literal-list-item"},[m("button",{class:"radical-toggle-button","aria-pressed":u(n).has(k),disabled:u(s).size>0&&!u(s).has(k),onClick:$=>e(k)},h(k),9,je)]))),128))])],8,be))),128))])]))}}),Re=w(We,[["__scopeId","data-v-6487d67b"]]);function Se(c){return new Worker("/assets/search-kanji.worker-DUz-mWlb.js",{name:c?.name})}function xe(c){return new Worker("/assets/search-words.worker-BKHYCkZA.js",{name:c?.name})}const I=new Se,L=new xe;function Ce(c){const r=O([]);N(()=>B(c),async l=>{r.splice(0,r.length),l.length>0&&L.postMessage(l)},{debounce:300,immediate:!0});function s(l){const n=l.data;n.phrase===B(c)&&r.push(n)}return L.addEventListener("message",s),E(()=>{L.removeEventListener("message",s)}),r}function Ie(c){const r=y([]);N(()=>B(c),async l=>{l.length===0||K(l)?r.value=[]:I.postMessage(l)},{debounce:300,immediate:!0});function s(l){r.value=l.data}return I.addEventListener("message",s),E(()=>{I.removeEventListener("message",s)}),r}const Le={key:0,class:"kanji-search-results"},Me={key:0,class:"results-list"},Be={key:1,class:"results-list"},Ke=b({__name:"KanjiSearchResults",props:{phrase:{}},setup(c){const r=c,s=j(()=>{const n=new Set;for(const t of r.phrase)se(t)&&n.add(t);return n}),l=Ie(()=>r.phrase);return(n,t)=>s.value.size>0||u(l).length>0?(a(),i("section",Le,[t[0]||(t[0]=m("h3",null,"Kanji",-1)),s.value.size>0?(a(),i("ul",Me,[(a(!0),i(_,null,g(s.value,e=>(a(),i("li",{key:e},[f(V,{kanji:e},null,8,["kanji"])]))),128))])):(a(),i("ul",Be,[(a(!0),i(_,null,g(u(l),e=>(a(),i("li",{key:e.id},[f(V,{kanji:String.fromCodePoint(e.id)},null,8,["kanji"])]))),128))]))])):P("",!0)}}),Pe=w(Ke,[["__scopeId","data-v-9f3709e3"]]),Ee={class:"word-search-result-item"},Ve={class:"meaning"},De=b({__name:"WordSearchResultItem",props:{result:{}},setup(c){const r=c,s=te(()=>r.result.id),l=j(()=>s.value?s.value.readings?.at(0)?.text:r.result.readings.at(0)),n=j(()=>{const{match:e,readings:o,writings:d}=r.result;if(s.value){let k;return K(e)?k=s.value.furigana?.find($=>$.writing===e):R(e)&&(k=s.value.furigana?.find($=>$.reading===e)),k||(k=s.value.furigana?.at(0)),k?k.furigana:s.value.writings?.at(0)?.text??s.value.readings?.at(0)?.text??e}if(K(e))return[{ruby:e,rt:o.at(0)}];const[p]=d;if(R(e))return p?[{ruby:p,rt:e}]:e;const[v]=o;return p&&v?[{ruby:v,rt:v}]:p??v??e}),t=j(()=>{const{match:e,glossary:o}=r.result;if(s.value){if(R(e))return s.value.meanings?.at(0)??o.at(0)??e;const d=s.value.meanings?.find(p=>p.glossary?.includes(e));if(d)return d}return R(e)?o.at(0)??e:e});return(e,o)=>{const d=T("RouterLink");return a(),i("div",Ee,[f(ae,{"word-id":e.result.id,reading:l.value,class:"bookmark-button"},null,8,["word-id","reading"]),f(d,{to:u(Y)(e.result.id),class:"word"},{default:x(()=>[typeof n.value=="string"?(a(),i(_,{key:0},[W(h(n.value),1)],64)):(a(),C(ne,{key:1,furigana:n.value},null,8,["furigana"]))]),_:1},8,["to"]),m("div",Ve,[typeof t.value=="string"?(a(),i(_,{key:0},[W(h(t.value),1)],64)):(a(),C(re,{key:1,meaning:t.value},null,8,["meaning"]))])])}}}),ze=w(De,[["__scopeId","data-v-0d4c49c2"]]),Ae={class:"word-search-results"},Ne={class:"results-list"},qe=b({__name:"WordSearchResults",props:{phrase:{}},setup(c){const r=c,s=Ce(()=>r.phrase);return(l,n)=>(a(),i("section",Ae,[n[0]||(n[0]=m("h3",null,"Words",-1)),m("ul",Ne,[(a(!0),i(_,null,g(u(s),t=>(a(),i("li",{key:t.id},[f(ze,{result:t},null,8,["result"])]))),128))])]))}}),Ue=w(qe,[["__scopeId","data-v-c5bb8635"]]),Fe={class:"search-field"},Ge={class:"label"},Oe=b({__name:"DictionaryView",setup(c){const r=Q(),s=H(),l=A(),n=y(!1),t=j({get(){return typeof r.query.search!="string"?"":r.query.search},set(e){s.replace({query:{search:e||void 0}})}});return(e,o)=>(a(),i(_,null,[m("div",Fe,[m("label",Ge,[f(z,{icon:"search",class:"icon"})]),D(m("input",{"onUpdate:modelValue":o[0]||(o[0]=d=>t.value=d),type:"search","aria-label":"search",placeholder:"Search for words, kanji, meanings, etc."},null,512),[[Z,t.value]]),f(M,{filled:n.value,"aria-pressed":n.value,"aria-controls":u(l),"aria-label":"Component Picker",onClick:o[1]||(o[1]=d=>n.value=!n.value)},{default:x(()=>o[4]||(o[4]=[W(" éƒ¨ ")])),_:1,__:[4]},8,["filled","aria-pressed","aria-controls"])]),n.value?(a(),C(Re,{key:0,id:u(l),onClose:o[2]||(o[2]=d=>n.value=!1),onSelect:o[3]||(o[3]=d=>t.value+=d)},null,8,["id"])):P("",!0),t.value?(a(),i(_,{key:1},[f(Pe,{class:"kanji-results",phrase:t.value},null,8,["phrase"]),f(Ue,{class:"word-results",phrase:t.value},null,8,["phrase"])],64)):(a(),C(ce,{key:2,class:"bookmark-results"}))],64))}}),ts=w(Oe,[["__scopeId","data-v-7a01b74c"]]);export{ts as default};
