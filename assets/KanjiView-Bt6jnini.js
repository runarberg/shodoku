import{G,q as j,H,d as D,I as S,a as k,e as c,D as v,i as y,g as h,J as U,u,y as V,K as q,L as J,o as n,_ as E,b as m,A as M,M as W,w as g,T as Y,h as $,t as I,N as T,O as z,c as x,P as Q,F as _,l as N,R as X,s as Z}from"./index-3SZaU-iL.js";import{K as ee,a as te,b as ae,c as oe,d as ne}from"./KanjiWordList-D7GvJb65.js";import{p as le,S as se}from"./reviews-C0tp5JDi.js";import{b as ie}from"./fsrs-D14ruAop.js";import{a as re,u as ce}from"./formats-BZjAUNO7.js";import{g as ue}from"./WordWritingSelect-DnSPLHUE.js";import{e as L,c as de}from"./decks-gvUqHaG3.js";import{c as pe}from"./decks-BkI394ym.js";import{A as fe,a as me}from"./AppNumberInput-Ds6KzMhA.js";import{A as ke}from"./AppCheckbox-oFNiMTmY.js";import{u as ge,a as ve}from"./kanji-BFHyEMwy.js";import{p as be}from"./CardRetrievabilityLabel-46Oryz0n.js";import"./kanji-components-C9A26trC.js";import"./AppLoading-dOxd0OoU.js";import"./index-BVkQD7g-.js";import"./db-CmzCis4b.js";import"./WordListItem-DZ1Oghxl.js";const F=Symbol("menu-injection-key");function O(){return{open:j(!1)}}function ye(){const e=O();return H(F,e),e}function je(){return G(F,O,!0)}const $e=["aria-label","popovertarget","disabled"],_e=["id"],he={role:"list",class:"menu"},De=D({__name:"AppMenu",props:{open:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},toggleIcon:{default:null}},emits:["update:open"],setup(e,{emit:d}){J(i=>({v537a91c9:u(A)}));const r=e,p=d,l=j(null),a=j(null),t=j(null),s=ye(),b=q(),A=`--${b}`.replace(":","-anchor-");function w(){s.open.value=!1}function o(i){i.relatedTarget instanceof Element&&!t.value?.contains(i.relatedTarget)&&w()}function f(i){s.open.value=i.newState==="open"}function K(i){if(i.newState==="open"&&!("anchorName"in document.documentElement.style)){const C=l.value?.getBoundingClientRect(),B=a.value?.style;B&&C&&(B.insetBlockStart=`${C.bottom+window.scrollY}px`,B.insetInlineEnd=`calc(100% - ${C.right}px)`)}}return S(s.open,i=>{i?a.value?.showPopover():a.value?.hidePopover(),p("update:open",i)}),S(()=>r.open,i=>{i!==s.open.value&&(s.open.value=i)}),(i,C)=>(n(),k("div",{ref_key:"menuEl",ref:t,class:"app-menu popover-container",onFocusout:C[0]||(C[0]=B=>o(B))},[c("button",{ref_key:"toggleButton",ref:l,class:V(["toggle-button",{open:u(s).open.value}]),"aria-label":i.$slots.toggle?void 0:"Options",popovertarget:u(b),disabled:e.disabled},[v(i.$slots,"toggle",{},()=>[e.toggleIcon?(n(),y(U,{key:0,icon:e.toggleIcon,class:"toggle-icon"},null,8,["icon"])):h("",!0)],!0)],10,$e),c("div",{id:u(b),ref_key:"popoverEl",ref:a,class:"popover",popover:"",onBeforetoggle:K,onToggle:f},[c("menu",he,[v(i.$slots,"default",{},void 0,!0)])],40,_e)],544))}}),we=E(De,[["__scopeId","data-v-cc4e4138"]]),Ce={class:"app-menu-item"},Ie={class:"text"},Ae=D({__name:"AppMenuItem",props:{prefixIcon:{default:null},to:{default:null},disabled:{type:Boolean,default:!1},persistent:{type:Boolean,default:!1},replace:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:d}){const r=e,p=d,{open:l}=je();function a(t){r.disabled||(r.persistent||(l.value=!1),p("click",t))}return(t,s)=>(n(),k("li",Ce,[m(M,{type:"button",inline:"",class:"button",disabled:e.disabled,"prefix-icon":e.prefixIcon,to:e.to,replace:e.replace,onClick:a},W({default:g(()=>[c("span",Ie,[v(t.$slots,"default",{},void 0,!0)])]),_:2},[t.$slots.prefix?{name:"prefix",fn:g(()=>[v(t.$slots,"prefix",{},void 0,!0)]),key:"0"}:void 0]),1032,["disabled","prefix-icon","to","replace"])]))}}),P=E(Ae,[["__scopeId","data-v-746e6864"]]),Be=["aria-labelledby"],Me={class:"header"},xe=["id"],Ee={class:"body"},Ke=["id"],Ne={class:"footer"},Ve={class:"buttons"},Se=D({__name:"AppDialog",props:{title:{default:null},cancelLabel:{default:null},confirmDisabled:{type:Boolean,default:!1},confirmLabel:{default:null}},emits:["cancel","close","confirm"],setup(e,{expose:d,emit:r}){const p=r,l=j(!1),a=j(null),t=q();function s(o=""){p("close"),l.value=!1,a.value?.open&&a.value.close(o)}function b(){p("cancel"),s("")}function A(){s("confirmed"),p("confirm")}function w(){l.value=!0,a.value?.showModal()}return d({close:s,show:w}),(o,f)=>(n(),y(Y,{to:"[id='app:dialogs']"},[c("dialog",z(o.$attrs,{ref_key:"dialog",ref:a,"aria-labelledby":`${u(t)}/title`,class:"app-dialog",onCancel:T(b,["prevent"])}),[c("header",Me,[c("strong",{id:`${u(t)}/title`,class:"title"},[v(o.$slots,"title",{},()=>[$(I(e.title),1)],!0)],8,xe),m(M,{"aria-label":"close",class:"close-button",inline:"",onClick:b},{default:g(()=>[m(U,{icon:"x-mark"})]),_:1})]),c("div",Ee,[v(o.$slots,"default",{},void 0,!0),c("form",{id:`${u(t)}/form`,class:"form",method:"dialog",onSubmit:T(A,["prevent"])},[v(o.$slots,"form",{},void 0,!0)],40,Ke)]),c("footer",Ne,[v(o.$slots,"footer",{},void 0,!0),c("div",Ve,[v(o.$slots,"buttons",{},void 0,!0),e.cancelLabel||o.$slots.cancel?(n(),y(M,{key:0,onClick:b},{default:g(()=>[v(o.$slots,"cancel",{},()=>[$(I(e.cancelLabel),1)],!0)]),_:3})):h("",!0),e.confirmLabel||o.$slots.confirm?(n(),y(M,{key:1,type:"submit",filled:"",form:`${u(t)}/form`,disabled:e.confirmDisabled},{default:g(()=>[v(o.$slots,"confirm",{},()=>[$(I(e.confirmLabel),1)],!0)]),_:3},8,["form","disabled"])):h("",!0)])])],16,Be)]))}}),Te=E(Se,[["__scopeId","data-v-95bc6f59"]]),Le=D({__name:"KanjiManageDecksDeckItem",props:{kanji:{},deck:{}},setup(e){const d=e,r=x(()=>d.deck.cards.includes(d.kanji.codepoint));async function p(){const{deck:l}=d,{cards:a}=l,{codepoint:t}=d.kanji;r.value?L({...l,cards:a.filter(s=>s!==t)}):a.includes(t)||L({...l,cards:[...a,t]})}return(l,a)=>(n(),y(ke,{"model-value":r.value,"onUpdate:modelValue":p},{label:g(()=>[c("span",{class:V(["label",{active:r.value}])},I(e.deck.label),3)]),_:1},8,["model-value"]))}}),R=E(Le,[["__scopeId","data-v-369949f9"]]),Pe={class:"list"},Re={key:0},Ue=["open"],qe={class:"category-summary"},Fe={class:"list"},Oe=D({__name:"KanjiManageDecksDialog",props:{kanji:{}},setup(e,{expose:d}){const r=e,p=j(null),l=re(),a=j(!1),t=Q({label:"",priority:1}),s=x(()=>le(l.value??[],ue(w=>w.category)));async function b(){a.value=!1,t.label="",t.priority=1,p.value?.show()}function A(){a.value&&de({label:t.label,priority:t.priority,cards:[r.kanji.codepoint],cardTypes:["kanji-write","kanji-read"]})}return d({show:b}),(w,o)=>(n(),y(Te,{ref_key:"dialog",ref:p,title:` ${e.kanji.literal}: Manage Decks`,"cancel-label":a.value?"Cancel":null,"confirm-label":a.value?"Cretate Deck":"Close",onConfirm:A},{form:g(()=>[c("ul",Pe,[(n(!0),k(_,null,N(s.value,([f,K])=>(n(),k(_,{key:f},[f!=="custom"?(n(),k("li",Re,[c("details",{class:"category-details",open:K.some(({cards:i})=>i.includes(e.kanji.codepoint))},[c("summary",qe,I(u(pe)(f)),1),c("ul",Fe,[(n(!0),k(_,null,N(K,i=>(n(),k("li",{key:i.name},[m(R,{kanji:e.kanji,deck:i},null,8,["kanji","deck"])]))),128))])],8,Ue)])):h("",!0)],64))),128)),(n(!0),k(_,null,N(s.value.get("custom")??[],f=>(n(),k("li",{key:f.name},[m(R,{kanji:e.kanji,deck:f},null,8,["kanji","deck"])]))),128))]),c("div",{class:V(["create-new-fields",{expanded:a.value}])},[a.value?(n(),k(_,{key:1},[m(fe,{modelValue:t.label,"onUpdate:modelValue":o[1]||(o[1]=f=>t.label=f),class:"name-field",label:"Deck Name",required:""},null,8,["modelValue"]),m(me,{modelValue:t.priority,"onUpdate:modelValue":o[2]||(o[2]=f=>t.priority=f),class:"priority-field",label:"Priority",min:"1",required:""},null,8,["modelValue"])],64)):(n(),y(M,{key:0,class:"create-new-expand-button","prefix-icon":"plus",inline:"",onClick:o[0]||(o[0]=f=>a.value=!0)},{default:g(()=>[...o[5]||(o[5]=[$(" Create New ",-1)])]),_:1}))],2)]),default:g(()=>[c("p",null,[o[3]||(o[3]=$(" Select a decks to add/remove ",-1)),c("strong",null,I(e.kanji.literal),1),o[4]||(o[4]=$(" to/from. ",-1))])]),_:1},8,["title","cancel-label","confirm-label"]))}}),Ge=E(Oe,[["__scopeId","data-v-a1ee2006"]]),He=D({__name:"KanjiExploreActions",props:{kanji:{}},setup(e){const d=e,r=j(null),p=ce(()=>d.kanji.codepoint),l=ie(()=>d.kanji.codepoint,["kanji-write","kanji-read"]),a=x(()=>{for(const{fsrs:t}of l.value.values())if(t.state!==se.New)return!1;return!0});return(t,s)=>(n(),y(we,{"toggle-icon":"ellipsis-vertical"},{default:g(()=>[m(P,{onClick:s[0]||(s[0]=b=>r.value?.show())},{default:g(()=>[u(p).length===0?(n(),k(_,{key:0},[$("Add to deck")],64)):(n(),k(_,{key:1},[$("Manage decks")],64))]),_:1}),u(p).length>0&&a.value?(n(),y(P,{key:0,to:{name:u(X),query:{"card-id":e.kanji.codepoint,"card-type":"kanji-write",singleton:""}},replace:""},{default:g(()=>[...s[1]||(s[1]=[$(" Review now ",-1)])]),_:1},8,["to"])):h("",!0),m(Ge,{ref_key:"manageDecksDialog",ref:r,kanji:e.kanji},null,8,["kanji"])]),_:1}))}}),Je={key:0,class:"kanji-card"},dt=D({__name:"KanjiView",setup(e){const d=Z(),r=x(()=>{const t=d.params.kanji;return typeof t!="string"||[...t].length!==1?null:t.codePointAt(0)??null}),p=x(()=>r.value?.toString(16).padStart(5,"0")??null),l=ge(r),a=ve(r);return be(p),(t,s)=>u(l)?(n(),k("article",Je,[m(ee,{class:"title",kanji:u(l)},{actions:g(()=>[m(He,{kanji:u(l)},null,8,["kanji"])]),_:1},8,["kanji"]),m(te,{class:"readings",kanji:u(l)},null,8,["kanji"]),m(ae,{class:"strokes",kanji:u(l).literal},null,8,["kanji"]),m(oe,{class:"components"}),u(a)?(n(),y(ne,{key:0,class:"words","kanji-vocab":u(a)},null,8,["kanji-vocab"])):h("",!0)])):h("",!0)}});export{dt as default};
//# sourceMappingURL=KanjiView-Bt6jnini.js.map
