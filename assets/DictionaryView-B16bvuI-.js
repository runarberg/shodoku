import{d as b,n as A,q as y,a as i,e as m,U as E,g as P,F as _,l as g,b as k,u,h as W,o as a,_ as w,P as U,I as F,a1 as V,$ as O,w as x,A as M,J as z,K as N,t as h,a2 as q,X as Q,W as B,c as j,z as T,C as J,i as I,k as X,s as G,a3 as H}from"./index-3SZaU-iL.js";import{v as Y}from"./index-BVkQD7g-.js";import{d as Z}from"./db-CmzCis4b.js";import{W as ee}from"./WordListItem-DZ1Oghxl.js";import{l as K,d as se,o as R}from"./reviews-C0tp5JDi.js";import{W as D}from"./WordKanjiListItem-CqnHlfCO.js";import{u as te,B as ae,_ as ne,V as re}from"./WordWritingSelect-DnSPLHUE.js";import"./kanji-BFHyEMwy.js";import"./fsrs-D14ruAop.js";const oe={class:"word-search-results"},ie={class:"results-list"},le=b({__name:"BookmarkedWords",setup(c){const r=A(async()=>{const t=[],e=(await Z).transaction("bookmarked-words").store.index("bookmarkedAt").iterate(null,"prev");for await(const o of e)t.push(o.primaryKey);return t},[]),s=y(20);function l(){s.value+=20}function n([{isIntersecting:t}]){t&&l()}return(t,e)=>(a(),i("section",oe,[e[2]||(e[2]=m("h3",null,"Bookmarked Words",-1)),m("ul",ie,[(a(!0),i(_,null,g(u(r).slice(0,s.value),o=>(a(),i("li",{key:o},[k(ee,{word:o},null,8,["word"])]))),128))]),s.value<u(r).length?E((a(),i("button",{key:0,class:"next-page-button",onClick:e[0]||(e[0]=o=>l())},[...e[1]||(e[1]=[W(" Load More ",-1)])])),[[u(Y),n]]):P("",!0)]))}}),ce=w(le,[["__scopeId","data-v-8a1217ab"]]);function ue(c){return new Worker("/assets/component-picker.worker-BeQQggMa.js",{name:c?.name})}const S=new ue;function de(){const c=y(new Map),r=y(new Set),s=y(new Map),l=U(new Set);function n(t){t.data.type==="all-radicals"?c.value=t.data.allRadicals:t.data.type==="kanji-selection"&&(s.value=t.data.kanjiSelection,r.value=t.data.filteredRadicals)}return S.addEventListener("message",n),S.postMessage("init"),V(()=>{S.removeEventListener("message",n)}),F(l,()=>{if(l.size===0){r.value=new Set,s.value=new Map;return}S.postMessage(O(l))}),{allRadicals:c,filteredRadicals:r,selectedRadicals:l,kanjiSelection:s}}const pe={class:"component-picker"},me={class:"control-buttons"},fe={key:0,class:"empty-message"},ke={key:1,class:"list kanji-list"},_e=["aria-labelledby"],ve=["id"],ge={class:"list kanji-literal-list"},he=["onClick"],ye={class:"list radical-list"},be=["aria-labelledby"],we=["id"],$e={class:"list radical-literal-list"},je=["aria-pressed","disabled","onClick"],We=b({__name:"ComponentPicker",emits:["select","close"],setup(c){const{allRadicals:r,filteredRadicals:s,kanjiSelection:l,selectedRadicals:n}=de(),t=N();function e(o){n.has(o)?n.delete(o):n.add(o)}return(o,d)=>(a(),i("div",pe,[m("div",me,[k(M,{class:"clear-button",inline:"",disabled:u(n).size===0,onClick:d[0]||(d[0]=p=>u(n).clear())},{default:x(()=>[...d[2]||(d[2]=[W(" Clear ",-1)])]),_:1},8,["disabled"]),k(M,{class:"close-button",inline:"",onClick:d[1]||(d[1]=p=>o.$emit("close"))},{default:x(()=>[k(z,{icon:"x-mark"})]),_:1})]),u(n).size===0?(a(),i("p",fe," Select one or more components below. Pick any of the resulting kanji. ")):(a(),i("ol",ke,[(a(!0),i(_,null,g(u(l),([p,v])=>(a(),i("li",{key:p,"aria-labelledby":`${u(t)}/kanji-list/${p}`,class:"kanji-list-item"},[m("strong",{id:`${u(t)}/kanji-list/${p}`,class:"stroke-count-label"},h(p),9,ve),m("ol",ge,[(a(!0),i(_,null,g(v,f=>(a(),i("li",{key:f,class:"kanji-literal-list-item"},[m("button",{class:"kanji-select-button",onClick:$=>o.$emit("select",f)},h(f),9,he)]))),128))])],8,_e))),128))])),m("ol",ye,[(a(!0),i(_,null,g(u(r),([p,v])=>(a(),i("li",{key:p,"aria-labelledby":`${u(t)}/radical-list/${p}`,class:"radical-list-item"},[m("strong",{id:`${u(t)}/radical-list/${p}`,class:"stroke-count-label"},h(p),9,we),m("ol",$e,[(a(!0),i(_,null,g(v,f=>(a(),i("li",{key:f,class:"radical-literal-list-item"},[m("button",{class:"radical-toggle-button","aria-pressed":u(n).has(f),disabled:u(s).size>0&&!u(s).has(f),onClick:$=>e(f)},h(f),9,je)]))),128))])],8,be))),128))])]))}}),Re=w(We,[["__scopeId","data-v-6487d67b"]]);function Se(c){return new Worker("/assets/search-kanji.worker-DUfWeBh-.js",{name:c?.name})}function xe(c){return new Worker("/assets/search-words.worker-D90bN5mW.js",{name:c?.name})}const C=new Se,L=new xe;function Ie(c){const r=Q([]);q(()=>B(c),async l=>{r.splice(0,r.length),l.length>0&&L.postMessage(l)},{debounce:300,immediate:!0});function s(l){const n=l.data;n.phrase===B(c)&&r.push(n)}return L.addEventListener("message",s),V(()=>{L.removeEventListener("message",s)}),r}function Ce(c){const r=y([]);q(()=>B(c),async l=>{l.length===0||K(l)?r.value=[]:C.postMessage(l)},{debounce:300,immediate:!0});function s(l){r.value=l.data}return C.addEventListener("message",s),V(()=>{C.removeEventListener("message",s)}),r}const Le={key:0,class:"kanji-search-results"},Me={key:0,class:"results-list"},Be={key:1,class:"results-list"},Ke=b({__name:"KanjiSearchResults",props:{phrase:{}},setup(c){const r=c,s=j(()=>{const n=new Set;for(const t of r.phrase)se(t)&&n.add(t);return n}),l=Ce(()=>r.phrase);return(n,t)=>s.value.size>0||u(l).length>0?(a(),i("section",Le,[t[0]||(t[0]=m("h3",null,"Kanji",-1)),s.value.size>0?(a(),i("ul",Me,[(a(!0),i(_,null,g(s.value,e=>(a(),i("li",{key:e},[k(D,{kanji:e},null,8,["kanji"])]))),128))])):(a(),i("ul",Be,[(a(!0),i(_,null,g(u(l),e=>(a(),i("li",{key:e.id},[k(D,{kanji:String.fromCodePoint(e.id)},null,8,["kanji"])]))),128))]))])):P("",!0)}}),Pe=w(Ke,[["__scopeId","data-v-9f3709e3"]]),Ve={class:"word-search-result-item"},De={class:"meaning"},Ee=b({__name:"WordSearchResultItem",props:{result:{}},setup(c){const r=c,s=te(()=>r.result.id),l=j(()=>s.value?s.value.readings?.at(0)?.text:r.result.readings.at(0)),n=j(()=>{const{match:e,readings:o,writings:d}=r.result;if(s.value){let f;return K(e)?f=s.value.furigana?.find($=>$.writing===e):R(e)&&(f=s.value.furigana?.find($=>$.reading===e)),f||(f=s.value.furigana?.at(0)),f?f.furigana:s.value.writings?.at(0)?.text??s.value.readings?.at(0)?.text??e}if(K(e))return[{ruby:e,rt:o.at(0)}];const[p]=d;if(R(e))return p?[{ruby:p,rt:e}]:e;const[v]=o;return p&&v?[{ruby:v,rt:v}]:p??v??e}),t=j(()=>{const{match:e,glossary:o}=r.result;if(s.value){if(R(e))return s.value.meanings?.at(0)??o.at(0)??e;const d=s.value.meanings?.find(p=>p.glossary?.includes(e));if(d)return d}return R(e)?o.at(0)??e:e});return(e,o)=>{const d=T("RouterLink");return a(),i("div",Ve,[k(ae,{"word-id":c.result.id,reading:l.value,class:"bookmark-button"},null,8,["word-id","reading"]),k(d,{to:u(J)(c.result.id),class:"word"},{default:x(()=>[typeof n.value=="string"?(a(),i(_,{key:0},[W(h(n.value),1)],64)):(a(),I(ne,{key:1,furigana:n.value},null,8,["furigana"]))]),_:1},8,["to"]),m("div",De,[typeof t.value=="string"?(a(),i(_,{key:0},[W(h(t.value),1)],64)):(a(),I(re,{key:1,meaning:t.value},null,8,["meaning"]))])])}}}),ze=w(Ee,[["__scopeId","data-v-0d4c49c2"]]),Ne={class:"word-search-results"},qe={class:"results-list"},Ae=b({__name:"WordSearchResults",props:{phrase:{}},setup(c){const r=c,s=Ie(()=>r.phrase);return(l,n)=>(a(),i("section",Ne,[n[0]||(n[0]=m("h3",null,"Words",-1)),m("ul",qe,[(a(!0),i(_,null,g(u(s),t=>(a(),i("li",{key:t.id},[k(ze,{result:t},null,8,["result"])]))),128))])]))}}),Ue=w(Ae,[["__scopeId","data-v-c5bb8635"]]),Fe={class:"search-field"},Oe={class:"label"},Qe=b({__name:"DictionaryView",setup(c){const r=G(),s=X(),l=N(),n=y(!1),t=j({get(){return typeof r.query.search!="string"?"":r.query.search},set(e){s.replace({query:{search:e||void 0}})}});return(e,o)=>(a(),i(_,null,[m("div",Fe,[m("label",Oe,[k(z,{icon:"search",class:"icon"})]),E(m("input",{"onUpdate:modelValue":o[0]||(o[0]=d=>t.value=d),type:"search","aria-label":"search",placeholder:"Search for words, kanji, meanings, etc."},null,512),[[H,t.value]]),k(M,{filled:n.value,"aria-pressed":n.value,"aria-controls":u(l),"aria-label":"Component Picker",onClick:o[1]||(o[1]=d=>n.value=!n.value)},{default:x(()=>[...o[4]||(o[4]=[W(" éƒ¨ ",-1)])]),_:1},8,["filled","aria-pressed","aria-controls"])]),n.value?(a(),I(Re,{key:0,id:u(l),onClose:o[2]||(o[2]=d=>n.value=!1),onSelect:o[3]||(o[3]=d=>t.value+=d)},null,8,["id"])):P("",!0),t.value?(a(),i(_,{key:1},[k(Pe,{class:"kanji-results",phrase:t.value},null,8,["phrase"]),k(Ue,{class:"word-results",phrase:t.value},null,8,["phrase"])],64)):(a(),I(ce,{key:2,class:"bookmark-results"}))],64))}}),ts=w(Qe,[["__scopeId","data-v-7a01b74c"]]);export{ts as default};
//# sourceMappingURL=DictionaryView-B16bvuI-.js.map
