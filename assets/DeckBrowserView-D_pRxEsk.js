import{d as f,o as s,h as I,w as b,a as c,G as x,A as $,_ as y,m as w,K as R,c as A,x as L,q as N,e as l,u as i,t as D,b as r,F as h,l as j,f as _,s as V,g as F,L as P}from"./index-chiovaS4.js";import{j as q,n as K,g as G,b as S}from"./decks-GrwULuka.js";import{u as E,d as H}from"./db-1SYsvhON.js";import{b as J,c as Q,d as z,e as M,f as O}from"./decks-B4X562U4.js";import"./reviews-D4EEJ0cN.js";import"./fsrs-CLWAx46U.js";const U={key:0,class:"loading-icon"},W=f({__name:"DeckAddButton",props:{added:{type:Boolean,default:!1},adding:{type:Boolean,default:!1}},emits:["add","remove"],setup(m,{emit:t}){const e=m,u=t;function p(){e.added?u("remove"):u("add")}return(o,g)=>(s(),I($,{"aria-label":o.added?"Remove Deck":"Add Deck",class:"add-button",filled:o.added,disabled:o.adding,onClick:p},{default:b(()=>[o.adding?(s(),c("span",U,"æ™‚")):(s(),I(x,{key:1,icon:"plus"}))]),_:1},8,["aria-label","filled","disabled"]))}}),T=y(W,[["__scopeId","data-v-ffaf72fb"]]),X=["aria-labelledby"],Y={class:"controls"},Z=["id"],ee={class:"kanji-list"},ae=f({__name:"DeckBrowserItem",props:{deck:{},contentPath:{},addingCategory:{type:Boolean}},setup(m){const t=m,e=w(!1),u=R(),p=w(null);async function o(){if(!p.value)return;const d=p.value.map(a=>a.codePointAt(0)??NaN);e.value=!0;try{await Q({...t.deck,cards:d})}catch(a){console.error(a)}finally{e.value=!1}}async function g(){e.value=!0;try{await z(t.deck.name)}catch(d){console.error(d)}finally{e.value=!1}}const B=J(()=>t.deck.name),C=A(()=>B.value!=null);return L(()=>t.contentPath,async d=>{const k=await(await fetch(d)).text();p.value=k.split(`
`).filter(n=>n)},{immediate:!0}),(d,a)=>{const k=N("RouterLink");return s(),c("article",{"aria-labelledby":i(u)},[l("div",Y,[l("strong",{id:i(u)},D(d.deck.label),9,Z),r(T,{adding:e.value||d.addingCategory,added:C.value,onAdd:o,onRemove:g},null,8,["adding","added"])]),l("ol",ee,[(s(!0),c(h,null,j(p.value,n=>(s(),c("li",{key:n,class:"kanji"},[r(k,{to:i(V)(n)},{default:b(()=>[_(D(n),1)]),_:2},1032,["to"])]))),128))])],8,X)}}}),te=y(ae,[["__scopeId","data-v-444c5444"]]),se=["aria-labelledby"],oe={class:"controls"},ne=["id"],ce={key:0,class:"deck-list"},le=f({__name:"DeckBrowserCategory",props:{title:{},category:{},deckTemplates:{}},setup(m){const t=m,e=w(!1),u=R(),{result:p}=E(A(()=>{const{category:a}=t;return async()=>(await H).transaction("decks").store.index("category").count(a)})),o=w(!1),g=A(()=>(p.value??0)>=t.deckTemplates.length);async function B(){o.value=!0;try{await M(t.category,t.deckTemplates)}catch(a){console.error(a)}finally{o.value=!1}}async function C(){o.value=!0;try{await O(t.category)}catch(a){console.error(a)}finally{o.value=!1}}function d({name:a,label:k,priority:n}){return{name:a,label:k,priority:n,category:t.category}}return(a,k)=>(s(),c("article",{"aria-labelledby":i(u)},[l("div",oe,[l("strong",{id:i(u),class:"title"},D(a.title),9,ne),r(T,{adding:o.value,added:g.value,onAdd:B,onRemove:C},null,8,["adding","added"])]),r($,{class:"expand-button","aria-pressed":e.value,onClick:k[0]||(k[0]=n=>e.value=!e.value)},{default:b(()=>[e.value?(s(),c(h,{key:0},[_("Hide ")],64)):(s(),c(h,{key:1},[_("Show ")],64)),_(" ("+D(a.deckTemplates.length)+" decks) ",1)]),_:1},8,["aria-pressed"]),e.value?(s(),c("ol",ce,[(s(!0),c(h,null,j(a.deckTemplates,n=>(s(),c("li",{key:n.name},[r(te,{deck:d(n),"content-path":n.content,"adding-category":o.value},null,8,["deck","content-path","adding-category"])]))),128))])):F("",!0)],8,se))}}),v=y(le,[["__scopeId","data-v-caf77e95"]]),re={class:"categories"},de=f({__name:"DeckBrowser",setup(m){return(t,e)=>(s(),c("ul",re,[l("li",null,[r(v,{title:"JLPT",category:"jlpt","deck-templates":i(q)},null,8,["deck-templates"])]),l("li",null,[r(v,{title:"News Frequency",category:"news","deck-templates":i(K)},null,8,["deck-templates"])]),l("li",null,[r(v,{title:"Genki",category:"genki","deck-templates":i(G)},null,8,["deck-templates"])]),l("li",null,[r(v,{title:"Basic Kanji Book",category:"basic-kanji","deck-templates":i(S)},null,8,["deck-templates"])])]))}}),ie=y(de,[["__scopeId","data-v-898009ac"]]),ue={class:"article-header"},pe={class:"actions"},ke=f({__name:"DeckBrowserView",setup(m){return(t,e)=>(s(),c("article",null,[l("header",ue,[e[1]||(e[1]=l("h2",{class:"title"},"Add Decks",-1)),l("div",pe,[r($,{to:i(P),"prefix-icon":"arrow-left"},{default:b(()=>e[0]||(e[0]=[_(" Back to your decks ")])),_:1},8,["to"])])]),r(ie)]))}}),he=y(ke,[["__scopeId","data-v-a1e5f41b"]]);export{he as default};
