import{d as $,n as Z,q as h,a as i,e as m,V as K,g as L,F as g,l as _,b as k,u as p,h as b,o as r,_ as j,Q as F,I as O,a1 as V,P as T,w as x,A as M,J as N,K as q,t as y,a2 as G,Y as U,X as B,c as w,z as Y,C as J,i as I,k as X,s as H,a3 as ee}from"./index-6ufKAMkN.js";import{v as Q}from"./index-BzyXrToT.js";import{d as se}from"./db-CAXDHHnL.js";import{W as te}from"./WordListItem-C29Mm46w.js";import{l as E,d as ae,o as R}from"./reviews-vv4OOlcX.js";import{W as z}from"./WordKanjiListItem-CFjGGe9p.js";import{u as ne,B as re,_ as oe,V as le}from"./WordWritingSelect-9Bqfxk3-.js";import"./kanji-BxdS7aig.js";import"./fsrs-D5mfOv5x.js";const ie={class:"word-search-results"},ce={class:"results-list"},A=10,ue=$({__name:"BookmarkedWords",setup(u){const o=Z(async()=>{const s=[],e=(await se).transaction("bookmarked-words").store.index("bookmarkedAt").iterate(null,"prev");for await(const n of e)s.push(n.primaryKey);return s},[]),t=h(A);function l(){t.value+=A}function a([{isIntersecting:s}]){s&&l()}return(s,e)=>(r(),i("section",ie,[e[2]||(e[2]=m("h3",null,"Bookmarked Words",-1)),m("ul",ce,[(r(!0),i(g,null,_(p(o).slice(0,t.value),n=>(r(),i("li",{key:n},[k(te,{word:n},null,8,["word"])]))),128))]),t.value<p(o).length?K((r(),i("button",{key:0,class:"next-page-button",onClick:e[0]||(e[0]=n=>l())},[...e[1]||(e[1]=[b(" Load More ",-1)])])),[[p(Q),a]]):L("",!0)]))}}),de=j(ue,[["__scopeId","data-v-c7243204"]]);function pe(u){return new Worker("/assets/component-picker.worker-BeQQggMa.js",{name:u?.name})}const S=new pe;function me(){const u=h(new Map),o=h(new Set),t=h(new Map),l=F(new Set);function a(s){s.data.type==="all-radicals"?u.value=s.data.allRadicals:s.data.type==="kanji-selection"&&(t.value=s.data.kanjiSelection,o.value=s.data.filteredRadicals)}return S.addEventListener("message",a),S.postMessage("init"),V(()=>{S.removeEventListener("message",a)}),O(l,()=>{if(l.size===0){o.value=new Set,t.value=new Map;return}S.postMessage(T(l))}),{allRadicals:u,filteredRadicals:o,selectedRadicals:l,kanjiSelection:t}}const fe={class:"component-picker"},ke={class:"control-buttons"},ge={key:0,class:"empty-message"},ve={key:1,class:"list kanji-list"},_e=["aria-labelledby"],he=["id"],ye={class:"list kanji-literal-list"},we=["onClick"],be={class:"list radical-list"},$e=["aria-labelledby"],je=["id"],We={class:"list radical-literal-list"},Re=["aria-pressed","disabled","onClick"],Se=$({__name:"ComponentPicker",emits:["select","close"],setup(u){const{allRadicals:o,filteredRadicals:t,kanjiSelection:l,selectedRadicals:a}=me(),s=q();function e(n){a.has(n)?a.delete(n):a.add(n)}return(n,c)=>(r(),i("div",fe,[m("div",ke,[k(M,{class:"clear-button",inline:"",disabled:p(a).size===0,onClick:c[0]||(c[0]=d=>p(a).clear())},{default:x(()=>[...c[2]||(c[2]=[b(" Clear ",-1)])]),_:1},8,["disabled"]),k(M,{class:"close-button",inline:"",onClick:c[1]||(c[1]=d=>n.$emit("close"))},{default:x(()=>[k(N,{icon:"x-mark"})]),_:1})]),p(a).size===0?(r(),i("p",ge," Select one or more components below. Pick any of the resulting kanji. ")):(r(),i("ol",ve,[(r(!0),i(g,null,_(p(l),([d,v])=>(r(),i("li",{key:d,"aria-labelledby":`${p(s)}/kanji-list/${d}`,class:"kanji-list-item"},[m("strong",{id:`${p(s)}/kanji-list/${d}`,class:"stroke-count-label"},y(d),9,he),m("ol",ye,[(r(!0),i(g,null,_(v,f=>(r(),i("li",{key:f,class:"kanji-literal-list-item"},[m("button",{class:"kanji-select-button",onClick:W=>n.$emit("select",f)},y(f),9,we)]))),128))])],8,_e))),128))])),m("ol",be,[(r(!0),i(g,null,_(p(o),([d,v])=>(r(),i("li",{key:d,"aria-labelledby":`${p(s)}/radical-list/${d}`,class:"radical-list-item"},[m("strong",{id:`${p(s)}/radical-list/${d}`,class:"stroke-count-label"},y(d),9,je),m("ol",We,[(r(!0),i(g,null,_(v,f=>(r(),i("li",{key:f,class:"radical-literal-list-item"},[m("button",{class:"radical-toggle-button","aria-pressed":p(a).has(f),disabled:p(t).size>0&&!p(t).has(f),onClick:W=>e(f)},y(f),9,Re)]))),128))])],8,$e))),128))])]))}}),xe=j(Se,[["__scopeId","data-v-6487d67b"]]);function Ie(u){return new Worker("/assets/search-kanji.worker-DUfWeBh-.js",{name:u?.name})}function Le(u){return new Worker("/assets/search-words.worker-SL6zYZG7.js",{name:u?.name})}const P=new Ie,C=new Le;function Pe(u){const o=U([]);G(()=>B(u),async l=>{o.splice(0,o.length),l.length>0&&C.postMessage(l)},{debounce:300,immediate:!0});function t(l){const a=l.data,s=B(u);if(a.phrase===s)if(a.matchShort.length<s.length+4){let e=0;for(const n of o){if(n.matchShort.length>a.matchShort.length)break;e+=1}o.splice(e,0,a)}else o.push(a)}return C.addEventListener("message",t),V(()=>{C.removeEventListener("message",t)}),o}function Ce(u){const o=h([]);G(()=>B(u),async l=>{l.length===0||E(l)?o.value=[]:P.postMessage(l)},{debounce:300,immediate:!0});function t(l){o.value=l.data}return P.addEventListener("message",t),V(()=>{P.removeEventListener("message",t)}),o}const Me={key:0,class:"kanji-search-results"},Be={key:0,class:"results-list"},Ee={key:1,class:"results-list"},Ke=$({__name:"KanjiSearchResults",props:{phrase:{}},setup(u){const o=u,t=w(()=>{const a=new Set;for(const s of o.phrase)ae(s)&&a.add(s);return a}),l=Ce(()=>o.phrase);return(a,s)=>t.value.size>0||p(l).length>0?(r(),i("section",Me,[s[0]||(s[0]=m("h3",null,"Kanji",-1)),t.value.size>0?(r(),i("ul",Be,[(r(!0),i(g,null,_(t.value,e=>(r(),i("li",{key:e},[k(z,{kanji:e},null,8,["kanji"])]))),128))])):(r(),i("ul",Ee,[(r(!0),i(g,null,_(p(l),e=>(r(),i("li",{key:e.id},[k(z,{kanji:String.fromCodePoint(e.id)},null,8,["kanji"])]))),128))]))])):L("",!0)}}),Ve=j(Ke,[["__scopeId","data-v-9f3709e3"]]),ze={class:"word-search-result-item"},Ae={class:"meaning"},De=$({__name:"WordSearchResultItem",props:{result:{}},setup(u){const o=u,t=ne(()=>o.result.id),l=w(()=>t.value?t.value.readings?.at(0)?.text:o.result.readings.at(0)),a=w(()=>{const{match:e,readings:n,writings:c}=o.result;if(t.value){let f;return E(e)?f=t.value.furigana?.find(W=>W.writing===e):R(e)&&(f=t.value.furigana?.find(W=>W.reading===e)),f||(f=t.value.furigana?.at(0)),f?f.furigana:t.value.writings?.at(0)?.text??t.value.readings?.at(0)?.text??e}if(E(e))return[{ruby:e,rt:n.at(0)}];const[d]=c;if(R(e))return d?[{ruby:d,rt:e}]:e;const[v]=n;return d&&v?[{ruby:v,rt:v}]:d??v??e}),s=w(()=>{const{match:e,glossary:n}=o.result;if(t.value){if(R(e))return t.value.meanings?.at(0)??n.at(0)??e;const c=t.value.meanings?.find(d=>d.glossary?.includes(e));if(c)return c}return R(e)?n.at(0)??e:e});return(e,n)=>{const c=Y("RouterLink");return r(),i("div",ze,[k(re,{"word-id":u.result.id,reading:l.value,class:"bookmark-button"},null,8,["word-id","reading"]),k(c,{to:p(J)(u.result.id),class:"word"},{default:x(()=>[typeof a.value=="string"?(r(),i(g,{key:0},[b(y(a.value),1)],64)):(r(),I(oe,{key:1,furigana:a.value},null,8,["furigana"]))]),_:1},8,["to"]),m("div",Ae,[typeof s.value=="string"?(r(),i(g,{key:0},[b(y(s.value),1)],64)):(r(),I(le,{key:1,meaning:s.value},null,8,["meaning"]))])])}}}),Ne=j(De,[["__scopeId","data-v-0d4c49c2"]]),qe={class:"word-search-results"},Ge={class:"results-list"},D=15,Qe=$({__name:"WordSearchResults",props:{phrase:{}},setup(u){const o=u,t=Pe(()=>o.phrase),l=h(D),a=w(()=>t.slice(0,l.value));function s(){l.value+=D}function e([{isIntersecting:n}]){n&&s()}return(n,c)=>(r(),i("section",qe,[c[2]||(c[2]=m("h3",null,"Words",-1)),m("ul",Ge,[(r(!0),i(g,null,_(a.value,d=>(r(),i("li",{key:d.id},[k(Ne,{result:d},null,8,["result"])]))),128))]),l.value<p(t).length?K((r(),i("button",{key:0,class:"next-page-button",onClick:c[0]||(c[0]=d=>s())},[...c[1]||(c[1]=[b(" Load More ",-1)])])),[[p(Q),e]]):L("",!0)]))}}),Ze=j(Qe,[["__scopeId","data-v-f4d59d05"]]),Fe={class:"search-field"},Oe={class:"label"},Te=$({__name:"DictionaryView",setup(u){const o=H(),t=X(),l=q(),a=h(!1),s=w({get(){return typeof o.query.search!="string"?"":o.query.search},set(e){t.replace({query:{search:e||void 0}})}});return(e,n)=>(r(),i(g,null,[m("div",Fe,[m("label",Oe,[k(N,{icon:"search",class:"icon"})]),K(m("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>s.value=c),type:"search","aria-label":"search",placeholder:"Search for words, kanji, meanings, etc."},null,512),[[ee,s.value]]),k(M,{filled:a.value,"aria-pressed":a.value,"aria-controls":p(l),"aria-label":"Component Picker",onClick:n[1]||(n[1]=c=>a.value=!a.value)},{default:x(()=>[...n[4]||(n[4]=[b(" éƒ¨ ",-1)])]),_:1},8,["filled","aria-pressed","aria-controls"])]),a.value?(r(),I(xe,{key:0,id:p(l),onClose:n[2]||(n[2]=c=>a.value=!1),onSelect:n[3]||(n[3]=c=>s.value+=c)},null,8,["id"])):L("",!0),s.value?(r(),i(g,{key:1},[k(Ve,{class:"kanji-results",phrase:s.value},null,8,["phrase"]),k(Ze,{class:"word-results",phrase:s.value},null,8,["phrase"])],64)):(r(),I(de,{key:2,class:"bookmark-results"}))],64))}}),ns=j(Te,[["__scopeId","data-v-7a01b74c"]]);export{ns as default};
//# sourceMappingURL=DictionaryView-DJiENWWh.js.map
