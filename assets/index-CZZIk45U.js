import{u as Gn,d as N,l as Kn,a as Ra}from"./db-D-l1LJxU.js";import{ak as L}from"./index-C4O8d0Wk.js";function Ta(r){return async e=>{const t=new Map;for await(const n of e){const a=r(n);let i=t.get(a);i||(i=[],t.set(a,i)),i.push(n)}return t}}function Hn(r,...e){return e.reduce((t,n)=>n(t),r)}function xa(r){return async function*(e){for await(const t of e)yield r(t)}}function qa(r){return function*(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done&&r(n.value);)n=t.next();try{for(;!n.done;)yield n.value,n=t.next()}finally{typeof t.return=="function"&&t.return()}}}class te extends Error{constructor(e,t){super(e),this.name="DevalueError",this.path=t.join("")}}function Xr(r){return Object(r)!==r}const Ma=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ja(r){const e=Object.getPrototypeOf(r);return e===Object.prototype||e===null||Object.getOwnPropertyNames(e).sort().join("\0")===Ma}function Pa(r){return Object.prototype.toString.call(r).slice(8,-1)}function Da(r){switch(r){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return r<" "?`\\u${r.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function K(r){let e="",t=0;const n=r.length;for(let a=0;a<n;a+=1){const i=r[a],s=Da(i);s&&(e+=r.slice(t,a)+s,t=a+1)}return`"${t===0?r:e+r.slice(t)}"`}function Ca(r){return Object.getOwnPropertySymbols(r).filter(e=>Object.getOwnPropertyDescriptor(r,e).enumerable)}const Ba=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function Zr(r){return Ba.test(r)?"."+r:"["+JSON.stringify(r)+"]"}function Qr(r){const e=new DataView(r);let t="";for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(e.getUint8(n));return Na(t)}function et(r){const e=Fa(r),t=new ArrayBuffer(e.length),n=new DataView(t);for(let a=0;a<t.byteLength;a++)n.setUint8(a,e.charCodeAt(a));return t}const Vn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function Fa(r){r.length%4===0&&(r=r.replace(/==?$/,""));let e="",t=0,n=0;for(let a=0;a<r.length;a++)t<<=6,t|=Vn.indexOf(r[a]),n+=6,n===24&&(e+=String.fromCharCode((t&16711680)>>16),e+=String.fromCharCode((t&65280)>>8),e+=String.fromCharCode(t&255),t=n=0);return n===12?(t>>=4,e+=String.fromCharCode(t)):n===18&&(t>>=2,e+=String.fromCharCode((t&65280)>>8),e+=String.fromCharCode(t&255)),e}function Na(r){let e="";for(let t=0;t<r.length;t+=3){const n=[void 0,void 0,void 0,void 0];n[0]=r.charCodeAt(t)>>2,n[1]=(r.charCodeAt(t)&3)<<4,r.length>t+1&&(n[1]|=r.charCodeAt(t+1)>>4,n[2]=(r.charCodeAt(t+1)&15)<<2),r.length>t+2&&(n[2]|=r.charCodeAt(t+2)>>6,n[3]=r.charCodeAt(t+2)&63);for(let a=0;a<n.length;a++)typeof n[a]>"u"?e+="=":e+=Vn[n[a]]}return e}const Br=-1,zn=-2,Yn=-3,Wn=-4,Jn=-5,Fr=-6;function ne(r,e){return $a(JSON.parse(r))}function $a(r,e){if(typeof r=="number")return a(r,!0);if(!Array.isArray(r)||r.length===0)throw new Error("Invalid input");const t=r,n=Array(t.length);function a(i,s=!1){if(i===Br)return;if(i===Yn)return NaN;if(i===Wn)return 1/0;if(i===Jn)return-1/0;if(i===Fr)return-0;if(s)throw new Error("Invalid input");if(i in n)return n[i];const o=t[i];if(!o||typeof o!="object")n[i]=o;else if(Array.isArray(o))if(typeof o[0]=="string"){const c=o[0];switch(c){case"Date":n[i]=new Date(o[1]);break;case"Set":const u=new Set;n[i]=u;for(let d=1;d<o.length;d+=1)u.add(a(o[d]));break;case"Map":const l=new Map;n[i]=l;for(let d=1;d<o.length;d+=2)l.set(a(o[d]),a(o[d+1]));break;case"RegExp":n[i]=new RegExp(o[1],o[2]);break;case"Object":n[i]=Object(o[1]);break;case"BigInt":n[i]=BigInt(o[1]);break;case"null":const f=Object.create(null);n[i]=f;for(let d=1;d<o.length;d+=2)f[o[d]]=a(o[d+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const d=globalThis[c],y=o[1],p=et(y),_=new d(p);n[i]=_;break}case"ArrayBuffer":{const d=o[1],y=et(d);n[i]=y;break}default:throw new Error(`Unknown type ${c}`)}}else{const c=new Array(o.length);n[i]=c;for(let u=0;u<o.length;u+=1){const l=o[u];l!==zn&&(c[u]=a(l))}}else{const c={};n[i]=c;for(const u in o){const l=o[u];c[u]=a(l)}}return n[i]}return a(0)}function W(r,e){const t=[],n=new Map,a=[],i=[];let s=0;function o(u){if(typeof u=="function")throw new te("Cannot stringify a function",i);if(n.has(u))return n.get(u);if(u===void 0)return Br;if(Number.isNaN(u))return Yn;if(u===1/0)return Wn;if(u===-1/0)return Jn;if(u===0&&1/u<0)return Fr;const l=s++;n.set(u,l);for(const{key:d,fn:y}of a){const p=y(u);if(p)return t[l]=`["${d}",${o(p)}]`,l}let f="";if(Xr(u))f=ae(u);else{const d=Pa(u);switch(d){case"Number":case"String":case"Boolean":f=`["Object",${ae(u)}]`;break;case"BigInt":f=`["BigInt",${u}]`;break;case"Date":f=`["Date","${!isNaN(u.getDate())?u.toISOString():""}"]`;break;case"RegExp":const{source:p,flags:_}=u;f=_?`["RegExp",${K(p)},"${_}"]`:`["RegExp",${K(p)}]`;break;case"Array":f="[";for(let v=0;v<u.length;v+=1)v>0&&(f+=","),v in u?(i.push(`[${v}]`),f+=o(u[v]),i.pop()):f+=zn;f+="]";break;case"Set":f='["Set"';for(const v of u)f+=`,${o(v)}`;f+="]";break;case"Map":f='["Map"';for(const[v,w]of u)i.push(`.get(${Xr(v)?ae(v):"..."})`),f+=`,${o(v)},${o(w)}`,i.pop();f+="]";break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const w=Qr(u.buffer);f='["'+d+'","'+w+'"]';break}case"ArrayBuffer":{f=`["ArrayBuffer","${Qr(u)}"]`;break}default:if(!ja(u))throw new te("Cannot stringify arbitrary non-POJOs",i);if(Ca(u).length>0)throw new te("Cannot stringify POJOs with symbolic keys",i);if(Object.getPrototypeOf(u)===null){f='["null"';for(const v in u)i.push(Zr(v)),f+=`,${K(v)},${o(u[v])}`,i.pop();f+="]"}else{f="{";let v=!1;for(const w in u)v&&(f+=","),v=!0,i.push(Zr(w)),f+=`${K(w)}:${o(u[w])}`,i.pop();f+="}"}}}return t[l]=f,l}const c=o(r);return c<0?`${c}`:`[${t.join(",")}]`}function ae(r){const e=typeof r;return e==="string"?K(r):r instanceof String?K(r.toString()):r===void 0?Br.toString():r===0&&1/r<0?Fr.toString():e==="bigint"?`["BigInt","${r}"]`:String(r)}const k="shodoku.app.config.sync.remote",Ua=L(`${k}.fetch.method`,"GET"),La=L(`${k}.fetch.url`,""),ka=L(`${k}.fetch.headers`,[]),Ga=L(`${k}.push.method`,"PUT"),Ka=L(`${k}.push.url`,""),Ha=L(`${k}.push.headers`,[]),Xn=L(`${k}.push.body`,void 0);function Ds(){return Gn(async()=>await(await N).count("syncs")>0)}function Cs(){return Gn(async()=>await(await N).count("sync.staging.stores")>0)}function Zn(r){return typeof r!="object"?typeof r:r===null?"null":r.constructor.name}function Nr(r,e){return`Expected "${r}" but got "${Zn(e)}"`}function $r(r,e,t){return`Expected key "${r}" to be "${e}" but is "${Zn(t)}"`}class C extends Error{name="AssertationError";code="ERR_ASSERTION";actual;constructor(e={}){if(e.message)super(e.message);else{let t;"actual"in e&&(t=`Assertion failed with "${e.actual}"`),super(t||"Assertion failed")}this.actual=e.actual}}function Qn(r){if(typeof r!="string")throw new C({message:Nr("String",r),actual:r})}function J(r){if(!Array.isArray(r))throw new C({message:Nr("Array",r),actual:r})}function ea(r){if(typeof r!="object"||r==null)throw new C({message:Nr("Object",r),actual:r})}function Ur(r,e){if(!(r in e))throw new C({message:`Expected object to have key "${String(r)}" but none found`,actual:e})}function F(r,e,{optional:t=!1,nullable:n=!1}={}){if(!(t&&!(r in e))&&(Ur(r,e),typeof e[r]!="string")){if(n&&e[r]===null||t&&typeof e[r]>"u")return;throw new C({message:$r(String(r),"String",e[r]),actual:e})}}function rt(r,e,{optional:t=!1,nullable:n=!1}={}){if(!(t&&!(r in e))&&(Ur(r,e),typeof e[r]!="number")){if(n&&e[r]===null||t&&typeof e[r]>"u")return;throw new C({message:$r(String(r),"Number",e[r]),actual:e})}}function Q(r,e,{optional:t=!1,nullable:n=!1}={}){if(!(t&&!(r in e))&&(Ur(r,e),!Array.isArray(e[r]))){if(n&&e[r]===null||t&&typeof e[r]>"u")return;throw new C({message:$r(String(r),"Array",e[r]),actual:e})}}function ie(r,e,{optional:t=!1,nullable:n=!1}={}){Q(r,e,{optional:t,nullable:n});const a=e[r];if(a)for(const i of a)Qn(i)}var tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nt={},at={},z,it;function E(){if(it)return z;it=1;var r=function(e){return e&&e.Math===Math&&e};return z=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof tt=="object"&&tt)||r(typeof z=="object"&&z)||function(){return this}()||Function("return this")(),z}var se={},oe,st;function $(){return st||(st=1,oe=function(r){try{return!!r()}catch{return!0}}),oe}var ue,ot;function G(){if(ot)return ue;ot=1;var r=$();return ue=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ue}var ce,ut;function ra(){if(ut)return ce;ut=1;var r=$();return ce=!r(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),ce}var le,ct;function Lr(){if(ct)return le;ct=1;var r=ra(),e=Function.prototype.call;return le=r?e.bind(e):function(){return e.apply(e,arguments)},le}var fe={},lt;function Va(){if(lt)return fe;lt=1;var r={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,t=e&&!r.call({1:2},1);return fe.f=t?function(a){var i=e(this,a);return!!i&&i.enumerable}:r,fe}var de,ft;function ta(){return ft||(ft=1,de=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}}),de}var he,dt;function q(){if(dt)return he;dt=1;var r=ra(),e=Function.prototype,t=e.call,n=r&&e.bind.bind(t,t);return he=r?n:function(a){return function(){return t.apply(a,arguments)}},he}var ye,ht;function kr(){if(ht)return ye;ht=1;var r=q(),e=r({}.toString),t=r("".slice);return ye=function(n){return t(e(n),8,-1)},ye}var ve,yt;function za(){if(yt)return ve;yt=1;var r=q(),e=$(),t=kr(),n=Object,a=r("".split);return ve=e(function(){return!n("z").propertyIsEnumerable(0)})?function(i){return t(i)==="String"?a(i,""):n(i)}:n,ve}var pe,vt;function na(){return vt||(vt=1,pe=function(r){return r==null}),pe}var ge,pt;function aa(){if(pt)return ge;pt=1;var r=na(),e=TypeError;return ge=function(t){if(r(t))throw new e("Can't call method on "+t);return t},ge}var me,gt;function Gr(){if(gt)return me;gt=1;var r=za(),e=aa();return me=function(t){return r(e(t))},me}var be,mt;function D(){if(mt)return be;mt=1;var r=typeof document=="object"&&document.all;return be=typeof r>"u"&&r!==void 0?function(e){return typeof e=="function"||e===r}:function(e){return typeof e=="function"},be}var we,bt;function V(){if(bt)return we;bt=1;var r=D();return we=function(e){return typeof e=="object"?e!==null:r(e)},we}var _e,wt;function ia(){if(wt)return _e;wt=1;var r=E(),e=D(),t=function(n){return e(n)?n:void 0};return _e=function(n,a){return arguments.length<2?t(r[n]):r[n]&&r[n][a]},_e}var Se,_t;function Ya(){if(_t)return Se;_t=1;var r=q();return Se=r({}.isPrototypeOf),Se}var Ae,St;function Wa(){if(St)return Ae;St=1;var r=E(),e=r.navigator,t=e&&e.userAgent;return Ae=t?String(t):"",Ae}var Oe,At;function Ja(){if(At)return Oe;At=1;var r=E(),e=Wa(),t=r.process,n=r.Deno,a=t&&t.versions||n&&n.version,i=a&&a.v8,s,o;return i&&(s=i.split("."),o=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!o&&e&&(s=e.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=e.match(/Chrome\/(\d+)/),s&&(o=+s[1]))),Oe=o,Oe}var Ee,Ot;function sa(){if(Ot)return Ee;Ot=1;var r=Ja(),e=$(),t=E(),n=t.String;return Ee=!!Object.getOwnPropertySymbols&&!e(function(){var a=Symbol("symbol detection");return!n(a)||!(Object(a)instanceof Symbol)||!Symbol.sham&&r&&r<41}),Ee}var Ie,Et;function oa(){if(Et)return Ie;Et=1;var r=sa();return Ie=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ie}var Re,It;function ua(){if(It)return Re;It=1;var r=ia(),e=D(),t=Ya(),n=oa(),a=Object;return Re=n?function(i){return typeof i=="symbol"}:function(i){var s=r("Symbol");return e(s)&&t(s.prototype,a(i))},Re}var Te,Rt;function Xa(){if(Rt)return Te;Rt=1;var r=String;return Te=function(e){try{return r(e)}catch{return"Object"}},Te}var xe,Tt;function ca(){if(Tt)return xe;Tt=1;var r=D(),e=Xa(),t=TypeError;return xe=function(n){if(r(n))return n;throw new t(e(n)+" is not a function")},xe}var qe,xt;function Za(){if(xt)return qe;xt=1;var r=ca(),e=na();return qe=function(t,n){var a=t[n];return e(a)?void 0:r(a)},qe}var Me,qt;function Qa(){if(qt)return Me;qt=1;var r=Lr(),e=D(),t=V(),n=TypeError;return Me=function(a,i){var s,o;if(i==="string"&&e(s=a.toString)&&!t(o=r(s,a))||e(s=a.valueOf)&&!t(o=r(s,a))||i!=="string"&&e(s=a.toString)&&!t(o=r(s,a)))return o;throw new n("Can't convert object to primitive value")},Me}var je={exports:{}},Pe,Mt;function ei(){return Mt||(Mt=1,Pe=!1),Pe}var De,jt;function Kr(){if(jt)return De;jt=1;var r=E(),e=Object.defineProperty;return De=function(t,n){try{e(r,t,{value:n,configurable:!0,writable:!0})}catch{r[t]=n}return n},De}var Pt;function Hr(){if(Pt)return je.exports;Pt=1;var r=ei(),e=E(),t=Kr(),n="__core-js_shared__",a=je.exports=e[n]||t(n,{});return(a.versions||(a.versions=[])).push({version:"3.44.0",mode:r?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.44.0/LICENSE",source:"https://github.com/zloirock/core-js"}),je.exports}var Ce,Dt;function la(){if(Dt)return Ce;Dt=1;var r=Hr();return Ce=function(e,t){return r[e]||(r[e]=t||{})},Ce}var Be,Ct;function ri(){if(Ct)return Be;Ct=1;var r=aa(),e=Object;return Be=function(t){return e(r(t))},Be}var Fe,Bt;function U(){if(Bt)return Fe;Bt=1;var r=q(),e=ri(),t=r({}.hasOwnProperty);return Fe=Object.hasOwn||function(a,i){return t(e(a),i)},Fe}var Ne,Ft;function fa(){if(Ft)return Ne;Ft=1;var r=q(),e=0,t=Math.random(),n=r(1.1.toString);return Ne=function(a){return"Symbol("+(a===void 0?"":a)+")_"+n(++e+t,36)},Ne}var $e,Nt;function Vr(){if(Nt)return $e;Nt=1;var r=E(),e=la(),t=U(),n=fa(),a=sa(),i=oa(),s=r.Symbol,o=e("wks"),c=i?s.for||s:s&&s.withoutSetter||n;return $e=function(u){return t(o,u)||(o[u]=a&&t(s,u)?s[u]:c("Symbol."+u)),o[u]},$e}var Ue,$t;function ti(){if($t)return Ue;$t=1;var r=Lr(),e=V(),t=ua(),n=Za(),a=Qa(),i=Vr(),s=TypeError,o=i("toPrimitive");return Ue=function(c,u){if(!e(c)||t(c))return c;var l=n(c,o),f;if(l){if(u===void 0&&(u="default"),f=r(l,c,u),!e(f)||t(f))return f;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),a(c,u)},Ue}var Le,Ut;function da(){if(Ut)return Le;Ut=1;var r=ti(),e=ua();return Le=function(t){var n=r(t,"string");return e(n)?n:n+""},Le}var ke,Lt;function ni(){if(Lt)return ke;Lt=1;var r=E(),e=V(),t=r.document,n=e(t)&&e(t.createElement);return ke=function(a){return n?t.createElement(a):{}},ke}var Ge,kt;function ha(){if(kt)return Ge;kt=1;var r=G(),e=$(),t=ni();return Ge=!r&&!e(function(){return Object.defineProperty(t("div"),"a",{get:function(){return 7}}).a!==7}),Ge}var Gt;function ya(){if(Gt)return se;Gt=1;var r=G(),e=Lr(),t=Va(),n=ta(),a=Gr(),i=da(),s=U(),o=ha(),c=Object.getOwnPropertyDescriptor;return se.f=r?c:function(l,f){if(l=a(l),f=i(f),o)try{return c(l,f)}catch{}if(s(l,f))return n(!e(t.f,l,f),l[f])},se}var Ke={},He,Kt;function ai(){if(Kt)return He;Kt=1;var r=G(),e=$();return He=r&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),He}var Ve,Ht;function va(){if(Ht)return Ve;Ht=1;var r=V(),e=String,t=TypeError;return Ve=function(n){if(r(n))return n;throw new t(e(n)+" is not an object")},Ve}var Vt;function zr(){if(Vt)return Ke;Vt=1;var r=G(),e=ha(),t=ai(),n=va(),a=da(),i=TypeError,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c="enumerable",u="configurable",l="writable";return Ke.f=r?t?function(d,y,p){if(n(d),y=a(y),n(p),typeof d=="function"&&y==="prototype"&&"value"in p&&l in p&&!p[l]){var _=o(d,y);_&&_[l]&&(d[y]=p.value,p={configurable:u in p?p[u]:_[u],enumerable:c in p?p[c]:_[c],writable:!1})}return s(d,y,p)}:s:function(d,y,p){if(n(d),y=a(y),n(p),e)try{return s(d,y,p)}catch{}if("get"in p||"set"in p)throw new i("Accessors not supported");return"value"in p&&(d[y]=p.value),d},Ke}var ze,zt;function pa(){if(zt)return ze;zt=1;var r=G(),e=zr(),t=ta();return ze=r?function(n,a,i){return e.f(n,a,t(1,i))}:function(n,a,i){return n[a]=i,n},ze}var Ye={exports:{}},We,Yt;function ii(){if(Yt)return We;Yt=1;var r=G(),e=U(),t=Function.prototype,n=r&&Object.getOwnPropertyDescriptor,a=e(t,"name"),i=a&&(function(){}).name==="something",s=a&&(!r||r&&n(t,"name").configurable);return We={EXISTS:a,PROPER:i,CONFIGURABLE:s},We}var Je,Wt;function si(){if(Wt)return Je;Wt=1;var r=q(),e=D(),t=Hr(),n=r(Function.toString);return e(t.inspectSource)||(t.inspectSource=function(a){return n(a)}),Je=t.inspectSource,Je}var Xe,Jt;function oi(){if(Jt)return Xe;Jt=1;var r=E(),e=D(),t=r.WeakMap;return Xe=e(t)&&/native code/.test(String(t)),Xe}var Ze,Xt;function ui(){if(Xt)return Ze;Xt=1;var r=la(),e=fa(),t=r("keys");return Ze=function(n){return t[n]||(t[n]=e(n))},Ze}var Qe,Zt;function ga(){return Zt||(Zt=1,Qe={}),Qe}var er,Qt;function ci(){if(Qt)return er;Qt=1;var r=oi(),e=E(),t=V(),n=pa(),a=U(),i=Hr(),s=ui(),o=ga(),c="Object already initialized",u=e.TypeError,l=e.WeakMap,f,d,y,p=function(g){return y(g)?d(g):f(g,{})},_=function(g){return function(m){var A;if(!t(m)||(A=d(m)).type!==g)throw new u("Incompatible receiver, "+g+" required");return A}};if(r||i.state){var v=i.state||(i.state=new l);v.get=v.get,v.has=v.has,v.set=v.set,f=function(g,m){if(v.has(g))throw new u(c);return m.facade=g,v.set(g,m),m},d=function(g){return v.get(g)||{}},y=function(g){return v.has(g)}}else{var w=s("state");o[w]=!0,f=function(g,m){if(a(g,w))throw new u(c);return m.facade=g,n(g,w,m),m},d=function(g){return a(g,w)?g[w]:{}},y=function(g){return a(g,w)}}return er={set:f,get:d,has:y,enforce:p,getterFor:_},er}var en;function li(){if(en)return Ye.exports;en=1;var r=q(),e=$(),t=D(),n=U(),a=G(),i=ii().CONFIGURABLE,s=si(),o=ci(),c=o.enforce,u=o.get,l=String,f=Object.defineProperty,d=r("".slice),y=r("".replace),p=r([].join),_=a&&!e(function(){return f(function(){},"length",{value:8}).length!==8}),v=String(String).split("String"),w=Ye.exports=function(g,m,A){d(l(m),0,7)==="Symbol("&&(m="["+y(l(m),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),A&&A.getter&&(m="get "+m),A&&A.setter&&(m="set "+m),(!n(g,"name")||i&&g.name!==m)&&(a?f(g,"name",{value:m,configurable:!0}):g.name=m),_&&A&&n(A,"arity")&&g.length!==A.arity&&f(g,"length",{value:A.arity});try{A&&n(A,"constructor")&&A.constructor?a&&f(g,"prototype",{writable:!1}):g.prototype&&(g.prototype=void 0)}catch{}var O=c(g);return n(O,"source")||(O.source=p(v,typeof m=="string"?m:"")),g};return Function.prototype.toString=w(function(){return t(this)&&u(this).source||s(this)},"toString"),Ye.exports}var rr,rn;function fi(){if(rn)return rr;rn=1;var r=D(),e=zr(),t=li(),n=Kr();return rr=function(a,i,s,o){o||(o={});var c=o.enumerable,u=o.name!==void 0?o.name:i;if(r(s)&&t(s,u,o),o.global)c?a[i]=s:n(i,s);else{try{o.unsafe?a[i]&&(c=!0):delete a[i]}catch{}c?a[i]=s:e.f(a,i,{value:s,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return a},rr}var tr={},nr,tn;function di(){if(tn)return nr;tn=1;var r=Math.ceil,e=Math.floor;return nr=Math.trunc||function(n){var a=+n;return(a>0?e:r)(a)},nr}var ar,nn;function ma(){if(nn)return ar;nn=1;var r=di();return ar=function(e){var t=+e;return t!==t||t===0?0:r(t)},ar}var ir,an;function hi(){if(an)return ir;an=1;var r=ma(),e=Math.max,t=Math.min;return ir=function(n,a){var i=r(n);return i<0?e(i+a,0):t(i,a)},ir}var sr,sn;function yi(){if(sn)return sr;sn=1;var r=ma(),e=Math.min;return sr=function(t){var n=r(t);return n>0?e(n,9007199254740991):0},sr}var or,on;function ba(){if(on)return or;on=1;var r=yi();return or=function(e){return r(e.length)},or}var ur,un;function vi(){if(un)return ur;un=1;var r=Gr(),e=hi(),t=ba(),n=function(a){return function(i,s,o){var c=r(i),u=t(c);if(u===0)return!a&&-1;var l=e(o,u),f;if(a&&s!==s){for(;u>l;)if(f=c[l++],f!==f)return!0}else for(;u>l;l++)if((a||l in c)&&c[l]===s)return a||l||0;return!a&&-1}};return ur={includes:n(!0),indexOf:n(!1)},ur}var cr,cn;function pi(){if(cn)return cr;cn=1;var r=q(),e=U(),t=Gr(),n=vi().indexOf,a=ga(),i=r([].push);return cr=function(s,o){var c=t(s),u=0,l=[],f;for(f in c)!e(a,f)&&e(c,f)&&i(l,f);for(;o.length>u;)e(c,f=o[u++])&&(~n(l,f)||i(l,f));return l},cr}var lr,ln;function gi(){return ln||(ln=1,lr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),lr}var fn;function mi(){if(fn)return tr;fn=1;var r=pi(),e=gi(),t=e.concat("length","prototype");return tr.f=Object.getOwnPropertyNames||function(a){return r(a,t)},tr}var fr={},dn;function bi(){return dn||(dn=1,fr.f=Object.getOwnPropertySymbols),fr}var dr,hn;function wi(){if(hn)return dr;hn=1;var r=ia(),e=q(),t=mi(),n=bi(),a=va(),i=e([].concat);return dr=r("Reflect","ownKeys")||function(o){var c=t.f(a(o)),u=n.f;return u?i(c,u(o)):c},dr}var hr,yn;function _i(){if(yn)return hr;yn=1;var r=U(),e=wi(),t=ya(),n=zr();return hr=function(a,i,s){for(var o=e(i),c=n.f,u=t.f,l=0;l<o.length;l++){var f=o[l];!r(a,f)&&!(s&&r(s,f))&&c(a,f,u(i,f))}},hr}var yr,vn;function Si(){if(vn)return yr;vn=1;var r=$(),e=D(),t=/#|\.prototype\./,n=function(c,u){var l=i[a(c)];return l===o?!0:l===s?!1:e(u)?r(u):!!u},a=n.normalize=function(c){return String(c).replace(t,".").toLowerCase()},i=n.data={},s=n.NATIVE="N",o=n.POLYFILL="P";return yr=n,yr}var vr,pn;function wa(){if(pn)return vr;pn=1;var r=E(),e=ya().f,t=pa(),n=fi(),a=Kr(),i=_i(),s=Si();return vr=function(o,c){var u=o.target,l=o.global,f=o.stat,d,y,p,_,v,w;if(l?y=r:f?y=r[u]||a(u,{}):y=r[u]&&r[u].prototype,y)for(p in c){if(v=c[p],o.dontCallGetSet?(w=e(y,p),_=w&&w.value):_=y[p],d=s(l?p:u+(f?".":"#")+p,o.forced),!d&&_!==void 0){if(typeof v==typeof _)continue;i(v,_)}(o.sham||_&&_.sham)&&t(v,"sham",!0),n(y,p,v,o)}},vr}var pr,gn;function Ai(){if(gn)return pr;gn=1;var r=ba();return pr=function(e,t,n){for(var a=0,i=arguments.length>2?n:r(t),s=new e(i);i>a;)s[a]=t[a++];return s},pr}var gr,mn;function _a(){if(mn)return gr;mn=1;var r=V(),e=String,t=TypeError;return gr=function(n){if(n===void 0||r(n))return n;throw new t(e(n)+" is not an object or undefined")},gr}var mr,bn;function Oi(){if(bn)return mr;bn=1;var r=TypeError;return mr=function(e){if(typeof e=="string")return e;throw new r("Argument is not a string")},mr}var br,wn;function Sa(){if(wn)return br;wn=1;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=r+"+/",t=r+"-_",n=function(a){for(var i={},s=0;s<64;s++)i[a.charAt(s)]=s;return i};return br={i2c:e,c2i:n(e),i2cUrl:t,c2iUrl:n(t)},br}var wr,_n;function Aa(){if(_n)return wr;_n=1;var r=TypeError;return wr=function(e){var t=e&&e.alphabet;if(t===void 0||t==="base64"||t==="base64url")return t||"base64";throw new r("Incorrect `alphabet` option")},wr}var _r,Sn;function Ei(){return Sn||(Sn=1,_r=typeof ArrayBuffer<"u"&&typeof DataView<"u"),_r}var Sr,An;function Ii(){if(An)return Sr;An=1;var r=q(),e=ca();return Sr=function(t,n,a){try{return r(e(Object.getOwnPropertyDescriptor(t,n)[a]))}catch{}},Sr}var Ar,On;function Ri(){if(On)return Ar;On=1;var r=E(),e=Ii(),t=kr(),n=r.ArrayBuffer,a=r.TypeError;return Ar=n&&e(n.prototype,"byteLength","get")||function(i){if(t(i)!=="ArrayBuffer")throw new a("ArrayBuffer expected");return i.byteLength},Ar}var Or,En;function Ti(){if(En)return Or;En=1;var r=E(),e=Ei(),t=Ri(),n=r.DataView;return Or=function(a){if(!e||t(a)!==0)return!1;try{return new n(a),!1}catch{return!0}},Or}var Er,In;function Oa(){if(In)return Er;In=1;var r=Ti(),e=TypeError;return Er=function(t){if(r(t))throw new e("ArrayBuffer is detached");return t},Er}var Ir,Rn;function xi(){if(Rn)return Ir;Rn=1;var r=E(),e=q(),t=_a(),n=Oi(),a=U(),i=Sa(),s=Aa(),o=Oa(),c=i.c2i,u=i.c2iUrl,l=r.SyntaxError,f=r.TypeError,d=e("".charAt),y=function(v,w){for(var g=v.length;w<g;w++){var m=d(v,w);if(m!==" "&&m!=="	"&&m!==`
`&&m!=="\f"&&m!=="\r")break}return w},p=function(v,w,g){var m=v.length;m<4&&(v+=m===2?"AA":"A");var A=(w[d(v,0)]<<18)+(w[d(v,1)]<<12)+(w[d(v,2)]<<6)+w[d(v,3)],O=[A>>16&255,A>>8&255,A&255];if(m===2){if(g&&O[1]!==0)throw new l("Extra bits");return[O[0]]}if(m===3){if(g&&O[2]!==0)throw new l("Extra bits");return[O[0],O[1]]}return O},_=function(v,w,g){for(var m=w.length,A=0;A<m;A++)v[g+A]=w[A];return g+m};return Ir=function(v,w,g,m){n(v),t(w);var A=s(w)==="base64"?c:u,O=w?w.lastChunkHandling:void 0;if(O===void 0&&(O="loose"),O!=="loose"&&O!=="strict"&&O!=="stop-before-partial")throw new f("Incorrect `lastChunkHandling` option");g&&o(g.buffer);var I=g||[],M=0,X=0,x="",T=0;if(m)for(;;){if(T=y(v,T),T===v.length){if(x.length>0){if(O==="stop-before-partial")break;if(O==="loose"){if(x.length===1)throw new l("Malformed padding: exactly one additional character");M=_(I,p(x,A,!1),M)}else throw new l("Missing padding")}X=v.length;break}var re=d(v,T);if(++T,re==="="){if(x.length<2)throw new l("Padding is too early");if(T=y(v,T),x.length===2){if(T===v.length){if(O==="stop-before-partial")break;throw new l("Malformed padding: only one =")}d(v,T)==="="&&(++T,T=y(v,T))}if(T<v.length)throw new l("Unexpected character after padding");M=_(I,p(x,A,O==="strict"),M),X=v.length;break}if(!a(A,re))throw new l("Unexpected character");var Jr=m-M;if(Jr===1&&x.length===2||Jr===2&&x.length===3||(x+=re,x.length===4&&(M=_(I,p(x,A,!1),M),x="",X=T,M===m)))break}return{bytes:I,read:X,written:M}},Ir}var Tn;function qi(){if(Tn)return at;Tn=1;var r=wa(),e=E(),t=Ai(),n=xi(),a=e.Uint8Array,i=!a||!a.fromBase64||!function(){try{a.fromBase64("",null)}catch{return!0}}();return a&&r({target:"Uint8Array",stat:!0,forced:i},{fromBase64:function(o){var c=n(o,arguments.length>1?arguments[1]:void 0,null,9007199254740991);return t(a,c.bytes)}}),at}var xn;function Mi(){return xn||(xn=1,qi()),nt}Mi();var qn={},Mn={},Rr,jn;function ji(){if(jn)return Rr;jn=1;var r=Vr(),e=r("toStringTag"),t={};return t[e]="z",Rr=String(t)==="[object z]",Rr}var Tr,Pn;function Pi(){if(Pn)return Tr;Pn=1;var r=ji(),e=D(),t=kr(),n=Vr(),a=n("toStringTag"),i=Object,s=t(function(){return arguments}())==="Arguments",o=function(c,u){try{return c[u]}catch{}};return Tr=r?t:function(c){var u,l,f;return c===void 0?"Undefined":c===null?"Null":typeof(l=o(u=i(c),a))=="string"?l:s?t(u):(f=t(u))==="Object"&&e(u.callee)?"Arguments":f},Tr}var xr,Dn;function Di(){if(Dn)return xr;Dn=1;var r=Pi(),e=TypeError;return xr=function(t){if(r(t)==="Uint8Array")return t;throw new e("Argument is not an Uint8Array")},xr}var Cn;function Ci(){if(Cn)return Mn;Cn=1;var r=wa(),e=E(),t=q(),n=_a(),a=Di(),i=Oa(),s=Sa(),o=Aa(),c=s.i2c,u=s.i2cUrl,l=t("".charAt),f=e.Uint8Array,d=!f||!f.prototype.toBase64||!function(){try{var y=new f;y.toBase64(null)}catch{return!0}}();return f&&r({target:"Uint8Array",proto:!0,forced:d},{toBase64:function(){var p=a(this),_=arguments.length?n(arguments[0]):void 0,v=o(_)==="base64"?c:u,w=!!_&&!!_.omitPadding;i(this.buffer);for(var g="",m=0,A=p.length,O,I=function(M){return l(v,O>>6*M&63)};m+2<A;m+=3)O=(p[m]<<16)+(p[m+1]<<8)+p[m+2],g+=I(3)+I(2)+I(1)+I(0);return m+2===A?(O=(p[m]<<16)+(p[m+1]<<8),g+=I(3)+I(2)+I(1)+(w?"":"=")):m+1===A&&(O=p[m]<<16,g+=I(3)+I(2)+(w?"":"==")),g}}),Mn}var Bn;function Bi(){return Bn||(Bn=1,Ci()),qn}Bi();const Fi=new RegExp("\\p{Script=Han}","u"),Ni=new RegExp("^\\p{Script=Han}$","u"),$i=/[\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Han}\u{2e80}-\u{2fd5}\u{3000}-\u{303f}\u{31f0}-\u{31ff}\u{3220}-\u{3243}\u{3280}-\u{337f}\u{ff5f}-\u{ff9f}\u{ff01}-\u{ff5e}]/u;function Bs(r){return $i.test(r)}function Fs(r){return Fi.test(r)}function Ns(r){return Ni.test(r)}function Ui(r){return new TextDecoder().decode(Uint8Array.fromBase64(r))}function Li(r){return new TextEncoder().encode(r).toBase64()}const jr=["bookmarked-words","cards","decks","progress","reviews"],ki="${PLACEHOLDER}";function Gi(r){if(!jr.includes(r))throw new C({actual:r,message:`Expected "${r}" to be a store name`})}function Ki(r,e){Q(r,e);for(const t of e[r]){ea(t),F("name",t),Gi(t.name),ie("add",t,{optional:!0}),Q("set",t,{optional:!0});for(const n of t.set??[]){if(J(n),n.length!==2)throw new C({actual:n,message:`Excpected a 2-tuple. Got ${n.length}-tuple`});Qn(n[0]),J(n[1]);for(const a of n[1]){if(J(a),a.length!==3)throw new C({actual:n,message:`Excpected a 3-tuple. Got ${a.length}-tuple`});F(0,a),ie(1,a),F(2,a)}}ie("delete",t,{optional:!0})}}function Hi(r,e){Q(r,e);for(const t of e[r])J(t),F(0,t),F(1,t,{nullable:!0})}async function Vi(){const r=Ua.value,e=URL.parse(La.value),t=new Headers(ka.value);if(!e)throw new Error("Remote sync not set up");e.host==="gist.githubusercontent.com"&&e.searchParams.set("cachebuster",new Date().toISOString());const a=await fetch(e,{method:r,headers:t,mode:"cors"}),i=await a.text();if(!a.ok)throw new Error(`Error ${a.status} fetching sync: ${i}`);if(!i.trim())return[];const s=Xn.value,o=JSON.parse(s?Ui(i):i);return J(o),o.map(c=>(ea(c),F("hash",c),F("parent",c,{nullable:!0}),F("syncedAt",c),rt("dbVersion",c),rt("patchVersion",c),Ki("stores",c),Hi("preferences",c),{...c,syncedAt:new Date(c.syncedAt)}))}async function zi(r){const e=Ga.value,t=URL.parse(Ka.value),n=new Headers(Ha.value),a=Xn.value;if(!t)throw new Error("Remote sync not set up");let i=JSON.stringify(r);a&&(i=a.replace(ki,Li(i)));const s=await fetch(t,{method:e,headers:n,body:i,mode:"cors"});if(!s.ok)throw new Error(`Error ${s.status} pushing sync: ${await s.text()}`)}const B="shodoku.app.sync.latest",Yi=1;async function Wi(r){const e=JSON.stringify(r),t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}async function Ji(r){const e={...r,parent:localStorage.getItem(B)};return{...e,hash:await Wi(e)}}async function Xi(){const r=await N,e=r.transaction(jr),t=[];for(const n of jr){const a=e.objectStore(n),i=await a.getAll();if(i.length===0)continue;const s=i.map(o=>{if(a.autoIncrement&&typeof a.keyPath=="string"){const c=a.keyPath;delete o[c]}return W(o)});t.push({name:n,add:s})}return t.length===0?null:{syncedAt:new Date,dbVersion:r.version,patchVersion:Yi,stores:t,preferences:[]}}async function Zi(){const r=await N;if(await r.count("syncs")===0&&localStorage.getItem(B)&&localStorage.removeItem(B),!localStorage.getItem(B))return Xi();const e=r.transaction(r.objectStoreNames),t=await Hn(e.objectStore("sync.staging.stores").iterate(),xa(a=>a.value),Ta(a=>a.store));if(t.size===0)return null;const n=[];for(const[a,i]of t){const s=[],o=[],c=[];for(const l of i)if(l.op==="add"){const f=e.objectStore(a),d=await f.get(l.key);if(!d)continue;if(f.autoIncrement&&typeof f.keyPath=="string"){const y=f.keyPath;delete d[y]}s.push(W(d))}else l.op==="put"?o.push(W(await e.objectStore(a).get(l.key))):c.push(W(l.key));const u={name:a};s.length>0&&(u.add=s),o.length>0&&(u.put=o),c.length>0&&(u.delete=c),(u.add||u.put||u.delete)&&n.push(u)}return{syncedAt:new Date,dbVersion:r.version,patchVersion:1,stores:n,preferences:[]}}function Pr(r,e){if(!r)return e;if(Array.isArray(r))return r.map(n=>Pr(n,e));let t=e;for(const n of r.split("."))t=t[n];return t}function Qi(r,e){return r.updatedAt?e.updatedAt?r.updatedAt>e.updatedAt:!0:e.updatedAt?!1:r.createdAt>e.createdAt}function es(r,e){return r.fsrs.last_review?e.fsrs.last_review?r.fsrs.last_review>e.fsrs.last_review:!0:!1}function rs(r,e){return r.log.review>e.log.review}function ts(r,e){return r.bookmarkedAt>e.bookmarkedAt}function ns(r,e,t){return r==="decks"?Qi(e,t):r==="progress"?es(e,t):r==="reviews"?rs(e,t):r==="bookmarked-words"?ts(e,t):!0}function as(r,e,t){if(!t)return;const n=t.stores.find(({name:i})=>i===r);if(!n?.add)return;const a=n.add.indexOf(e);a!==-1&&n.add.splice(a,1)}function is(r,e,t){if(!t)return;const n=t.stores.find(({name:i})=>i===r);if(!n)return;let{put:a}=n;a||(a=[],n.put=a),a.push(e)}function Fn(r){return r instanceof DOMException&&r.name==="ConstraintError"}async function ss(r,e){const t=await N,n=t.transaction(t.objectStoreNames,"readwrite"),a=localStorage.getItem(B)??null;let i;for(const s of Hn(r,qa(({parent:o})=>o!==a))){for(const o of s.stores){const c=n.objectStore(o.name);for(const u of o.add??[]){const l=ne(u),f=c.add(l),d=Ra(f);d.addEventListener("error",y=>{Fn(d.error)&&(y.preventDefault(),y.stopPropagation())});try{await f}catch(y){if(Fn(y)){const p=await c.get(Pr(c.keyPath,l));if(p){const _=W(p);as(o.name,_,e),ns(o.name,p,l)?is(o.name,_,e):c.put(l)}}else throw y}}for(const u of o.put??[]){const l=ne(u),f=await c.openCursor(Pr(c.keyPath,l));f&&f.update(l)}for(const u of o.delete??[]){const l=ne(u);console.log(l),c.delete(l)}}n.objectStore("syncs").add(s),i=s.hash}await n.done,i&&localStorage.setItem(B,i)}async function $s(){const r=await Vi(),e=await Zi();if(await ss(r,e),!e)return;const t=await Ji(e),a=(await N).transaction(["sync.staging.preferences","sync.staging.stores","syncs"],"readwrite");a.objectStore("sync.staging.stores").clear(),a.objectStore("sync.staging.preferences").clear(),a.objectStore("syncs").add(t),await a.done,localStorage.setItem(B,t.hash),Kn.postMessage("sync-enabled"),await zi([...r,t])}function os(){return localStorage.getItem(B)!=null}async function Us(){const e=(await N).transaction(["sync.staging.preferences","sync.staging.stores","syncs"],"readwrite");e.objectStore("sync.staging.stores").clear(),e.objectStore("sync.staging.preferences").clear(),e.objectStore("syncs").clear(),await e.done,localStorage.removeItem(B),Kn.postMessage("sync-disabled")}async function Ls(r){if(!os())return;const t=(await N).transaction("sync.staging.stores","readwrite");for(const n of r)t.store.add(n);await t.done}var S=(r=>(r[r.New=0]="New",r[r.Learning=1]="Learning",r[r.Review=2]="Review",r[r.Relearning=3]="Relearning",r))(S||{}),h=(r=>(r[r.Manual=0]="Manual",r[r.Again=1]="Again",r[r.Hard=2]="Hard",r[r.Good=3]="Good",r[r.Easy=4]="Easy",r))(h||{});class b{static card(e){return{...e,state:b.state(e.state),due:b.time(e.due),last_review:e.last_review?b.time(e.last_review):void 0}}static rating(e){if(typeof e=="string"){const t=e.charAt(0).toUpperCase(),n=e.slice(1).toLowerCase(),a=h[`${t}${n}`];if(a===void 0)throw new Error(`Invalid rating:[${e}]`);return a}else if(typeof e=="number")return e;throw new Error(`Invalid rating:[${e}]`)}static state(e){if(typeof e=="string"){const t=e.charAt(0).toUpperCase(),n=e.slice(1).toLowerCase(),a=S[`${t}${n}`];if(a===void 0)throw new Error(`Invalid state:[${e}]`);return a}else if(typeof e=="number")return e;throw new Error(`Invalid state:[${e}]`)}static time(e){if(typeof e=="object"&&e instanceof Date)return e;if(typeof e=="string"){const t=Date.parse(e);if(Number.isNaN(t))throw new Error(`Invalid date:[${e}]`);return new Date(t)}else if(typeof e=="number")return new Date(e);throw new Error(`Invalid date:[${e}]`)}static review_log(e){return{...e,due:b.time(e.due),rating:b.rating(e.rating),state:b.state(e.state),review:b.time(e.review)}}}Date.prototype.scheduler=function(r,e){return j(this,r,e)};Date.prototype.diff=function(r,e){return H(this,r,e)};Date.prototype.format=function(){return us(this)};Date.prototype.dueFormat=function(r,e,t){return cs(this,r,e,t)};function j(r,e,t){return new Date(t?b.time(r).getTime()+e*24*60*60*1e3:b.time(r).getTime()+e*60*1e3)}function H(r,e,t){if(!r||!e)throw new Error("Invalid date");const n=b.time(r).getTime()-b.time(e).getTime();let a=0;switch(t){case"days":a=Math.floor(n/(24*60*60*1e3));break;case"minutes":a=Math.floor(n/(60*1e3));break}return a}function us(r){const e=b.time(r),t=e.getFullYear(),n=e.getMonth()+1,a=e.getDate(),i=e.getHours(),s=e.getMinutes(),o=e.getSeconds();return`${t}-${Y(n)}-${Y(a)} ${Y(i)}:${Y(s)}:${Y(o)}`}function Y(r){return r<10?`0${r}`:`${r}`}const qr=[60,60,24,31,12],Mr=["second","min","hour","day","month","year"];function cs(r,e,t,n=Mr){r=b.time(r),e=b.time(e),n.length!==Mr.length&&(n=Mr);let a=r.getTime()-e.getTime(),i=0;for(a/=1e3,i=0;i<qr.length&&!(a<qr[i]);i++)a/=qr[i];return`${Math.floor(a)}${t?n[i]:""}`}const ls=Object.freeze([h.Again,h.Hard,h.Good,h.Easy]),fs=[{start:2.5,end:7,factor:.15},{start:7,end:20,factor:.1},{start:20,end:1/0,factor:.05}];function ds(r,e,t){let n=1;for(const s of fs)n+=s.factor*Math.max(Math.min(r,s.end)-s.start,0);r=Math.min(r,t);let a=Math.max(2,Math.round(r-n));const i=Math.min(Math.round(r+n),t);return r>e&&(a=Math.max(a,e+1)),a=Math.min(a,i),{min_ivl:a,max_ivl:i}}function R(r,e,t){return Math.min(Math.max(r,e),t)}function hs(r,e){const t=Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),n=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return Math.floor((n-t)/864e5)}const ys=r=>{const e=r.slice(-1),t=parseInt(r.slice(0,-1),10);if(Number.isNaN(t)||!Number.isFinite(t)||t<0)throw new Error(`Invalid step value: ${r}`);switch(e){case"m":return t;case"h":return t*60;case"d":return t*1440;default:throw new Error(`Invalid step unit: ${r}, expected m/h/d`)}},vs=(r,e,t)=>{const n=e===S.Relearning||e===S.Review?r.relearning_steps:r.learning_steps,a=n.length;if(a===0||t>=a)return{};const i=n[0],s=ys,o=()=>s(i),c=()=>{if(a===1)return Math.round(s(i)*1.5);const y=n[1];return Math.round((s(i)+s(y))/2)},u=y=>y<0||y>=a?null:n[y],l=y=>s(y),f={},d=u(Math.max(0,t));if(e===S.Review)return f[h.Again]={scheduled_minutes:s(d),next_step:0},f;{f[h.Again]={scheduled_minutes:o(),next_step:0},f[h.Hard]={scheduled_minutes:c(),next_step:t};const y=u(t+1);if(y){const p=l(y);p&&(f[h.Good]={scheduled_minutes:Math.round(p),next_step:t+1})}}return f};function ps(){const r=this.review_time.getTime(),e=this.current.reps,t=this.current.difficulty*this.current.stability;return`${r}_${e}_${t}`}var ee=(r=>(r.SCHEDULER="Scheduler",r.LEARNING_STEPS="LearningSteps",r.SEED="Seed",r))(ee||{});class Ea{last;current;review_time;next=new Map;algorithm;strategies;elapsed_days=0;constructor(e,t,n,a){this.algorithm=n,this.last=b.card(e),this.current=b.card(e),this.review_time=b.time(t),this.strategies=a,this.init()}checkGrade(e){if(!Number.isFinite(e)||e<0||e>4)throw new Error(`Invalid grade "${e}",expected 1-4`)}init(){const{state:e,last_review:t}=this.current;let n=0;e!==S.New&&t&&(n=hs(t,this.review_time)),this.current.last_review=this.review_time,this.elapsed_days=n,this.current.elapsed_days=n,this.current.reps+=1;let a=ps;if(this.strategies){const i=this.strategies.get(ee.SEED);i&&(a=i)}this.algorithm.seed=a.call(this)}preview(){return{[h.Again]:this.review(h.Again),[h.Hard]:this.review(h.Hard),[h.Good]:this.review(h.Good),[h.Easy]:this.review(h.Easy),[Symbol.iterator]:this.previewIterator.bind(this)}}*previewIterator(){for(const e of ls)yield this.review(e)}review(e){const{state:t}=this.last;let n;switch(this.checkGrade(e),t){case S.New:n=this.newState(e);break;case S.Learning:case S.Relearning:n=this.learningState(e);break;case S.Review:n=this.reviewState(e);break}return n}buildLog(e){const{last_review:t,due:n,elapsed_days:a}=this.last;return{rating:e,state:this.current.state,due:t||n,stability:this.current.stability,difficulty:this.current.difficulty,elapsed_days:this.elapsed_days,last_elapsed_days:a,scheduled_days:this.current.scheduled_days,learning_steps:this.current.learning_steps,review:this.review_time}}}class gs{c;s0;s1;s2;constructor(e){const t=ms();this.c=1,this.s0=t(" "),this.s1=t(" "),this.s2=t(" "),e==null&&(e=Date.now()),this.s0-=t(e),this.s0<0&&(this.s0+=1),this.s1-=t(e),this.s1<0&&(this.s1+=1),this.s2-=t(e),this.s2<0&&(this.s2+=1)}next(){const e=2091639*this.s0+this.c*23283064365386963e-26;return this.s0=this.s1,this.s1=this.s2,this.c=e|0,this.s2=e-this.c,this.s2}set state(e){this.c=e.c,this.s0=e.s0,this.s1=e.s1,this.s2=e.s2}get state(){return{c:this.c,s0:this.s0,s1:this.s1,s2:this.s2}}}function ms(){let r=4022871197;return function(t){t=String(t);for(let n=0;n<t.length;n++){r+=t.charCodeAt(n);let a=.02519603282416938*r;r=a>>>0,a-=r,a*=r,r=a>>>0,a-=r,r+=a*4294967296}return(r>>>0)*23283064365386963e-26}}function bs(r){const e=new gs(r),t=()=>e.next();return t.int32=()=>e.next()*4294967296|0,t.double=()=>t()+(t()*2097152|0)*11102230246251565e-32,t.state=()=>e.state,t.importState=n=>(e.state=n,t),t}const ws=.9,_s=36500,Ss=!1,As=!0,Os=Object.freeze(["1m","10m"]),Es=Object.freeze(["10m"]),P=.001,Z=100,Nn=.5,Is=.1542,$n=Object.freeze([.212,1.2931,2.3065,8.2956,6.4133,.8334,3.0194,.001,1.8722,.1666,.796,1.4835,.0614,.2629,1.6483,.6014,1.8729,.5425,.0912,.0658,Is]),Rs=2,Ts=r=>[[P,Z],[P,Z],[P,Z],[P,Z],[1,10],[.001,4],[.001,4],[.001,.75],[0,4.5],[0,.8],[.001,3.5],[.001,5],[.001,.25],[.001,.9],[0,4],[0,1],[1,6],[0,r],[0,r],[0,.8],[.1,.8]],Yr=(r,e)=>{let t=Rs;if(Math.max(0,e)>1){const a=-(Math.log(r[11])+Math.log(Math.pow(2,r[13])-1)+r[14]*.3)/e;t=R(+a.toFixed(8),.01,2)}return Ts(t).map(([a,i],s)=>R(r[s],a,i))},Wr=r=>{if(r===void 0)return[...$n];switch(r.length){case 21:return[...r];case 19:return console.debug("[FSRS-6]auto fill w from 19 to 21 length"),[...r,0,Nn];case 17:{const e=[...r];return e[4]=+(e[5]*2+e[4]).toFixed(8),e[5]=+(Math.log(e[5]*3+1)/3).toFixed(8),e[6]=+(e[6]+.5).toFixed(8),console.debug("[FSRS-6]auto fill w from 17 to 21 length"),e.concat([0,0,0,Nn])}default:return console.warn("[FSRS]Invalid parameters length, using default parameters"),[...$n]}},Un=r=>{const e=Array.isArray(r?.learning_steps)?r.learning_steps:Os,t=Array.isArray(r?.relearning_steps)?r.relearning_steps:Es,n=Yr(Wr(r?.w),t.length);return{request_retention:r?.request_retention||ws,maximum_interval:r?.maximum_interval||_s,w:n,enable_fuzz:r?.enable_fuzz??Ss,enable_short_term:r?.enable_short_term??As,learning_steps:e,relearning_steps:t}};function Dr(r,e){return{due:r?b.time(r):new Date,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:0,lapses:0,learning_steps:0,state:S.New,last_review:void 0}}const Ia=r=>{const e=typeof r=="number"?-r:-r[20],t=Math.exp(Math.pow(e,-1)*Math.log(.9))-1;return{decay:e,factor:+t.toFixed(8)}};function Cr(r,e,t){const{decay:n,factor:a}=Ia(r);return+Math.pow(1+a*e/t,n).toFixed(8)}class xs{param;intervalModifier;_seed;constructor(e){this.param=new Proxy(Un(e),this.params_handler_proxy()),this.intervalModifier=this.calculate_interval_modifier(this.param.request_retention),this.forgetting_curve=Cr.bind(this,this.param.w)}get interval_modifier(){return this.intervalModifier}set seed(e){this._seed=e}calculate_interval_modifier(e){if(e<=0||e>1)throw new Error("Requested retention rate should be in the range (0,1]");const{decay:t,factor:n}=Ia(this.param.w);return+((Math.pow(e,1/t)-1)/n).toFixed(8)}get parameters(){return this.param}set parameters(e){this.update_parameters(e)}params_handler_proxy(){const e=this;return{set:function(t,n,a){return n==="request_retention"&&Number.isFinite(a)?e.intervalModifier=e.calculate_interval_modifier(Number(a)):n==="w"&&(a=Yr(Wr(a),t.relearning_steps.length),e.forgetting_curve=Cr.bind(this,a),e.intervalModifier=e.calculate_interval_modifier(Number(t.request_retention))),Reflect.set(t,n,a),!0}}}update_parameters(e){const t=Un(e);for(const n in t){const a=n;this.param[a]=t[a]}}init_stability(e){return Math.max(this.param.w[e-1],.1)}init_difficulty(e){return+(this.param.w[4]-Math.exp((e-1)*this.param.w[5])+1).toFixed(8)}apply_fuzz(e,t){if(!this.param.enable_fuzz||e<2.5)return Math.round(e);const a=bs(this._seed)(),{min_ivl:i,max_ivl:s}=ds(e,t,this.param.maximum_interval);return Math.floor(a*(s-i+1)+i)}next_interval(e,t){const n=Math.min(Math.max(1,Math.round(e*this.intervalModifier)),this.param.maximum_interval);return this.apply_fuzz(n,t)}linear_damping(e,t){return+(e*(10-t)/9).toFixed(8)}next_difficulty(e,t){const n=-this.param.w[6]*(t-3),a=e+this.linear_damping(n,e);return R(this.mean_reversion(this.init_difficulty(h.Easy),a),1,10)}mean_reversion(e,t){return+(this.param.w[7]*e+(1-this.param.w[7])*t).toFixed(8)}next_recall_stability(e,t,n,a){const i=h.Hard===a?this.param.w[15]:1,s=h.Easy===a?this.param.w[16]:1;return+R(t*(1+Math.exp(this.param.w[8])*(11-e)*Math.pow(t,-this.param.w[9])*(Math.exp((1-n)*this.param.w[10])-1)*i*s),P,36500).toFixed(8)}next_forget_stability(e,t,n){return+R(this.param.w[11]*Math.pow(e,-this.param.w[12])*(Math.pow(t+1,this.param.w[13])-1)*Math.exp((1-n)*this.param.w[14]),P,36500).toFixed(8)}next_short_term_stability(e,t){const n=Math.pow(e,-this.param.w[19])*Math.exp(this.param.w[17]*(t-3+this.param.w[18])),a=t>=3?Math.max(n,1):n;return+R(e*a,P,36500).toFixed(8)}forgetting_curve;next_state(e,t,n){const{difficulty:a,stability:i}=e??{difficulty:0,stability:0};if(t<0)throw new Error(`Invalid delta_t "${t}"`);if(n<0||n>4)throw new Error(`Invalid grade "${n}"`);if(a===0&&i===0)return{difficulty:R(this.init_difficulty(n),1,10),stability:this.init_stability(n)};if(n===0)return{difficulty:a,stability:i};if(a<1||i<P)throw new Error(`Invalid memory state { difficulty: ${a}, stability: ${i} }`);const s=this.forgetting_curve(t,i),o=this.next_recall_stability(a,i,s,n),c=this.next_forget_stability(a,i,s),u=this.next_short_term_stability(i,n);let l=o;if(n===1){let[d,y]=[0,0];this.param.enable_short_term&&(d=this.param.w[17],y=this.param.w[18]);const p=i/Math.exp(d*y);l=R(+p.toFixed(8),P,c)}return t===0&&this.param.enable_short_term&&(l=u),{difficulty:this.next_difficulty(a,n),stability:l}}}class Ln extends Ea{learningStepsStrategy;constructor(e,t,n,a){super(e,t,n,a);let i=vs;if(this.strategies){const s=this.strategies.get(ee.LEARNING_STEPS);s&&(i=s)}this.learningStepsStrategy=i}getLearningInfo(e,t){const n=this.algorithm.parameters;e.learning_steps=e.learning_steps||0;const a=this.learningStepsStrategy(n,e.state,this.current.state===S.Learning&&t!==h.Again&&t!==h.Hard?e.learning_steps+1:e.learning_steps),i=Math.max(0,a[t]?.scheduled_minutes??0),s=Math.max(0,a[t]?.next_step??0);return{scheduled_minutes:i,next_steps:s}}applyLearningSteps(e,t,n){const{scheduled_minutes:a,next_steps:i}=this.getLearningInfo(this.current,t);if(a>0&&a<1440)e.learning_steps=i,e.scheduled_days=0,e.state=n,e.due=j(this.review_time,Math.round(a),!1);else if(e.state=S.Review,a>=1440)e.learning_steps=i,e.due=j(this.review_time,Math.round(a),!1),e.scheduled_days=Math.floor(a/1440);else{e.learning_steps=0;const s=this.algorithm.next_interval(e.stability,this.elapsed_days);e.scheduled_days=s,e.due=j(this.review_time,s,!0)}}newState(e){const t=this.next.get(e);if(t)return t;const n=b.card(this.current);n.difficulty=R(this.algorithm.init_difficulty(e),1,10),n.stability=this.algorithm.init_stability(e),this.applyLearningSteps(n,e,S.Learning);const a={card:n,log:this.buildLog(e)};return this.next.set(e,a),a}learningState(e){const t=this.next.get(e);if(t)return t;const{state:n,difficulty:a,stability:i}=this.last,s=b.card(this.current);s.difficulty=this.algorithm.next_difficulty(a,e),s.stability=this.algorithm.next_short_term_stability(i,e),this.applyLearningSteps(s,e,n);const o={card:s,log:this.buildLog(e)};return this.next.set(e,o),o}reviewState(e){const t=this.next.get(e);if(t)return t;const n=this.elapsed_days,{difficulty:a,stability:i}=this.last,s=this.algorithm.forgetting_curve(n,i),o=b.card(this.current),c=b.card(this.current),u=b.card(this.current),l=b.card(this.current);this.next_ds(o,c,u,l,a,i,s),this.next_interval(c,u,l,n),this.next_state(c,u,l),this.applyLearningSteps(o,h.Again,S.Relearning),o.lapses+=1;const f={card:o,log:this.buildLog(h.Again)},d={card:c,log:super.buildLog(h.Hard)},y={card:u,log:super.buildLog(h.Good)},p={card:l,log:super.buildLog(h.Easy)};return this.next.set(h.Again,f),this.next.set(h.Hard,d),this.next.set(h.Good,y),this.next.set(h.Easy,p),this.next.get(e)}next_ds(e,t,n,a,i,s,o){e.difficulty=this.algorithm.next_difficulty(i,h.Again);const c=s/Math.exp(this.algorithm.parameters.w[17]*this.algorithm.parameters.w[18]),u=this.algorithm.next_forget_stability(i,s,o);e.stability=R(+c.toFixed(8),P,u),t.difficulty=this.algorithm.next_difficulty(i,h.Hard),t.stability=this.algorithm.next_recall_stability(i,s,o,h.Hard),n.difficulty=this.algorithm.next_difficulty(i,h.Good),n.stability=this.algorithm.next_recall_stability(i,s,o,h.Good),a.difficulty=this.algorithm.next_difficulty(i,h.Easy),a.stability=this.algorithm.next_recall_stability(i,s,o,h.Easy)}next_interval(e,t,n,a){let i,s;i=this.algorithm.next_interval(e.stability,a),s=this.algorithm.next_interval(t.stability,a),i=Math.min(i,s),s=Math.max(s,i+1);const o=Math.max(this.algorithm.next_interval(n.stability,a),s+1);e.scheduled_days=i,e.due=j(this.review_time,i,!0),t.scheduled_days=s,t.due=j(this.review_time,s,!0),n.scheduled_days=o,n.due=j(this.review_time,o,!0)}next_state(e,t,n){e.state=S.Review,e.learning_steps=0,t.state=S.Review,t.learning_steps=0,n.state=S.Review,n.learning_steps=0}}class kn extends Ea{newState(e){const t=this.next.get(e);if(t)return t;this.current.scheduled_days=0,this.current.elapsed_days=0;const n=b.card(this.current),a=b.card(this.current),i=b.card(this.current),s=b.card(this.current);return this.init_ds(n,a,i,s),this.next_interval(n,a,i,s,0),this.next_state(n,a,i,s),this.update_next(n,a,i,s),this.next.get(e)}init_ds(e,t,n,a){e.difficulty=R(this.algorithm.init_difficulty(h.Again),1,10),e.stability=this.algorithm.init_stability(h.Again),t.difficulty=R(this.algorithm.init_difficulty(h.Hard),1,10),t.stability=this.algorithm.init_stability(h.Hard),n.difficulty=R(this.algorithm.init_difficulty(h.Good),1,10),n.stability=this.algorithm.init_stability(h.Good),a.difficulty=R(this.algorithm.init_difficulty(h.Easy),1,10),a.stability=this.algorithm.init_stability(h.Easy)}learningState(e){return this.reviewState(e)}reviewState(e){const t=this.next.get(e);if(t)return t;const n=this.elapsed_days,{difficulty:a,stability:i}=this.last,s=this.algorithm.forgetting_curve(n,i),o=b.card(this.current),c=b.card(this.current),u=b.card(this.current),l=b.card(this.current);return this.next_ds(o,c,u,l,a,i,s),this.next_interval(o,c,u,l,n),this.next_state(o,c,u,l),o.lapses+=1,this.update_next(o,c,u,l),this.next.get(e)}next_ds(e,t,n,a,i,s,o){e.difficulty=this.algorithm.next_difficulty(i,h.Again);const c=this.algorithm.next_forget_stability(i,s,o);e.stability=R(s,P,c),t.difficulty=this.algorithm.next_difficulty(i,h.Hard),t.stability=this.algorithm.next_recall_stability(i,s,o,h.Hard),n.difficulty=this.algorithm.next_difficulty(i,h.Good),n.stability=this.algorithm.next_recall_stability(i,s,o,h.Good),a.difficulty=this.algorithm.next_difficulty(i,h.Easy),a.stability=this.algorithm.next_recall_stability(i,s,o,h.Easy)}next_interval(e,t,n,a,i){let s,o,c,u;s=this.algorithm.next_interval(e.stability,i),o=this.algorithm.next_interval(t.stability,i),c=this.algorithm.next_interval(n.stability,i),u=this.algorithm.next_interval(a.stability,i),s=Math.min(s,o),o=Math.max(o,s+1),c=Math.max(c,o+1),u=Math.max(u,c+1),e.scheduled_days=s,e.due=j(this.review_time,s,!0),t.scheduled_days=o,t.due=j(this.review_time,o,!0),n.scheduled_days=c,n.due=j(this.review_time,c,!0),a.scheduled_days=u,a.due=j(this.review_time,u,!0)}next_state(e,t,n,a){e.state=S.Review,e.learning_steps=0,t.state=S.Review,t.learning_steps=0,n.state=S.Review,n.learning_steps=0,a.state=S.Review,a.learning_steps=0}update_next(e,t,n,a){const i={card:e,log:this.buildLog(h.Again)},s={card:t,log:super.buildLog(h.Hard)},o={card:n,log:super.buildLog(h.Good)},c={card:a,log:super.buildLog(h.Easy)};this.next.set(h.Again,i),this.next.set(h.Hard,s),this.next.set(h.Good,o),this.next.set(h.Easy,c)}}class qs{fsrs;constructor(e){this.fsrs=e}replay(e,t,n){return this.fsrs.next(e,t,n)}handleManualRating(e,t,n,a,i,s,o){if(typeof t>"u")throw new Error("reschedule: state is required for manual rating");let c,u;if(t===S.New)c={rating:h.Manual,state:t,due:o??n,stability:e.stability,difficulty:e.difficulty,elapsed_days:a,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,learning_steps:e.learning_steps,review:n},u=Dr(n),u.last_review=n;else{if(typeof o>"u")throw new Error("reschedule: due is required for manual rating");const l=H(o,n,"days");c={rating:h.Manual,state:e.state,due:e.last_review||e.due,stability:e.stability,difficulty:e.difficulty,elapsed_days:a,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,learning_steps:e.learning_steps,review:n},u={...e,state:t,due:o,last_review:n,stability:i||e.stability,difficulty:s||e.difficulty,elapsed_days:a,scheduled_days:l,reps:e.reps+1}}return{card:u,log:c}}reschedule(e,t){const n=[];let a=Dr(e.due);for(const i of t){let s;if(i.review=b.time(i.review),i.rating===h.Manual){let o=0;a.state!==S.New&&a.last_review&&(o=H(i.review,a.last_review,"days")),s=this.handleManualRating(a,i.state,i.review,o,i.stability,i.difficulty,i.due?b.time(i.due):void 0)}else s=this.replay(a,i.review,i.rating);n.push(s),a=s.card}return n}calculateManualRecord(e,t,n,a){if(!n)return null;const{card:i,log:s}=n,o=b.card(e);return o.due.getTime()===i.due.getTime()?null:(o.scheduled_days=H(i.due,o.due,"days"),this.handleManualRating(o,i.state,b.time(t),s.elapsed_days,a?i.stability:void 0,a?i.difficulty:void 0,i.due))}}class Ms extends xs{strategyHandler=new Map;Scheduler;constructor(e){super(e);const{enable_short_term:t}=this.parameters;this.Scheduler=t?Ln:kn}params_handler_proxy(){const e=this;return{set:function(t,n,a){return n==="request_retention"&&Number.isFinite(a)?e.intervalModifier=e.calculate_interval_modifier(Number(a)):n==="enable_short_term"?e.Scheduler=a===!0?Ln:kn:n==="w"&&(a=Yr(Wr(a),t.relearning_steps.length),e.forgetting_curve=Cr.bind(this,a),e.intervalModifier=e.calculate_interval_modifier(Number(t.request_retention))),Reflect.set(t,n,a),!0}}}useStrategy(e,t){return this.strategyHandler.set(e,t),this}clearStrategy(e){return e?this.strategyHandler.delete(e):this.strategyHandler.clear(),this}getScheduler(e,t){const a=this.strategyHandler.get(ee.SCHEDULER)||this.Scheduler;return new a(e,t,this,this.strategyHandler)}repeat(e,t,n){const i=this.getScheduler(e,t).preview();return n&&typeof n=="function"?n(i):i}next(e,t,n,a){const i=this.getScheduler(e,t),s=b.rating(n);if(s===h.Manual)throw new Error("Cannot review a manual rating");const o=i.review(s);return a&&typeof a=="function"?a(o):o}get_retrievability(e,t,n=!0){const a=b.card(e);t=t?b.time(t):new Date;const i=a.state!==S.New?Math.max(H(t,a.last_review,"days"),0):0,s=a.state!==S.New?this.forgetting_curve(i,+a.stability.toFixed(8)):0;return n?`${(s*100).toFixed(2)}%`:s}rollback(e,t,n){const a=b.card(e),i=b.review_log(t);if(i.rating===h.Manual)throw new Error("Cannot rollback a manual rating");let s,o,c;switch(i.state){case S.New:s=i.due,o=void 0,c=0;break;case S.Learning:case S.Relearning:case S.Review:s=i.review,o=i.due,c=a.lapses-(i.rating===h.Again&&i.state===S.Review?1:0);break}const u={...a,due:s,stability:i.stability,difficulty:i.difficulty,elapsed_days:i.last_elapsed_days,scheduled_days:i.scheduled_days,reps:Math.max(0,a.reps-1),lapses:Math.max(0,c),learning_steps:i.learning_steps,state:i.state,last_review:o};return n&&typeof n=="function"?n(u):u}forget(e,t,n=!1,a){const i=b.card(e);t=b.time(t);const s=i.state===S.New?0:H(t,i.due,"days"),o={rating:h.Manual,state:i.state,due:i.due,stability:i.stability,difficulty:i.difficulty,elapsed_days:0,last_elapsed_days:i.elapsed_days,scheduled_days:s,learning_steps:i.learning_steps,review:t},u={card:{...i,due:t,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:n?0:i.reps,lapses:n?0:i.lapses,learning_steps:0,state:S.New,last_review:i.last_review},log:o};return a&&typeof a=="function"?a(u):u}reschedule(e,t=[],n={}){const{recordLogHandler:a,reviewsOrderBy:i,skipManual:s=!0,now:o=new Date,update_memory_state:c=!1}=n;i&&typeof i=="function"&&t.sort(i),s&&(t=t.filter(p=>p.rating!==h.Manual));const u=new qs(this),l=u.reschedule(n.first_card||Dr(),t),f=l.length,d=b.card(e),y=u.calculateManualRecord(d,o,f?l[f-1]:void 0,c);return a&&typeof a=="function"?{collections:l.map(a),reschedule_item:y?a(y):null}:{collections:l,reschedule_item:y}}}const ks=r=>new Ms(r||{});export{Ms as F,ki as P,h as R,S,Ls as a,Bs as b,Dr as c,Fi as d,Ga as e,ks as f,Un as g,Fs as h,Ns as i,Ha as j,Xn as k,La as l,xa as m,Ua as n,ka as o,Hn as p,Us as q,Ka as r,Cs as s,$s as t,Ds as u};
