{"version":3,"file":"kanji-BxdS7aig.js","sources":["../../src/helpers/kanji.ts"],"sourcesContent":["import { MaybeRefOrGetter, Ref, ref, toValue, watch } from \"vue\";\n\nimport { KanjiInfo, KanjiVocab } from \"../types.ts\";\n\nexport function useKanji(\n  codepoint: MaybeRefOrGetter<number | null | undefined>,\n): Ref<KanjiInfo | null> {\n  const kanji = ref<KanjiInfo | null>(null);\n\n  function setKanji(kanjiInfo: KanjiInfo) {\n    kanji.value = kanjiInfo;\n  }\n\n  watch(\n    () => toValue(codepoint),\n    async (value) => {\n      if (!value) {\n        kanji.value = null;\n        return;\n      }\n\n      if (value === kanji.value?.codepoint) {\n        return;\n      }\n\n      const hex = value.toString(16).padStart(5, \"0\");\n      const response = await fetch(`/data/kanji-v1/${hex}.json`);\n\n      if (\n        !response.ok ||\n        !response.headers.get(\"Content-Type\")?.startsWith(\"application/json\")\n      ) {\n        // eslint-disable-next-line no-console\n        console.error(\"failed getting kanji:\", value);\n        return;\n      }\n\n      try {\n        const data = await response.json();\n        setKanji(data);\n      } catch {\n        // eslint-disable-next-line no-console\n        console.error(\"failed getting kanji:\", value);\n      }\n    },\n    { immediate: true },\n  );\n\n  return kanji;\n}\n\nexport function useKanjiVocab(\n  codepoint: MaybeRefOrGetter<number | null | undefined>,\n): Ref<KanjiVocab | null> {\n  const kanjiVocab = ref<KanjiVocab | null>(null);\n\n  watch(\n    () => toValue(codepoint),\n    async (value) => {\n      if (!value) {\n        kanjiVocab.value = null;\n        return;\n      }\n\n      const hex = value.toString(16).padStart(5, \"0\");\n      const response = await fetch(`/data/kanji-vocab-v1/${hex}.json`);\n\n      if (\n        !response.ok ||\n        !response.headers.get(\"Content-Type\")?.startsWith(\"application/json\")\n      ) {\n        // eslint-disable-next-line no-console\n        console.error(\"failed getting kanji:\", value);\n        return;\n      }\n\n      try {\n        const data = await response.json();\n        kanjiVocab.value = data;\n      } catch {\n        // eslint-disable-next-line no-console\n        console.error(\"failed getting kanji:\", value);\n      }\n    },\n    { immediate: true },\n  );\n\n  return kanjiVocab;\n}\n"],"names":["useKanji","codepoint","kanji","ref","setKanji","kanjiInfo","watch","toValue","value","hex","response","data","useKanjiVocab","kanjiVocab"],"mappings":"sDAIO,SAASA,EACdC,EACuB,CACvB,MAAMC,EAAQC,EAAsB,IAAI,EAExC,SAASC,EAASC,EAAsB,CACtCH,EAAM,MAAQG,CAChB,CAEA,OAAAC,EACE,IAAMC,EAAQN,CAAS,EACvB,MAAOO,GAAU,CACf,GAAI,CAACA,EAAO,CACVN,EAAM,MAAQ,KACd,MACF,CAEA,GAAIM,IAAUN,EAAM,OAAO,UACzB,OAGF,MAAMO,EAAMD,EAAM,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,EACxCE,EAAW,MAAM,MAAM,kBAAkBD,CAAG,OAAO,EAEzD,GACE,CAACC,EAAS,IACV,CAACA,EAAS,QAAQ,IAAI,cAAc,GAAG,WAAW,kBAAkB,EACpE,CAEA,QAAQ,MAAM,wBAAyBF,CAAK,EAC5C,MACF,CAEA,GAAI,CACF,MAAMG,EAAO,MAAMD,EAAS,KAAA,EAC5BN,EAASO,CAAI,CACf,MAAQ,CAEN,QAAQ,MAAM,wBAAyBH,CAAK,CAC9C,CACF,EACA,CAAE,UAAW,EAAA,CAAK,EAGbN,CACT,CAEO,SAASU,EACdX,EACwB,CACxB,MAAMY,EAAaV,EAAuB,IAAI,EAE9C,OAAAG,EACE,IAAMC,EAAQN,CAAS,EACvB,MAAOO,GAAU,CACf,GAAI,CAACA,EAAO,CACVK,EAAW,MAAQ,KACnB,MACF,CAEA,MAAMJ,EAAMD,EAAM,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,EACxCE,EAAW,MAAM,MAAM,wBAAwBD,CAAG,OAAO,EAE/D,GACE,CAACC,EAAS,IACV,CAACA,EAAS,QAAQ,IAAI,cAAc,GAAG,WAAW,kBAAkB,EACpE,CAEA,QAAQ,MAAM,wBAAyBF,CAAK,EAC5C,MACF,CAEA,GAAI,CACF,MAAMG,EAAO,MAAMD,EAAS,KAAA,EAC5BG,EAAW,MAAQF,CACrB,MAAQ,CAEN,QAAQ,MAAM,wBAAyBH,CAAK,CAC9C,CACF,EACA,CAAE,UAAW,EAAA,CAAK,EAGbK,CACT"}