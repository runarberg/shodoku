{"version":3,"file":"KanjiView-CcPg-kpY.js","sources":["../../src/helpers/menu.ts","../../src/components/AppMenu.vue","../../src/components/AppMenuItem.vue","../../src/components/AppDialog.vue","../../src/components/KanjiManageDecksDeckItem.vue","../../src/components/KanjiManageDecksDialog.vue","../../src/components/KanjiExploreActions.vue","../../src/views/KanjiView.vue"],"sourcesContent":["import { inject, InjectionKey, provide, Ref, ref } from \"vue\";\n\ntype Menu = {\n  open: Ref<boolean>;\n};\n\nconst MENU_INJECTION_KEY: InjectionKey<Menu> = Symbol(\"menu-injection-key\");\n\nfunction createMenu(): Menu {\n  return {\n    open: ref(false),\n  };\n}\n\nexport function provideMenu(): Menu {\n  const menu = createMenu();\n\n  provide(MENU_INJECTION_KEY, menu);\n\n  return menu;\n}\n\nexport function useMenu(): Menu {\n  return inject(MENU_INJECTION_KEY, createMenu, true);\n}\n","<script lang=\"ts\" setup>\nimport { ref, useId, watch } from \"vue\";\n\nimport { provideMenu } from \"../helpers/menu.ts\";\nimport AppIcon from \"./AppIcon.vue\";\n\nconst props = withDefaults(\n  defineProps<{\n    open?: boolean;\n    disabled?: boolean;\n    toggleIcon?: string | null;\n  }>(),\n  {\n    open: false,\n    disabled: false,\n    toggleIcon: null,\n  },\n);\n\nconst emit = defineEmits<{\n  (event: \"update:open\", open: boolean): void;\n}>();\n\nconst toggleButton = ref<HTMLButtonElement | null>(null);\nconst popoverEl = ref<HTMLElement | null>(null);\nconst menuEl = ref<HTMLElement | null>(null);\n\nconst menu = provideMenu();\n\nconst id = useId();\nconst anchorName = `--${id}`.replace(\":\", \"-anchor-\");\n\nfunction close() {\n  menu.open.value = false;\n}\n\nfunction handleFocusout(event: FocusEvent) {\n  if (\n    event.relatedTarget instanceof Element &&\n    !menuEl.value?.contains(event.relatedTarget)\n  ) {\n    close();\n  }\n}\n\nfunction handleToggle(event: ToggleEvent) {\n  menu.open.value = event.newState === \"open\";\n}\n\nfunction handleBeforeToggle(event: ToggleEvent) {\n  if (event.newState !== \"open\") {\n    return;\n  }\n\n  // Polyfill the anchor positioning\n  if (!(\"anchorName\" in document.documentElement.style)) {\n    const togglerBox = toggleButton.value?.getBoundingClientRect();\n    const style = popoverEl.value?.style;\n\n    if (style && togglerBox) {\n      style.insetBlockStart = `${togglerBox.bottom + window.scrollY}px`;\n      style.insetInlineEnd = `calc(100% - ${togglerBox.right}px)`;\n    }\n\n    // TODO: Apply fallback positions with an intersection observer.\n  }\n}\n\nwatch(menu.open, (open) => {\n  if (!open) {\n    popoverEl.value?.hidePopover();\n  } else {\n    popoverEl.value?.showPopover();\n  }\n\n  emit(\"update:open\", open);\n});\n\nwatch(\n  () => props.open,\n  (open) => {\n    if (open !== menu.open.value) {\n      menu.open.value = open;\n    }\n  },\n);\n</script>\n\n<template>\n  <div\n    ref=\"menuEl\"\n    class=\"app-menu popover-container\"\n    @focusout=\"handleFocusout($event)\"\n  >\n    <button\n      ref=\"toggleButton\"\n      class=\"toggle-button\"\n      :class=\"{ open: menu.open.value }\"\n      :aria-label=\"$slots.toggle ? undefined : 'Options'\"\n      :popovertarget=\"id\"\n      :disabled=\"disabled\"\n    >\n      <slot name=\"toggle\">\n        <AppIcon v-if=\"toggleIcon\" :icon=\"toggleIcon\" class=\"toggle-icon\" />\n      </slot>\n    </button>\n\n    <div\n      :id=\"id\"\n      ref=\"popoverEl\"\n      class=\"popover\"\n      popover\n      @beforetoggle=\"handleBeforeToggle\"\n      @toggle=\"handleToggle\"\n    >\n      <menu role=\"list\" class=\"menu\">\n        <slot />\n      </menu>\n    </div>\n  </div>\n</template>\n\n<style lang=\"postcss\" scoped>\n.toggle-button {\n  background: none;\n  border: none;\n  color: var(--text-light);\n  cursor: pointer;\n  font-size: 1em;\n  font-weight: 400;\n  margin: 0;\n  padding: 0;\n\n  .popover-container:has(:popover-open) & {\n    color: var(--accent-color);\n  }\n}\n\n.popover {\n  background: var(--background-strong);\n  border: 1px solid var(--accent-color);\n  border-radius: 0.5ex;\n  inline-size: max-content;\n  inset: auto;\n  margin-inline: 0;\n  max-inline-size: 25ch;\n  padding: 0;\n  position: absolute;\n}\n\n@supports (anchor-name: --app-menu-anchor) {\n  .toggle-button {\n    anchor-name: v-bind(anchorName);\n  }\n\n  .popover {\n    position-area: block-end span-inline-start;\n    position-anchor: v-bind(anchorName);\n    position-try:\n      flip-block,\n      flip-inline,\n      flip-block flip-inline;\n  }\n}\n\n.menu {\n  list-style: none;\n  margin: 0;\n  padding: 1ex 0;\n}\n\n.toggle-icon {\n  color: var(--text-light);\n\n  .toggle-button.open & {\n    color: var(--accent-color);\n  }\n}\n</style>\n","<script lang=\"ts\" setup=\"setup\">\nimport type { RouteLocationRaw } from \"vue-router\";\n\nimport { useMenu } from \"../helpers/menu.ts\";\nimport AppButton from \"./AppButton.vue\";\n\nconst props = withDefaults(\n  defineProps<{\n    prefixIcon?: string | null;\n    to?: RouteLocationRaw | null;\n    disabled?: boolean;\n    persistent?: boolean;\n    replace?: boolean;\n  }>(),\n  {\n    prefixIcon: null,\n    to: null,\n    disabled: false,\n    persistent: false,\n    replace: false,\n  },\n);\n\nconst emit = defineEmits<{\n  (event: \"click\", value: MouseEvent): void;\n}>();\n\nconst { open } = useMenu();\n\nfunction handleClick(event: MouseEvent) {\n  if (props.disabled) {\n    return;\n  }\n\n  if (!props.persistent) {\n    open.value = false;\n  }\n\n  emit(\"click\", event);\n}\n</script>\n\n<template>\n  <li class=\"app-menu-item\">\n    <AppButton\n      type=\"button\"\n      inline\n      class=\"button\"\n      :disabled=\"disabled\"\n      :prefix-icon=\"prefixIcon\"\n      :to=\"to\"\n      :replace=\"replace\"\n      @click=\"handleClick\"\n    >\n      <template v-if=\"$slots.prefix\" #prefix>\n        <slot name=\"prefix\" />\n      </template>\n\n      <span class=\"text\"><slot /></span>\n    </AppButton>\n  </li>\n</template>\n\n<style scoped>\n.app-menu-item .button {\n  align-items: start;\n  box-sizing: border-box;\n  display: flex;\n  font-weight: 600;\n  inline-size: 100%;\n  padding: 0.5em 1em;\n  text-align: start;\n}\n\n.app-menu-item .button:not(:disabled, [data-disabled]) .text {\n  color: var(--accent-color);\n}\n</style>\n","<script lang=\"ts\" setup>\nimport { ref, useId } from \"vue\";\n\nimport AppButton from \"./AppButton.vue\";\nimport AppIcon from \"./AppIcon.vue\";\n\nwithDefaults(\n  defineProps<{\n    title?: string | null;\n    cancelLabel?: string | null;\n    confirmDisabled?: boolean;\n    confirmLabel?: string | null;\n  }>(),\n  {\n    title: null,\n    cancelLabel: null,\n    confirmDisabled: false,\n    confirmLabel: null,\n  },\n);\n\nconst emit = defineEmits<{\n  cancel: [];\n  close: [];\n  confirm: [];\n}>();\n\nconst open = ref(false);\nconst dialog = ref<HTMLDialogElement | null>(null);\n\nconst idPrefix = useId();\n\nfunction close(returnValue = \"\") {\n  emit(\"close\");\n  open.value = false;\n\n  if (dialog.value?.open) {\n    dialog.value.close(returnValue);\n  }\n}\n\nfunction cancel() {\n  emit(\"cancel\");\n  close(\"\");\n}\n\nfunction confirm() {\n  close(\"confirmed\");\n  emit(\"confirm\");\n}\n\nfunction show() {\n  open.value = true;\n  dialog.value?.showModal();\n}\n\ndefineExpose({\n  close,\n  show,\n});\n</script>\n\n<template>\n  <Teleport to=\"[id='app:dialogs']\">\n    <dialog\n      v-bind=\"$attrs\"\n      ref=\"dialog\"\n      :aria-labelledby=\"`${idPrefix}/title`\"\n      class=\"app-dialog\"\n      @cancel.prevent=\"cancel\"\n    >\n      <header class=\"header\">\n        <strong :id=\"`${idPrefix}/title`\" class=\"title\">\n          <slot name=\"title\">{{ title }}</slot>\n        </strong>\n\n        <AppButton\n          aria-label=\"close\"\n          class=\"close-button\"\n          inline\n          @click=\"cancel\"\n        >\n          <AppIcon icon=\"x-mark\" />\n        </AppButton>\n      </header>\n\n      <div class=\"body\">\n        <slot />\n\n        <form\n          :id=\"`${idPrefix}/form`\"\n          class=\"form\"\n          method=\"dialog\"\n          @submit.prevent=\"confirm\"\n        >\n          <slot name=\"form\" />\n        </form>\n      </div>\n\n      <footer class=\"footer\">\n        <slot name=\"footer\" />\n\n        <div class=\"buttons\">\n          <slot name=\"buttons\" />\n          <AppButton v-if=\"cancelLabel || $slots.cancel\" @click=\"cancel\">\n            <slot name=\"cancel\">{{ cancelLabel }}</slot>\n          </AppButton>\n\n          <AppButton\n            v-if=\"confirmLabel || $slots.confirm\"\n            type=\"submit\"\n            filled\n            :form=\"`${idPrefix}/form`\"\n            :disabled=\"confirmDisabled\"\n          >\n            <slot name=\"confirm\">{{ confirmLabel }}</slot>\n          </AppButton>\n        </div>\n      </footer>\n    </dialog>\n  </Teleport>\n</template>\n\n<style scoped>\n.app-dialog {\n  background: var(--background-strong);\n  border: 2px solid var(--accent-color);\n  border-radius: 1ex;\n  bottom: auto;\n  display: block;\n  font-size: 1rem;\n  inline-size: 60ch;\n  left: 50%;\n  max-block-size: 95vh;\n  max-inline-size: calc(100vw - 1em);\n  overflow: auto;\n  padding: 0;\n  position: fixed;\n  right: auto;\n  scrollbar-color: initial;\n  scrollbar-width: thin;\n  text-align: start;\n  top: 33.3%;\n  transform: translate(-50%, -33.3%);\n}\n\n.app-dialog::backdrop {\n  background: black;\n  opacity: 0.3;\n\n  @media (prefers-color-scheme: dark) {\n    opacity: 0.7;\n  }\n}\n\n.app-dialog:not([open]) {\n  display: none;\n}\n\n.header,\n.body,\n.footer {\n  padding-block: 1.5ex;\n  padding-inline: 1.5rem;\n}\n\n.header {\n  align-items: center;\n  background: var(--accent-color);\n  border-block-end: 2px solid var(--accent-color);\n  color: var(--background-strong);\n  display: flex;\n}\n\n.header .title {\n  font-size: 1.2em;\n}\n\n.header .close-button {\n  align-items: center;\n  color: inherit;\n  display: flex;\n  font-size: 1.2em;\n  inline-size: 1em;\n  justify-content: space-around;\n  margin-inline-start: auto;\n}\n\n.footer {\n  display: flex;\n}\n\n.footer .buttons {\n  column-gap: 1em;\n  display: flex;\n  margin-inline-start: auto;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\";\n\nimport { editDeck } from \"../db/decks.ts\";\nimport { Deck, KanjiInfo } from \"../types.ts\";\nimport AppCheckbox from \"./AppCheckbox.vue\";\n\nconst props = defineProps<{\n  kanji: KanjiInfo;\n  deck: Deck;\n}>();\n\nconst deckHasCard = computed(() =>\n  props.deck.cards.includes(props.kanji.codepoint),\n);\n\nasync function toggleActive() {\n  const { deck } = props;\n  const { cards } = deck;\n  const { codepoint } = props.kanji;\n\n  if (deckHasCard.value) {\n    editDeck({\n      ...deck,\n      cards: cards.filter((other) => other !== codepoint),\n    });\n  } else if (!cards.includes(codepoint)) {\n    editDeck({ ...deck, cards: [...cards, codepoint] });\n  }\n}\n</script>\n\n<template>\n  <AppCheckbox :model-value=\"deckHasCard\" @update:model-value=\"toggleActive\">\n    <template #label>\n      <span class=\"label\" :class=\"{ active: deckHasCard }\">\n        {{ deck.label }}\n      </span>\n    </template>\n  </AppCheckbox>\n</template>\n\n<style scoped>\n.label {\n  font-weight: 400;\n\n  &.active {\n    color: var(--accent-color);\n    font-weight: 600;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed, reactive, ref } from \"vue\";\nimport { pipe } from \"yta\";\nimport { groupBy } from \"yta/sync\";\n\nimport { createDeck } from \"../db/decks.ts\";\nimport { categoryLabel } from \"../helpers/decks.ts\";\nimport { useDecks } from \"../store/decks.ts\";\nimport { KanjiInfo } from \"../types.ts\";\nimport AppButton from \"./AppButton.vue\";\nimport AppDialog from \"./AppDialog.vue\";\nimport AppInput from \"./AppInput.vue\";\nimport AppNumberInput from \"./AppNumberInput.vue\";\nimport KanjiManageDecksDeckItem from \"./KanjiManageDecksDeckItem.vue\";\n\nconst props = defineProps<{\n  kanji: KanjiInfo;\n}>();\n\nconst dialog = ref<InstanceType<typeof AppDialog> | null>(null);\nconst allDecks = useDecks();\nconst createNewExpanded = ref(false);\n\nconst createDeckModel = reactive({\n  label: \"\",\n  priority: 1,\n});\n\nconst categories = computed(() =>\n  pipe(\n    allDecks.value ?? [],\n    groupBy((deck) => deck.category),\n  ),\n);\n\nasync function show() {\n  createNewExpanded.value = false;\n  createDeckModel.label = \"\";\n  createDeckModel.priority = 1;\n\n  dialog.value?.show();\n}\n\nfunction maybeCreateDeck() {\n  if (!createNewExpanded.value) {\n    return;\n  }\n\n  createDeck({\n    label: createDeckModel.label,\n    priority: createDeckModel.priority,\n    cards: [props.kanji.codepoint],\n  });\n}\n\ndefineExpose({\n  show,\n});\n</script>\n\n<template>\n  <AppDialog\n    ref=\"dialog\"\n    :title=\"` ${kanji.literal}: Manage Decks`\"\n    :cancel-label=\"createNewExpanded ? 'Cancel' : null\"\n    :confirm-label=\"createNewExpanded ? 'Cretate Deck' : 'Close'\"\n    @confirm=\"maybeCreateDeck\"\n  >\n    <p>\n      Select a decks to add/remove <strong>{{ kanji.literal }}</strong> to/from.\n    </p>\n\n    <template #form>\n      <ul class=\"list\">\n        <template v-for=\"[category, decks] of categories\" :key=\"category\">\n          <li v-if=\"category !== 'custom'\">\n            <details\n              class=\"category-details\"\n              :open=\"decks.some(({ cards }) => cards.includes(kanji.codepoint))\"\n            >\n              <summary class=\"category-summary\">\n                {{ categoryLabel(category) }}\n              </summary>\n\n              <ul class=\"list\">\n                <li v-for=\"deck of decks\" :key=\"deck.name\">\n                  <KanjiManageDecksDeckItem :kanji=\"kanji\" :deck=\"deck\" />\n                </li>\n              </ul>\n            </details>\n          </li>\n        </template>\n\n        <li v-for=\"deck of categories.get('custom') ?? []\" :key=\"deck.name\">\n          <KanjiManageDecksDeckItem :kanji=\"kanji\" :deck=\"deck\" />\n        </li>\n      </ul>\n\n      <div class=\"create-new-fields\" :class=\"{ expanded: createNewExpanded }\">\n        <AppButton\n          v-if=\"!createNewExpanded\"\n          class=\"create-new-expand-button\"\n          prefix-icon=\"plus\"\n          inline\n          @click=\"createNewExpanded = true\"\n        >\n          Create New\n        </AppButton>\n\n        <template v-else>\n          <AppInput\n            v-model=\"createDeckModel.label\"\n            class=\"name-field\"\n            label=\"Deck Name\"\n            required\n          />\n\n          <AppNumberInput\n            v-model=\"createDeckModel.priority\"\n            class=\"priority-field\"\n            label=\"Priority\"\n            min=\"1\"\n            required\n          />\n        </template>\n      </div>\n    </template>\n  </AppDialog>\n</template>\n\n<style scoped>\n.list {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n\n  .category-details & {\n    border-inline-start: 1px solid var(--accent-color);\n    margin-inline-start: 0.33ch;\n    padding-inline-start: 1em;\n  }\n}\n\n.category-details {\n  margin-block-end: 0.5em;\n\n  & summary {\n    cursor: pointer;\n  }\n}\n\n.create-new-fields {\n  margin-block-start: 1em;\n\n  &.expanded {\n    column-gap: 1ex;\n    display: grid;\n    grid-template-columns: 3fr 1fr;\n\n    @media screen and (max-width: 60ch) {\n      display: flex;\n      flex-direction: column;\n      row-gap: 1ex;\n    }\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { State } from \"ts-fsrs\";\nimport { computed, ref } from \"vue\";\n\nimport { useKanjiProgress } from \"../helpers/fsrs.ts\";\nimport { REVIEW_ROUTE_NAME } from \"../router.ts\";\nimport { useDecksContainingCard } from \"../store/decks.ts\";\nimport { KanjiInfo } from \"../types.ts\";\nimport AppMenu from \"./AppMenu.vue\";\nimport AppMenuItem from \"./AppMenuItem.vue\";\nimport KanjiManageDecksDialog from \"./KanjiManageDecksDialog.vue\";\n\nconst props = defineProps<{\n  kanji: KanjiInfo;\n}>();\n\nconst manageDecksDialog = ref<InstanceType<\n  typeof KanjiManageDecksDialog\n> | null>(null);\n\nconst decks = useDecksContainingCard(() => props.kanji.codepoint);\nconst progress = useKanjiProgress(() => props.kanji.codepoint);\n\nconst isNew = computed(\n  () =>\n    progress.value.read?.fsrs.state === State.New &&\n    progress.value.write?.fsrs.state === State.New,\n);\n</script>\n\n<template>\n  <AppMenu toggle-icon=\"ellipsis-vertical\">\n    <AppMenuItem @click=\"manageDecksDialog?.show()\">\n      <template v-if=\"decks.length === 0\">Add to deck</template>\n      <template v-else>Manage decks</template>\n    </AppMenuItem>\n\n    <AppMenuItem\n      v-if=\"decks.length > 0 && isNew\"\n      :to=\"{\n        name: REVIEW_ROUTE_NAME,\n        query: {\n          kanji: kanji.literal,\n          'card-type': 'kanji-write',\n          singleton: '',\n        },\n      }\"\n      replace\n    >\n      Review now\n    </AppMenuItem>\n\n    <KanjiManageDecksDialog ref=\"manageDecksDialog\" :kanji=\"kanji\" />\n  </AppMenu>\n</template>\n","<script setup lang=\"ts\" Ì£>\nimport { computed } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nimport KanjiComponents from \"../components/KanjiComponents.vue\";\nimport KanjiExploreActions from \"../components/KanjiExploreActions.vue\";\nimport KanjiReadings from \"../components/KanjiReadings.vue\";\nimport KanjiStrokes from \"../components/KanjiStrokes.vue\";\nimport KanjiTitle from \"../components/KanjiTitle.vue\";\nimport KanjiWordList from \"../components/KanjiWordList.vue\";\nimport { useKanji, useKanjiVocab } from \"../helpers/kanji.ts\";\nimport { provideKanjiVG } from \"../helpers/kanjivg.ts\";\n\nconst route = useRoute();\nconst codepoint = computed(() => {\n  const value = route.params.kanji;\n\n  if (typeof value !== \"string\" || [...value].length !== 1) {\n    return null;\n  }\n\n  return value.codePointAt(0) ?? null;\n});\n\nconst hex = computed(() => {\n  return codepoint.value?.toString(16).padStart(5, \"0\") ?? null;\n});\n\nconst kanji = useKanji(codepoint);\nconst kanjiVocab = useKanjiVocab(codepoint);\nprovideKanjiVG(hex);\n</script>\n\n<template>\n  <article v-if=\"kanji\" class=\"kanji-card\">\n    <KanjiTitle class=\"title\" :kanji=\"kanji\">\n      <template #actions>\n        <KanjiExploreActions :kanji=\"kanji\" />\n      </template>\n    </KanjiTitle>\n\n    <KanjiReadings class=\"readings\" :kanji=\"kanji\" />\n    <KanjiStrokes class=\"strokes\" :kanji=\"kanji\" />\n    <KanjiComponents class=\"components\" />\n    <KanjiWordList v-if=\"kanjiVocab\" class=\"words\" :kanji-vocab=\"kanjiVocab\" />\n  </article>\n</template>\n"],"names":["MENU_INJECTION_KEY","createMenu","ref","provideMenu","menu","provide","useMenu","inject","props","__props","emit","__emit","toggleButton","popoverEl","menuEl","id","useId","anchorName","close","handleFocusout","event","handleToggle","handleBeforeToggle","togglerBox","style","watch","open","_createElementBlock","_cache","$event","_createElementVNode","_unref","$slots","disabled","_renderSlot","_ctx","toggleIcon","_createBlock","AppIcon","_hoisted_3","handleClick","_openBlock","_hoisted_1","_createVNode","AppButton","prefixIcon","to","replace","_hoisted_2","dialog","idPrefix","returnValue","cancel","confirm","show","__expose","_Teleport","_mergeProps","title","_hoisted_4","_hoisted_6","_hoisted_7","cancelLabel","confirmLabel","confirmDisabled","deckHasCard","computed","toggleActive","deck","cards","codepoint","editDeck","other","AppCheckbox","_normalizeClass","allDecks","useDecks","createNewExpanded","createDeckModel","reactive","categories","pipe","groupBy","maybeCreateDeck","createDeck","AppDialog","kanji","_Fragment","_renderList","category","decks","_toDisplayString","categoryLabel","_hoisted_5","KanjiManageDecksDeckItem","AppInput","AppNumberInput","manageDecksDialog","useDecksContainingCard","progress","useKanjiProgress","isNew","State","AppMenu","AppMenuItem","REVIEW_ROUTE_NAME","KanjiManageDecksDialog","route","useRoute","value","hex","useKanji","kanjiVocab","useKanjiVocab","provideKanjiVG","KanjiTitle","KanjiExploreActions","KanjiReadings","KanjiStrokes","KanjiComponents","KanjiWordList"],"mappings":"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"}