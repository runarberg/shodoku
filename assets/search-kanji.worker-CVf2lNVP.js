(function(){"use strict";const S=new RegExp("\\p{Script=Han}","u"),m=/[\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Han}\u{2e80}-\u{2fd5}\u{3000}-\u{303f}\u{31f0}-\u{31ff}\u{3220}-\u{3243}\u{3280}-\u{337f}\u{ff5f}-\u{ff9f}\u{ff01}-\u{ff5e}]/u;function h(n){return m.test(n)}function R(n){return S.test(n)}const E=new RegExp("\\p{Script=Hiragana}","gu");function K(n){return n.replaceAll(E,t=>String.fromCodePoint((t.codePointAt(0)??0)+96))}const P=6,u="␟",d="␞",j="␝",w=fetch("/data/index/kanji-v1.usv").then(n=>n.text());async function g(n){const t=await w,o=[];let e=0,l=0,f=0,k=0,c=null;for(const p of t){const r=p.length;if(p===u){if(!c){let a,i,s;n.hiragana&&l===1?(a=t.slice(f+r,e),i=a.replaceAll(".",""),s=n.hiragana):n.katakana&&l===2?(a=t.slice(f+r,e),i=a,s=n.katakana):n.en&&l===3&&(a=t.slice(f+r,e),i=a.toLowerCase(),s=n.en),s&&a&&(i!=null&&i.includes(s))&&(c=a)}f=e}else if(p===d)l+=1,f=e;else if(p===j){if(c){const a=t.slice(k+r,e).trim(),[i,s,C,H]=a.split(`${u}${d}`),I=i.codePointAt(0)??-1;if(o.push({id:I,match:c,kunYomi:s.split(u),onYomi:C.split(u),meanings:H.split(u)}),c=null,o.length===P)break}l=0,f=e,k=e}e+=r}return o}addEventListener("message",async n=>{const{data:t}=n;if(R(t))return[];let o;h(t)?o=await g({hiragana:t,katakana:K(t)}):o=await g({en:t.toLowerCase()}),self.postMessage(o)})})();
