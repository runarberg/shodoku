{"version":3,"file":"WordListItem-CxTWrGoe.js","sources":["../../src/components/VocabularyWord.vue","../../src/components/WordListItem.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, ref, watch } from \"vue\";\n\nimport { hasKanjiRE } from \"../helpers/text.ts\";\nimport { useWordFurigana } from \"../helpers/words.ts\";\nimport { wordRoute } from \"../router.ts\";\nimport { Furigana, Word } from \"../types.ts\";\nimport VocabularyWordFurigana from \"./VocabularyWordFurigana.vue\";\nimport VocabularyWordMeaning from \"./VocabularyWordMeaning.vue\";\nimport WordWritingSelect from \"./WordWritingSelect.vue\";\n\nconst props = withDefaults(\n  defineProps<{\n    word: Word;\n    kanji?: string | null;\n    hideKanji?: boolean;\n    hideReading?: boolean;\n    hideMeaning?: boolean;\n  }>(),\n  {\n    kanji: null,\n    hideKanji: false,\n    hideReading: false,\n    hideMeaning: false,\n  },\n);\n\nconst meanings = computed(() => {\n  const { kanji, word } = props;\n\n  if (!word.meanings) {\n    return [];\n  }\n\n  if (!kanji) {\n    return word.meanings;\n  }\n\n  return word.meanings.filter((meaning) => {\n    if (\n      meaning.info &&\n      meaning.info.startsWith(\"esp. \") &&\n      hasKanjiRE.test(meaning.info)\n    ) {\n      return meaning.info.includes(kanji);\n    }\n\n    if (!meaning.useWithWriting) {\n      return true;\n    }\n\n    return meaning.useWithWriting.some((writing) => writing.includes(kanji));\n  });\n});\n\nconst furigana = useWordFurigana(() => props.word, {\n  kanji: () => props.kanji,\n  // writing practice, prevent hiding furigana for proficient reading.\n  forceReading: () => props.hideKanji,\n});\n\nconst meaning = computed(() => meanings.value.at(0));\nconst selectedFurigana = ref<Furigana | string | null>(null);\n\nconst additionalMeanings = computed(() => meanings.value.slice(1));\n\nwatch(\n  () => props.word.id,\n  (newId, oldId) => {\n    if (newId !== oldId) {\n      selectedFurigana.value = null;\n    }\n  },\n);\n</script>\n\n<template>\n  <div class=\"vocabulary-word\">\n    <p class=\"word\" lang=\"ja\">\n      <RouterLink :to=\"wordRoute(word.id)\" class=\"word-link\">\n        <template v-if=\"typeof selectedFurigana === 'string'\">\n          {{ selectedFurigana }}\n        </template>\n\n        <VocabularyWordFurigana\n          v-else\n          :furigana=\"selectedFurigana || furigana\"\n          :hide-kanji=\"hideKanji\"\n          :hide-reading=\"hideReading\"\n          :kanji=\"kanji\"\n        />\n      </RouterLink>\n    </p>\n\n    <div v-show=\"!hideMeaning\" class=\"meaning\">\n      <VocabularyWordMeaning v-if=\"meaning\" :meaning=\"meaning\" />\n\n      <details\n        v-if=\"additionalMeanings.length > 0\"\n        class=\"additional-meanings-details\"\n      >\n        <summary>{{ additionalMeanings.length }} more</summary>\n\n        <ul class=\"additional-meanings\">\n          <li\n            v-for=\"(additionalMeaning, i) of additionalMeanings\"\n            :key=\"i\"\n            class=\"additional-meaning-item\"\n          >\n            <VocabularyWordMeaning :meaning=\"additionalMeaning\" />\n          </li>\n        </ul>\n      </details>\n    </div>\n\n    <div class=\"actions\">\n      <WordWritingSelect\n        v-if=\"!hideKanji && !hideReading\"\n        v-model=\"selectedFurigana\"\n        :word=\"word\"\n        :default-furigana=\"furigana\"\n      />\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.vocabulary-word {\n  column-gap: 1em;\n  display: grid;\n  grid-template:\n    \"word meaning actions\"\n    / fit-content(50%) 1fr auto;\n\n  @media screen and (max-width: 60ch) {\n    column-gap: 0.5ex;\n    grid-template:\n      \"word actions\"\n      \"meaning meaning\"\n      / 1fr auto;\n  }\n}\n\n.word {\n  font-size: 2em;\n  grid-area: word;\n  margin: 0;\n  max-inline-size: 75vw;\n}\n\n.word-link {\n  color: inherit;\n  text-decoration: none;\n}\n\n.meaning {\n  grid-area: meaning;\n}\n\n.actions {\n  grid-area: actions;\n}\n\n.additional-meanings-details summary {\n  color: var(--text-light);\n  cursor: pointer;\n  inline-size: max-content;\n}\n\n.additional-meanings {\n  list-style: none;\n  padding-inline: 1ex;\n  margin-inline: 1ex;\n}\n\n.additional-meaning-item:not(:first-child) {\n  margin-block-start: 1ex;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { useWord, useWordSetenceIds } from \"../helpers/words.ts\";\nimport BookmarkWordButton from \"./BookmarkWordButton.vue\";\nimport VocabularySentence from \"./VocabularySentence.vue\";\nimport VocabularyWord from \"./VocabularyWord.vue\";\n\nconst props = defineProps<{\n  word: number;\n  kanji?: string;\n  hideKanji?: boolean;\n  hideReading?: boolean;\n  hideMeaning?: boolean;\n}>();\n\nconst wordInfo = useWord(() => props.word);\nconst sentences = useWordSetenceIds(() => props.word);\n</script>\n\n<template>\n  <article class=\"word-list-item\">\n    <aside class=\"bullet\">\n      <BookmarkWordButton\n        :word-id=\"word\"\n        :reading=\"wordInfo?.readings?.at(0)?.text\"\n        class=\"bookmark-button\"\n      />\n    </aside>\n\n    <VocabularyWord\n      v-if=\"wordInfo\"\n      :word=\"wordInfo\"\n      :kanji=\"kanji\"\n      :hide-kanji=\"hideKanji\"\n      :hide-reading=\"hideReading\"\n      :hide-meaning=\"hideMeaning\"\n      class=\"word-section\"\n    />\n\n    <section v-if=\"sentences\" aria-label=\"Sentences\" class=\"sentences-section\">\n      <ul class=\"sentences\">\n        <li v-for=\"sentence of sentences\" :key=\"sentence\" class=\"sentence-item\">\n          <VocabularySentence\n            :sentence-id=\"sentence\"\n            :hide-kanji=\"hideKanji ? kanji : null\"\n            :hide-reading=\"hideReading ? kanji : null\"\n            :hide-meaning=\"hideMeaning\"\n          />\n        </li>\n      </ul>\n    </section>\n  </article>\n</template>\n\n<style scoped>\n.word-list-item {\n  display: grid;\n  grid-template:\n    \"bullet . word\"\n    \".      . sentences\"\n    / auto 0.5ex 1fr;\n  margin-block-start: 2em;\n  justify-content: start;\n\n  & .bullet {\n    display: flex;\n    grid-area: bullet;\n    flex-direction: column;\n  }\n\n  & .word-section {\n    grid-area: word;\n  }\n\n  & .sentences-section {\n    grid-area: sentences;\n  }\n}\n\n.bookmark-button {\n  margin-block-start: 0.9ex;\n\n  .word-list-item:has(.word-section ruby rt) & {\n    margin-block-start: 0.9em;\n  }\n}\n\n.sentences {\n  border-inline-start: 2px solid\n    light-dark(var(--light-gray), var(--medium-gray));\n  grid-area: sentences;\n  list-style: none;\n  padding-inline: 1ex;\n}\n\n.sentence-item {\n  margin-block: 1em;\n\n  &:first-child {\n    margin-block-start: 1ex;\n  }\n\n  &:last-child {\n    margin-block-end: 1ex;\n  }\n}\n</style>\n"],"names":["props","__props","meanings","computed","kanji","word","meaning","hasKanjiRE","writing","furigana","useWordFurigana","selectedFurigana","ref","additionalMeanings","watch","newId","oldId","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_RouterLink","_unref","wordRoute","_Fragment","_createBlock","VocabularyWordFurigana","hideKanji","hideReading","_withDirectives","_hoisted_3","VocabularyWordMeaning","_hoisted_4","_toDisplayString","_hoisted_5","_renderList","additionalMeaning","i","hideMeaning","_hoisted_6","WordWritingSelect","$event","wordInfo","useWord","sentences","useWordSetenceIds","BookmarkWordButton","VocabularyWord","sentence","VocabularySentence"],"mappings":"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"}