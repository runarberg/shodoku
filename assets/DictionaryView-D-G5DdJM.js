import{d as w,m as y,a as o,e as f,I as E,g as M,F as _,l as g,b as k,u,h as W,o as a,_ as b,P as N,y as q,S as K,Q as T,w as P,A as z,L as D,t as h,G as U,B,c as $,v as F,T as H,i as x,k as O,n as Y,H as G,U as Q}from"./index-gkm2TMQe.js";import{v as Z}from"./index-urjZb-CP.js";import{c as J,h as C,i as X,d as R}from"./index-CbYumIFw.js";import{d as ee}from"./db-DOZG9NOu.js";import{W as se}from"./WordListItem-CTik2-3f.js";import{w as A}from"./index-EEqkjwK5.js";import{W as V}from"./WordKanjiListItem-C7T2TlVk.js";import{a as te,B as ae,_ as ne,c as re}from"./WordWritingSelect-CTMgAR99.js";import"./kanji-J44TzOjd.js";import"./fsrs-CmfFmnHz.js";import"./reviews-D84XVVKd.js";const oe={class:"word-search-results"},ie={class:"results-list"},le=w({__name:"BookmarkedWords",setup(c){const r=J(async()=>{const t=[],e=(await ee).transaction("bookmarked-words").store.index("bookmarkedAt").iterate(null,"prev");for await(const l of e)t.push(l.primaryKey);return t},[]),s=y(20);function i(){s.value+=20}function n([{isIntersecting:t}]){t&&i()}return(t,e)=>(a(),o("section",oe,[e[2]||(e[2]=f("h3",null,"Bookmarked Words",-1)),f("ul",ie,[(a(!0),o(_,null,g(u(r).slice(0,s.value),l=>(a(),o("li",{key:l},[k(se,{word:l},null,8,["word"])]))),128))]),s.value<u(r).length?E((a(),o("button",{key:0,class:"next-page-button",onClick:e[0]||(e[0]=l=>i())},e[1]||(e[1]=[W(" Load More ")]))),[[u(Z),n]]):M("",!0)]))}}),ce=b(le,[["__scopeId","data-v-8a1217ab"]]);function ue(c){return new Worker("/assets/component-picker.worker-Cj-YfB_s.js",{name:c?.name})}const S=new ue;function de(){const c=y(new Map),r=y(new Set),s=y(new Map),i=N(new Set);function n(t){t.data.type==="all-radicals"?c.value=t.data.allRadicals:t.data.type==="kanji-selection"&&(s.value=t.data.kanjiSelection,r.value=t.data.filteredRadicals)}return S.addEventListener("message",n),S.postMessage("init"),K(()=>{S.removeEventListener("message",n)}),q(i,()=>{if(i.size===0){r.value=new Set,s.value=new Map;return}S.postMessage(T(i))}),{allRadicals:c,filteredRadicals:r,selectedRadicals:i,kanjiSelection:s}}const pe={class:"component-picker"},me={key:0,class:"empty-message"},fe={key:1,class:"list kanji-list"},_e=["aria-labelledby"],ke=["id"],ve={class:"list kanji-literal-list"},ge=["onClick"],he={class:"list radical-list"},ye=["aria-labelledby"],we=["id"],be={class:"list radical-literal-list"},je=["aria-pressed","disabled","onClick"],$e=w({__name:"ComponentPicker",emits:["select"],setup(c){const{allRadicals:r,filteredRadicals:s,kanjiSelection:i,selectedRadicals:n}=de(),t=D();function e(l){n.has(l)?n.delete(l):n.add(l)}return(l,p)=>(a(),o("div",pe,[u(n).size===0?(a(),o("p",me," Select one or more components below. Pick any of the resulting kanji. ")):(a(),o("ol",fe,[(a(!0),o(_,null,g(u(i),([d,v])=>(a(),o("li",{key:d,"aria-labelledby":`${u(t)}/kanji-list/${d}`,class:"kanji-list-item"},[f("strong",{id:`${u(t)}/kanji-list/${d}`,class:"stroke-count-label"},h(d),9,ke),f("ol",ve,[(a(!0),o(_,null,g(v,m=>(a(),o("li",{key:m,class:"kanji-literal-list-item"},[f("button",{class:"kanji-select-button",onClick:j=>l.$emit("select",m)},h(m),9,ge)]))),128))])],8,_e))),128))])),f("ol",he,[(a(!0),o(_,null,g(u(r),([d,v])=>(a(),o("li",{key:d,"aria-labelledby":`${u(t)}/radical-list/${d}`,class:"radical-list-item"},[f("strong",{id:`${u(t)}/radical-list/${d}`,class:"stroke-count-label"},h(d),9,we),f("ol",be,[(a(!0),o(_,null,g(v,m=>(a(),o("li",{key:m,class:"radical-literal-list-item"},[f("button",{class:"radical-toggle-button","aria-pressed":u(n).has(m),disabled:u(s).size>0&&!u(s).has(m),onClick:j=>e(m)},h(m),9,je)]))),128))])],8,ye))),128))]),k(z,{class:"clear-button",inline:"",disabled:u(n).size===0,onClick:p[0]||(p[0]=d=>u(n).clear())},{default:P(()=>p[1]||(p[1]=[W(" Clear ")])),_:1,__:[1]},8,["disabled"])]))}}),We=b($e,[["__scopeId","data-v-c1903d8c"]]);function Re(c){return new Worker("/assets/search-kanji.worker-DUz-mWlb.js",{name:c?.name})}function Se(c){return new Worker("/assets/search-words.worker-BKHYCkZA.js",{name:c?.name})}const I=new Re,L=new Se;function xe(c){const r=U([]);A(()=>B(c),async i=>{r.splice(0,r.length),i.length>0&&L.postMessage(i)},{debounce:300,immediate:!0});function s(i){const n=i.data;n.phrase===B(c)&&r.push(n)}return L.addEventListener("message",s),K(()=>{L.removeEventListener("message",s)}),r}function Ie(c){const r=y([]);A(()=>B(c),async i=>{i.length===0||C(i)?r.value=[]:I.postMessage(i)},{debounce:300,immediate:!0});function s(i){r.value=i.data}return I.addEventListener("message",s),K(()=>{I.removeEventListener("message",s)}),r}const Le={key:0,class:"kanji-search-results"},Be={key:0,class:"results-list"},Ce={key:1,class:"results-list"},Me=w({__name:"KanjiSearchResults",props:{phrase:{}},setup(c){const r=c,s=$(()=>{const n=new Set;for(const t of r.phrase)X(t)&&n.add(t);return n}),i=Ie(()=>r.phrase);return(n,t)=>s.value.size>0||u(i).length>0?(a(),o("section",Le,[t[0]||(t[0]=f("h3",null,"Kanji",-1)),s.value.size>0?(a(),o("ul",Be,[(a(!0),o(_,null,g(s.value,e=>(a(),o("li",{key:e},[k(V,{kanji:e},null,8,["kanji"])]))),128))])):(a(),o("ul",Ce,[(a(!0),o(_,null,g(u(i),e=>(a(),o("li",{key:e.id},[k(V,{kanji:String.fromCodePoint(e.id)},null,8,["kanji"])]))),128))]))])):M("",!0)}}),Ke=b(Me,[["__scopeId","data-v-63c8daff"]]),Pe={class:"word-search-result-item"},Ve={class:"meaning"},Ee=w({__name:"WordSearchResultItem",props:{result:{}},setup(c){const r=c,s=te(()=>r.result.id),i=$(()=>s.value?s.value.readings?.at(0)?.text:r.result.readings.at(0)),n=$(()=>{const{match:e,readings:l,writings:p}=r.result;if(s.value){let m;return C(e)?m=s.value.furigana?.find(j=>j.writing===e):R(e)&&(m=s.value.furigana?.find(j=>j.reading===e)),m||(m=s.value.furigana?.at(0)),m?m.furigana:s.value.writings?.at(0)?.text??s.value.readings?.at(0)?.text??e}if(C(e))return[{ruby:e,rt:l.at(0)}];const[d]=p;if(R(e))return d?[{ruby:d,rt:e}]:e;const[v]=l;return d&&v?[{ruby:v,rt:v}]:d??v??e}),t=$(()=>{const{match:e,glossary:l}=r.result;if(s.value){if(R(e))return s.value.meanings?.at(0)??l.at(0)??e;const p=s.value.meanings?.find(d=>d.glossary?.includes(e));if(p)return p}return R(e)?l.at(0)??e:e});return(e,l)=>{const p=F("RouterLink");return a(),o("div",Pe,[k(ae,{"word-id":e.result.id,reading:i.value,class:"bookmark-button"},null,8,["word-id","reading"]),k(p,{to:u(H)(e.result.id),class:"word"},{default:P(()=>[typeof n.value=="string"?(a(),o(_,{key:0},[W(h(n.value),1)],64)):(a(),x(ne,{key:1,furigana:n.value},null,8,["furigana"]))]),_:1},8,["to"]),f("div",Ve,[typeof t.value=="string"?(a(),o(_,{key:0},[W(h(t.value),1)],64)):(a(),x(re,{key:1,meaning:t.value},null,8,["meaning"]))])])}}}),ze=b(Ee,[["__scopeId","data-v-3a6c2f15"]]),De={class:"word-search-results"},Ae={class:"results-list"},Ne=w({__name:"WordSearchResults",props:{phrase:{}},setup(c){const r=c,s=xe(()=>r.phrase);return(i,n)=>(a(),o("section",De,[n[0]||(n[0]=f("h3",null,"Words",-1)),f("ul",Ae,[(a(!0),o(_,null,g(u(s),t=>(a(),o("li",{key:t.id},[k(ze,{result:t},null,8,["result"])]))),128))])]))}}),qe=b(Ne,[["__scopeId","data-v-884f1e39"]]),Te={class:"search-field"},Ue={class:"label"},Fe=w({__name:"DictionaryView",setup(c){const r=Y(),s=O(),i=D(),n=y(!1),t=$({get(){return typeof r.query.search!="string"?"":r.query.search},set(e){s.replace({query:{search:e||void 0}})}});return(e,l)=>(a(),o(_,null,[f("div",Te,[f("label",Ue,[k(G,{icon:"search",class:"icon"})]),E(f("input",{"onUpdate:modelValue":l[0]||(l[0]=p=>t.value=p),type:"search","aria-label":"search",placeholder:"Search for words, kanji, meanings, etc."},null,512),[[Q,t.value]]),k(z,{filled:n.value,"aria-pressed":n.value,"aria-controls":u(i),"aria-label":"Component Picker",onClick:l[1]||(l[1]=p=>n.value=!n.value)},{default:P(()=>l[3]||(l[3]=[W(" éƒ¨ ")])),_:1,__:[3]},8,["filled","aria-pressed","aria-controls"])]),n.value?(a(),x(We,{key:0,id:u(i),onSelect:l[2]||(l[2]=p=>t.value+=p)},null,8,["id"])):M("",!0),t.value?(a(),o(_,{key:1},[k(Ke,{class:"kanji-results",phrase:t.value},null,8,["phrase"]),k(qe,{class:"word-results",phrase:t.value},null,8,["phrase"])],64)):(a(),x(ce,{key:2,class:"bookmark-results"}))],64))}}),as=b(Fe,[["__scopeId","data-v-4612ade5"]]);export{as as default};
