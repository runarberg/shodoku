import{l as w,m as W,v as m,g as b,d as L,i as B,w as N,u as y,o as t,f as S,_ as V,j as H,c as a,h as I,F as r,a as o,t as j,k as P,b as l,H as D,Q,C as Y,D as z,e as K,R as U,S as J}from"./index-uL2dLKam.js";import{u as X,d as C,l as Z,A as h}from"./db-ywXYyXbd.js";import{A as x}from"./AppButton-niJYO7_s.js";function Nn(d){const e=w(null);return W(()=>m(d),async n=>{if(!n){e.value=null;return}const i=n.toString(16).padStart(5,"0"),u=await(await fetch(`/data/kanji-v1/${i}.json`)).json();e.value=u},{immediate:!0}),e}function Tn(d){const e=w(null);return W(()=>m(d),async n=>{if(!n){e.value=null;return}const i=n.toString(16).padStart(5,"0"),u=await(await fetch(`/data/kanji-vocab-v1/${i}.json`)).json();e.value=u},{immediate:!0}),e}function En(d){const e=w(null);return W(()=>m(d),async n=>{if(!n){e.value=null;return}const s=await(await fetch(`/data/words-v1/${n}.json`)).json();e.value=s},{immediate:!0}),e}function Fn(d){const e=w([]);return W(()=>m(d),async n=>{if(!n){e.value=[];return}const s=await(await fetch(`/data/words-sentences-v1/${n}.json`)).json();e.value=s},{immediate:!0}),e}function c(d,e={}){return b(()=>{var u,v;const n=m(e.kanji),{writings:i}=m(d)??{};if(!i)return null;let s=null;for(const f of i){if(!s){s=f;continue}n&&!f.text.includes(n)||(u=f.priority)!=null&&u.freq&&f.priority.freq<(((v=s.priority)==null?void 0:v.freq)??Number.POSITIVE_INFINITY)&&(s=f)}return s==null?void 0:s.text})}function _(d){return b(()=>{var i,s;const{readings:e}=m(d)??{};if(!e)return null;let n=null;for(const u of e){if(!n){n=u;continue}(i=u.priority)!=null&&i.freq&&u.priority.freq<(((s=n.priority)==null?void 0:s.freq)??Number.POSITIVE_INFINITY)&&(n=u)}return n==null?void 0:n.text})}function Mn(d,e={}){const n=c(d,e),i=_(d);return b(()=>{const{furigana:s}=m(d)??{};let u;return!i.value||!n.value?u=s==null?void 0:s.at(0):u=s==null?void 0:s.find(v=>v.writing===n.value&&v.reading===i.value),u||(u=s==null?void 0:s.at(0)),(u==null?void 0:u.furigana)??[{ruby:n.value??i.value??""}]})}const nn=L({__name:"BookmarkWordButton",props:{wordId:{}},setup(d){const e=d,{result:n}=X(b(()=>{const s=e.wordId;return async()=>await(await C).count("bookmarked-words",s)>0}));async function i(){n.value?(await C).delete("bookmarked-words",e.wordId):(await C).add("bookmarked-words",{wordId:e.wordId}),Z.postMessage("word-bookmarked")}return(s,u)=>(t(),B(x,{"aria-pressed":y(n),class:"bookmark-button",onClick:u[0]||(u[0]=v=>i())},{default:N(()=>[S(h,{icon:y(n)?"star-filled":"star"},null,8,["icon"])]),_:1},8,["aria-pressed"]))}}),On=V(nn,[["__scopeId","data-v-6b7641f2"]]);function en(d){const e=w(null);return W(()=>m(d),async n=>{const s=await(await fetch(`/data/sentences-v1/${n}.json`)).json();e.value=s},{immediate:!0}),e}const qn=new RegExp("\\p{Script=Han}","u"),tn=new RegExp("^\\p{Script=Han}$","u");function an(d){return tn.test(d)}const on={key:0,class:"placeholder"},rn=L({__name:"MaybeHideKanji",props:{str:{},kanji:{default:null},hide:{type:Boolean,default:!1},link:{type:Boolean,default:!1}},setup(d){return(e,n)=>{const i=H("RouterLink");return e.link?(t(!0),a(r,{key:0},I(e.str,s=>(t(),a(r,null,[y(an)(s)?(t(),B(i,{key:0,to:y(P)(s),class:"link"},{default:N(()=>[o(j(s),1)]),_:2},1032,["to"])):(t(),a(r,{key:1},[o(j(s),1)],64))],64))),256)):!e.kanji||!e.hide?(t(),a(r,{key:1},[o(j(e.str),1)],64)):(t(!0),a(r,{key:2},I(e.str,s=>(t(),a(r,null,[s===e.kanji?(t(),a("span",on,"◌")):(t(),a(r,{key:1},[o(j(s),1)],64))],64))),256))}}}),F=V(rn,[["__scopeId","data-v-46882cf0"]]),sn={key:0},ln={key:0},un={key:1},G=L({__name:"VocabularyWordFurigana",props:{furigana:{},kanji:{},hideKanji:{type:Boolean},hideReading:{type:Boolean},linkKanji:{type:Boolean}},setup(d){const e=d;function n(i){return!e.hideReading||!e.kanji?!1:i.includes(e.kanji)}return(i,s)=>(t(!0),a(r,null,I(i.furigana,({ruby:u,rt:v})=>(t(),a(r,null,[v?(t(),a("ruby",sn,[S(F,{hide:i.hideKanji,kanji:i.kanji,str:u,link:i.linkKanji},null,8,["hide","kanji","str","link"]),s[0]||(s[0]=l("rp",null,"(",-1)),n(u)?(t(),a("rt",ln,"◌")):(t(),a("rt",un,j(v),1)),s[1]||(s[1]=l("rp",null,")",-1))])):(t(),B(F,{key:1,hide:i.hideKanji,kanji:i.kanji,str:u,link:i.linkKanji},null,8,["hide","kanji","str","link"]))],64))),256))}}),dn={key:0},gn={lang:"ja",class:"sentence"},pn=L({__name:"VocabularySentence",props:{sentenceId:{},hideKanji:{},hideReading:{},hideMeaning:{type:Boolean}},setup(d){const e=d,n=en(()=>e.sentenceId);return(i,s)=>y(n)?(t(),a("div",dn,[l("p",gn,[(t(!0),a(r,null,I(y(n).words,u=>(t(),B(Q(u.word?"RouterLink":"span"),{key:u.word,to:y(D)(u.word),class:"word"},{default:N(()=>[S(G,{furigana:u.furigana,"hide-kanji":!!i.hideKanji,"hide-reading":!!i.hideReading,kanji:i.hideKanji??i.hideReading},null,8,["furigana","hide-kanji","hide-reading","kanji"])]),_:2},1032,["to"]))),128))]),Y(l("p",{lang:"en",class:"translation"},j(y(n).meaning),513),[[z,!i.hideMeaning]])])):K("",!0)}}),An=V(pn,[["__scopeId","data-v-743b6622"]]),kn={class:"pos-tag"},vn=L({__name:"PartOfSpeechTag",props:{tag:{}},setup(d){return(e,n)=>(t(),a("span",kn,[e.tag==="adj-f"?(t(),a(r,{key:0},[o(" noun or prenominal verb")],64)):e.tag==="adj-i"?(t(),a(r,{key:1},[n[0]||(n[0]=l("i",{lang:"ja-Latn"},"i",-1)),n[1]||(n[1]=o(" adjective"))],64)):e.tag==="adj-ix"?(t(),a(r,{key:2},[n[2]||(n[2]=o(" adjective – ")),n[3]||(n[3]=l("i",{lang:"ja-Latn"},"yoi",-1)),n[4]||(n[4]=o("/")),n[5]||(n[5]=l("i",{lang:"ja-Latn"},"ii",-1)),n[6]||(n[6]=o(" class"))],64)):e.tag==="adj-na"?(t(),a(r,{key:3},[o(" na adjective")],64)):e.tag==="adj-nari"?(t(),a(r,{key:4},[n[7]||(n[7]=o(" formal ")),n[8]||(n[8]=l("i",{lang:"ja-Latn"},"na",-1)),n[9]||(n[9]=o("-adjective"))],64)):e.tag==="adj-no"?(t(),a(r,{key:5},[n[10]||(n[10]=o(" noun w. ")),n[11]||(n[11]=l("i",null,"no",-1)),n[12]||(n[12]=o(" particle"))],64)):e.tag==="adj-pn"?(t(),a(r,{key:6},[o(" pre-noun adjectival")],64)):e.tag==="adj-t"?(t(),a(r,{key:7},[n[13]||(n[13]=l("i",{lang:"ja-Latn"},"taru",-1)),n[14]||(n[14]=o(" adjective"))],64)):e.tag==="adv"?(t(),a(r,{key:8},[o(" adverb")],64)):e.tag==="adv-to"?(t(),a(r,{key:9},[n[15]||(n[15]=o(" adverb w. ")),n[16]||(n[16]=l("i",{lang:"ja-Latn"},"to",-1)),n[17]||(n[17]=o(" particle"))],64)):e.tag==="aux"?(t(),a(r,{key:10},[o(" auxiliary")],64)):e.tag==="aux-adj"?(t(),a(r,{key:11},[o(" auxiliary adjective")],64)):e.tag==="aux-v"?(t(),a(r,{key:12},[o(" auxiliary verb")],64)):e.tag==="conj"?(t(),a(r,{key:13},[o(" conjunction")],64)):e.tag==="cop"?(t(),a(r,{key:14},[o(" copula")],64)):e.tag==="ctr"?(t(),a(r,{key:15},[o(" counter")],64)):e.tag==="exp"?(t(),a(r,{key:16},[o(" expressions")],64)):e.tag==="int"?(t(),a(r,{key:17},[o(" interjection")],64)):e.tag==="n"?(t(),a(r,{key:18},[o(" noun")],64)):e.tag==="n-adv"?(t(),a(r,{key:19},[o(" adverbial noun")],64)):e.tag==="n-pr"?(t(),a(r,{key:20},[o(" proper noun")],64)):e.tag==="n-pref"?(t(),a(r,{key:21},[o(" noun, used as a prefix")],64)):e.tag==="n-suf"?(t(),a(r,{key:22},[o(" noun, used as a suffix")],64)):e.tag==="n-t"?(t(),a(r,{key:23},[o(" noun (temporal)")],64)):e.tag==="num"?(t(),a(r,{key:24},[o(" numeric")],64)):e.tag==="pn"?(t(),a(r,{key:25},[o(" pronoun")],64)):e.tag==="pref"?(t(),a(r,{key:26},[o(" prefix")],64)):e.tag==="prt"?(t(),a(r,{key:27},[o(" particle")],64)):e.tag==="suf"?(t(),a(r,{key:28},[o(" suffix")],64)):e.tag==="uk"?(t(),a(r,{key:29},[o(" Usually written with kana")],64)):e.tag==="v-unspec"?(t(),a(r,{key:30},[o(" verb")],64)):e.tag==="v1"?(t(),a(r,{key:31},[o(" Ichidan verb")],64)):e.tag==="v1-s"?(t(),a(r,{key:32},[n[18]||(n[18]=o(" Ichidan verb – ")),n[19]||(n[19]=l("i",{lang:"ja-Latn"},"kureru",-1))],64)):e.tag==="v5aru"?(t(),a(r,{key:33},[n[20]||(n[20]=o(" Godan verb – ")),n[21]||(n[21]=l("i",{lang:"ja-Latn"},"-aru",-1))],64)):e.tag==="v5b"?(t(),a(r,{key:34},[o(" Godan verb")],64)):e.tag==="v5g"?(t(),a(r,{key:35},[o(" Godan verb")],64)):e.tag==="v5k"?(t(),a(r,{key:36},[o(" Godan verb")],64)):e.tag==="v5k-s"?(t(),a(r,{key:37},[n[22]||(n[22]=o(" Godan verb – ")),n[23]||(n[23]=l("i",{lang:"ja-Latn"},"iku",-1)),n[24]||(n[24]=o("/")),n[25]||(n[25]=l("i",{lang:"ja-Latn"},"yuku",-1))],64)):e.tag==="v5m"?(t(),a(r,{key:38},[o(" Godan verb")],64)):e.tag==="v5n"?(t(),a(r,{key:39},[o(" Godan verb")],64)):e.tag==="v5r"?(t(),a(r,{key:40},[n[26]||(n[26]=o(" Godan verb with ")),n[27]||(n[27]=l("i",{lang:"ja-Latn"},"ru",-1)),n[28]||(n[28]=o(" ending"))],64)):e.tag==="v5r-i"?(t(),a(r,{key:41},[n[29]||(n[29]=o(" Godan verb with ")),n[30]||(n[30]=l("i",{lang:"ja-Latn"},"ru",-1)),n[31]||(n[31]=o(" ending (irregular)"))],64)):e.tag==="v5s"?(t(),a(r,{key:42},[o(" Godan verb")],64)):e.tag==="v5t"?(t(),a(r,{key:43},[o(" Godan verb")],64)):e.tag==="v5u"?(t(),a(r,{key:44},[o(" Godan verb")],64)):e.tag==="v5u-s"?(t(),a(r,{key:45},[n[32]||(n[32]=o(" Godan verb with ")),n[33]||(n[33]=l("i",{lang:"ja-Latn"},"u",-1)),n[34]||(n[34]=o(" ending (special class)"))],64)):e.tag==="v5uru"?(t(),a(r,{key:46},[n[35]||(n[35]=o(" Godan verb – ")),n[36]||(n[36]=l("i",{lang:"ja-Latn"},"Uru",-1)),n[37]||(n[37]=o(" old class verb"))],64)):e.tag==="vi"?(t(),a(r,{key:47},[o(" intransitive verb")],64)):e.tag==="vk"?(t(),a(r,{key:48},[n[38]||(n[38]=l("i",{lang:"ja-Latn"},"Kuru",-1)),n[39]||(n[39]=o(" verb"))],64)):e.tag==="vn"?(t(),a(r,{key:49},[n[40]||(n[40]=o(" irregular ")),n[41]||(n[41]=l("i",{lang:"ja-Latn"},"nu",-1)),n[42]||(n[42]=o(" verb"))],64)):e.tag==="vr"?(t(),a(r,{key:50},[n[43]||(n[43]=o(" irregular ")),n[44]||(n[44]=l("i",{lang:"ja-Latn"},"ru",-1)),n[45]||(n[45]=o(" verb"))],64)):e.tag==="vs"?(t(),a(r,{key:51},[n[46]||(n[46]=l("i",{lang:"ja-Latn"},"suru",-1)),n[47]||(n[47]=o(" verb"))],64)):e.tag==="vs-c"?(t(),a(r,{key:52},[n[48]||(n[48]=l("i",{lang:"ja-Latn"},"su",-1)),n[49]||(n[49]=o(" verb—precursor to the modern ")),n[50]||(n[50]=l("i",{lang:"ja-Latn"},"suru",-1))],64)):e.tag==="vs-i"?(t(),a(r,{key:53},[n[51]||(n[51]=l("i",{lang:"ja-Latn"},"suru",-1)),n[52]||(n[52]=o(" verb – included"))],64)):e.tag==="vs-s"?(t(),a(r,{key:54},[n[53]||(n[53]=l("i",{lang:"ja-Latn"},"suru",-1)),n[54]||(n[54]=o(" verb – special class"))],64)):e.tag==="vt"?(t(),a(r,{key:55},[o(" transitive verb")],64)):e.tag==="vz"?(t(),a(r,{key:56},[n[55]||(n[55]=o(" Ichidan verb – ")),n[56]||(n[56]=l("i",{lang:"ja-Latn"},"zuru",-1)),n[57]||(n[57]=o(" verb"))],64)):K("",!0)]))}}),M=V(vn,[["__scopeId","data-v-ee320153"]]),yn={class:"vocabulary-word-meaning"},fn={class:"meaning-pos"},jn={class:"glossary"},mn={class:"glossary-word"},bn=L({__name:"VocabularyWordMeaning",props:{meaning:{}},setup(d){return(e,n)=>(t(),a("div",yn,[l("div",fn,[(t(!0),a(r,null,I(e.meaning.pos,i=>(t(),B(M,{tag:i},null,8,["tag"]))),256)),e.meaning.kanaPreferred?(t(),B(M,{key:0,tag:"uk"})):K("",!0)]),l("div",jn,[(t(!0),a(r,null,I(e.meaning.glossary,i=>(t(),a("span",mn,j(i),1))),256))])]))}}),Hn=V(bn,[["__scopeId","data-v-b323a088"]]),wn={key:0,class:"word-writing-details popover-container"},In=["popovertarget"],$n={class:"writing-select-count"},Ln=["id"],Bn=["disabled"],Vn={class:"additional-writing"},Sn=["disabled","onClick"],Wn=["disabled","onClick"],Kn=L({__name:"WordWritingSelect",props:{word:{},default:{},modelValue:{}},emits:["update:modelValue"],setup(d){U(p=>({"6d48b81e":y(i)}));const e=d,n=J(),i=`--${n}`.replace(":","-anchor-"),s=b(()=>{var p;return((p=e.word.writings)==null?void 0:p.filter(g=>g.irregular||g.outdated||g.searchOnly).map(({text:g})=>g))??[]}),u=b(()=>{var p;return((p=e.word.readings)==null?void 0:p.filter(g=>g.irregular||g.outdated||g.searchOnly).map(({text:g})=>g))??[]}),v=b(()=>{var p;return((p=e.word.furigana)==null?void 0:p.filter(g=>g.furigana!==e.default&&!s.value.includes(g.writing)&&!u.value.includes(g.reading)))??[]}),f=b(()=>{var p;return((p=e.word.readings)==null?void 0:p.filter(g=>{var k;return!g.irregular&&!g.outdated&&!g.searchOnly&&!((k=e.word.furigana)!=null&&k.some($=>g.text===$.reading))}))??[]}),T=w(null),E=w(null),O=w(!1);function q(p){O.value=p.newState==="open"}function A(p){var g,k;if(p.newState==="open"&&!("anchorName"in document.documentElement.style)){const $=(g=T.value)==null?void 0:g.getBoundingClientRect(),R=(k=E.value)==null?void 0:k.style;R&&$&&(R.insetBlockStart=`${$.bottom+window.scrollY}px`,R.insetInlineEnd=`calc(100% - ${$.right}px)`)}}return(p,g)=>v.value.length+f.value.length>0?(t(),a("div",wn,[l("button",{ref_key:"toggleButton",ref:T,title:"Additional Writings",class:"toggle-button",popovertarget:y(n)},[g[1]||(g[1]=l("span",{class:"writing-select-icon"},"か",-1)),l("small",$n,"(+"+j(v.value.length+f.value.length+1)+")",1)],8,In),l("ul",{id:y(n),ref_key:"popoverEl",ref:E,class:"writing-list popover",popover:"",onBeforetoggle:A,onToggle:q},[l("li",null,[l("button",{class:"select-button",disabled:p.modelValue===null,onClick:g[0]||(g[0]=k=>p.$emit("update:modelValue",null))},[S(G,{furigana:p.default},null,8,["furigana"])],8,Bn)]),(t(!0),a(r,null,I(v.value,k=>(t(),a("li",Vn,[l("button",{class:"select-button",disabled:p.modelValue===k.furigana,onClick:$=>p.$emit("update:modelValue",k.furigana)},[S(G,{furigana:k.furigana},null,8,["furigana"])],8,Sn)]))),256)),(t(!0),a(r,null,I(f.value,k=>(t(),a("li",null,[l("button",{class:"select-button",disabled:p.modelValue===k.text,onClick:$=>p.$emit("update:modelValue",k.text)},j(k.text),9,Wn)]))),256))],40,Ln)])):K("",!0)}}),Pn=V(Kn,[["__scopeId","data-v-fb653267"]]);export{On as B,Hn as V,Pn as W,G as _,Tn as a,Mn as b,En as c,An as d,Fn as e,qn as h,an as i,Nn as u};
