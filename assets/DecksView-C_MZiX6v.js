import{c as i,B as P,d as b,i as A,v as C,u as o,s as Q,w as D,h as v,t as m,o as n,_ as j,a as r,F as S,l as K,b as w,m as Y,n as G,G as T,L as z,e as p,g as f,f as V,A as F}from"./index-iqwy-qSw.js";import{u as $,d as E}from"./db-B7IDTSNy.js";import{g as H}from"./decks-BHcpk4Nd.js";import{u as M}from"./fsrs-Bs6kkBAR.js";import{d as J}from"./decks-CfOZF5PQ.js";import{c as x}from"./index-BOsLoRk8.js";import{f as R}from"./formats-CxjEYhKc.js";import"./reviews-CI8qaBcI.js";import"./text-p0dDw4FE.js";function O(){return $(async()=>(await(await E).transaction("decks").store.index("category+priority").getAll()).filter(({active:t})=>t)).result}function U(d){const t=M(),c=i(()=>{const l=P(d);return()=>H(l,t.value)}),{result:e}=$(c);return e}const W=b({__name:"DeckKanjiCardItem",props:{codepoint:{}},setup(d){const t=d,c=i(()=>String.fromCodePoint(t.codepoint)),{result:e}=$(async()=>{const{codepoint:s}=t,u=(await E).transaction("progress").store,k=await u.get([s,"kanji-read"]),L=await u.get([s,"kanji-write"]);return{read:k,write:L}}),l=M();function _(s){return s?s.state===x.New?"new":s.state===x.Learning||s.state===x.Relearning||s.due<new Date?"due":l.value.get_retrievability(s,new Date,!1)>.99?"know":"review":null}const y=i(()=>{var s,u;return _((u=(s=e.value)==null?void 0:s.read)==null?void 0:u.fsrs)}),g=i(()=>{var s,u;return _((u=(s=e.value)==null?void 0:s.write)==null?void 0:u.fsrs)});return(s,u)=>{const k=C("RouterLink");return n(),A(k,{to:o(Q)(c.value),class:"kanji","data-read":y.value,"data-write":g.value},{default:D(()=>[v(m(c.value),1)]),_:1},8,["to","data-read","data-write"])}}}),X=j(W,[["__scopeId","data-v-f91bac39"]]),Z={class:"kanji-list"},ee=b({__name:"DeckKanjiCards",props:{kanji:{}},setup(d){return(t,c)=>(n(),r("ol",Z,[(n(!0),r(S,null,K(t.kanji,e=>(n(),r("li",{key:e,class:"kanji"},[w(X,{codepoint:e},null,8,["codepoint"])]))),128))]))}}),te=j(ee,[["__scopeId","data-v-951da1ce"]]),se=["aria-labelledby"],ne=["id"],ae={class:"status"},oe={class:"count total-count"},re={key:0,class:"count know-count"},ce={key:1,class:"count review-count"},ue={key:2,class:"count due-count"},ie={key:3,class:"count new-count"},le=b({__name:"DeckListItem",props:{deck:{}},setup(d){const t=d,c=Y(null),e=z(),l=G(),_=i(()=>J(t.deck)),y=i(()=>l.query.deck?typeof l.query.deck=="string"?[l.query.deck]:l.query.deck:[]),g=i(()=>y.value.includes(t.deck.name)),s=i(()=>{const{name:a}=t.deck,I=g.value?y.value.filter(h=>h!==a):[...y.value,a];return{query:{...l.query,deck:I}}}),u=U(()=>t.deck.name);function k(a){if(!u.value)return 0;const{"kanji-read":I,"kanji-write":h}=u.value;return(I[a]+h[a])/2}const L=i(()=>k("new")),q=i(()=>k("due")),B=i(()=>k("review")),N=i(()=>k("know"));return T(()=>{var a;g.value&&y.value.length===1&&((a=c.value)==null||a.scrollIntoView({block:"start"}))}),(a,I)=>{const h=C("RouterLink");return n(),r("article",{ref_key:"el",ref:c,class:"deck-list-item","aria-labelledby":o(e)},[p("strong",{id:o(e),class:"label"},[w(h,{to:s.value,"aria-pressed":g.value,replace:""},{default:D(()=>[v(m(_.value),1)]),_:1},8,["to","aria-pressed"])],8,ne),p("div",ae,[p("span",oe,m(a.deck.cards.length)+" cards",1),o(u)?(n(),r(S,{key:0},[N.value>0?(n(),r("span",re,m(o(R)(N.value/a.deck.cards.length))+" know ",1)):f("",!0),B.value>0?(n(),r("span",ce,m(o(R)(B.value/a.deck.cards.length))+" reviewed ",1)):f("",!0),q.value>0?(n(),r("span",ue,m(o(R)(q.value/a.deck.cards.length))+" due ",1)):f("",!0),L.value>0?(n(),r("span",ie,m(o(R)(L.value/a.deck.cards.length))+" remaining ",1)):f("",!0)],64)):f("",!0)]),g.value?(n(),A(te,{key:0,kanji:a.deck.cards,class:"cards"},null,8,["kanji"])):f("",!0)],8,se)}}}),de=j(le,[["__scopeId","data-v-69c0447a"]]),ke={key:0,class:"deck-list"},pe=b({__name:"DeckList",setup(d){const t=O();return(c,e)=>{const l=C("RouterLink");return n(),r("section",null,[e[4]||(e[4]=p("p",null," Decks allow you do keep track of your practice, such that you know which kanji you already know, which you should learn next, and which you need to review. ",-1)),o(t)&&o(t).length>0?(n(),r("ol",ke,[(n(!0),r(S,null,K(o(t),_=>(n(),r("li",{key:_.name,class:"deck-list-item"},[w(de,{deck:_},null,8,["deck"])]))),128))])):o(t)?(n(),r(S,{key:1},[p("p",null,[e[1]||(e[1]=v(" You donâ€˜t have any decks. ")),w(l,{to:o(V)},{default:D(()=>e[0]||(e[0]=[v("Add your first deck")])),_:1},8,["to"]),e[2]||(e[2]=v(" by clicking the button below. "))]),w(F,{to:o(V),"prefix-icon":"plus"},{default:D(()=>e[3]||(e[3]=[v("Add Deck")])),_:1},8,["to"])],64)):f("",!0)])}}}),_e=j(pe,[["__scopeId","data-v-ebf17603"]]),me={class:"article-header"},fe={class:"actions"},ve=b({__name:"DecksView",setup(d){return(t,c)=>(n(),r("article",null,[p("header",me,[c[1]||(c[1]=p("h2",{class:"title"},"Your Decks",-1)),p("div",fe,[w(F,{to:o(V),"prefix-icon":"draw"},{default:D(()=>c[0]||(c[0]=[v("Manage Decks")])),_:1},8,["to"])])]),w(_e)]))}}),Re=j(ve,[["__scopeId","data-v-d3200aa2"]]);export{Re as default};
