{"version":3,"file":"KanjiAsideView-D3Uer8gB.js","sources":["../../src/components/KanjiAsideNav.vue","../../src/views/KanjiAsideView.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, ref } from \"vue\";\n\nimport { deckLabel } from \"../helpers/decks.ts\";\nimport { kanjiRoute } from \"../router.ts\";\nimport { Deck } from \"../types.ts\";\nimport AppIcon from \"./AppIcon.vue\";\n\nconst props = defineProps<{\n  cardId: number;\n  deck: Deck;\n}>();\n\nconst index = computed(() => props.deck.cards.indexOf(props.cardId));\nconst start = computed(() => Math.max(0, index.value - 4));\nconst end = computed(() => Math.min(props.deck.cards.length, index.value + 5));\n\nconst cards = computed(() => {\n  const cardsValue = props.deck.cards;\n  const { length } = cardsValue;\n\n  if (length <= 9) {\n    return cardsValue;\n  }\n\n  if (start.value === 0) {\n    return cardsValue.slice(0, 9);\n  }\n\n  if (end.value === length) {\n    return cardsValue.slice(length - 9);\n  }\n\n  return cardsValue.slice(start.value, end.value);\n});\n\nconst expanded = ref(true);\n</script>\n\n<template>\n  <nav v-if=\"index !== -1\" class=\"kanji-aside-nav\">\n    <details\n      :open=\"expanded\"\n      class=\"nav-details\"\n      @toggle=\"expanded = ($event.target as HTMLDetailsElement).open\"\n    >\n      <summary>\n        <span class=\"label\">{{ deckLabel(deck) }}</span>\n\n        <AppIcon v-if=\"expanded\" icon=\"chevron-down\" />\n        <AppIcon v-else icon=\"chevron-up\" />\n      </summary>\n\n      <ol v-if=\"expanded\" class=\"kanji-deck-index\">\n        <li v-for=\"id of cards\" :key=\"id\">\n          <RouterLink\n            :to=\"kanjiRoute(String.fromCodePoint(id))\"\n            :class=\"{ 'kanji-link-active': id === cardId }\"\n            class=\"kanji-link\"\n          >\n            {{ String.fromCodePoint(id) }}\n          </RouterLink>\n        </li>\n      </ol>\n    </details>\n  </nav>\n</template>\n\n<style scoped>\n.kanji-aside-nav {\n  align-items: center;\n  display: flex;\n  flex-direction: column;\n\n  @media screen and (max-width: 75ch) {\n    align-items: start;\n  }\n}\n\n.nav-details summary {\n  align-items: center;\n  display: flex;\n  color: var(--medium-gray);\n  cursor: pointer;\n  writing-mode: vertical-lr;\n\n  &::-webkit-details-marker {\n    display: none;\n  }\n\n  @media screen and (max-width: 75ch) {\n    writing-mode: horizontal-tb;\n  }\n}\n\n.label {\n  color: inherit;\n  text-decoration: none;\n}\n\n.kanji-deck-index {\n  align-items: center;\n  column-gap: 1ex;\n  display: flex;\n  flex-direction: column;\n  flex-wrap: wrap;\n  list-style: none;\n  margin-block: 1ex;\n  padding: 0;\n\n  @media screen and (max-width: 75ch) {\n    flex-direction: row;\n  }\n}\n\n.kanji-link {\n  border-radius: 0.4ex;\n  color: var(--accent-color);\n  font-weight: 400;\n  text-decoration: none;\n  padding: 0.25ex;\n  border: 1px solid transparent;\n\n  &.kanji-link-active {\n    font-weight: 600;\n    background: var(--background-light);\n    border-color: currentColor;\n  }\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed } from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nimport KanjiAsideNav from \"../components/KanjiAsideNav.vue\";\nimport { db } from \"../db/index.ts\";\nimport { useLiveQuery } from \"../helpers/db.ts\";\n\nconst route = useRoute();\nconst kanjiId = computed(() => {\n  if (typeof route.params.kanji !== \"string\") {\n    return null;\n  }\n\n  return route.params.kanji.codePointAt(0) ?? null;\n});\n\nconst { result: decks } = useLiveQuery(\n  computed(() => {\n    const id = kanjiId.value;\n\n    return async () =>\n      (await db)\n        .transaction(\"decks\")\n        .store.index(\"cards\")\n        .getAll(IDBKeyRange.only(id));\n  }),\n);\n\nconst activeDecks = computed(() => decks.value?.filter(({ active }) => active));\n</script>\n\n<template>\n  <aside v-if=\"kanjiId && activeDecks && activeDecks.length > 0\">\n    <KanjiAsideNav\n      v-for=\"deck of activeDecks\"\n      :key=\"deck.name\"\n      :deck=\"deck\"\n      :card-id=\"kanjiId\"\n      class=\"deck-nav\"\n    />\n  </aside>\n</template>\n\n<style scoped>\n.deck-nav:not(:first-child) {\n  margin-block-start: 1ex;\n\n  @media screen and (max-width: 75ch) {\n    margin-block-start: 0;\n  }\n}\n</style>\n"],"names":["props","__props","index","computed","start","end","cards","cardsValue","length","expanded","ref","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","$event","_hoisted_3","_toDisplayString","_unref","deckLabel","deck","_createBlock","AppIcon","_hoisted_4","_Fragment","_renderList","id","_createVNode","_component_RouterLink","kanjiRoute","_normalizeClass","cardId","route","useRoute","kanjiId","decks","useLiveQuery","db","activeDecks","active","KanjiAsideNav"],"mappings":"+aAQA,MAAMA,EAAQC,EAKRC,EAAQC,EAAS,IAAMH,EAAM,KAAK,MAAM,QAAQA,EAAM,MAAM,CAAC,EAC7DI,EAAQD,EAAS,IAAM,KAAK,IAAI,EAAGD,EAAM,MAAQ,CAAC,CAAC,EACnDG,EAAMF,EAAS,IAAM,KAAK,IAAIH,EAAM,KAAK,MAAM,OAAQE,EAAM,MAAQ,CAAC,CAAC,EAEvEI,EAAQH,EAAS,IAAM,CAC3B,MAAMI,EAAaP,EAAM,KAAK,MACxB,CAAE,OAAAQ,GAAWD,EAEnB,OAAIC,GAAU,EACLD,EAGLH,EAAM,QAAU,EACXG,EAAW,MAAM,EAAG,CAAC,EAG1BF,EAAI,QAAUG,EACTD,EAAW,MAAMC,EAAS,CAAC,EAG7BD,EAAW,MAAMH,EAAM,MAAOC,EAAI,KAAK,CAChD,CAAC,EAEKI,EAAWC,EAAI,EAAI,+CAIZR,EAAA,QAAK,IAAhBS,IAAAC,EAyBM,MAzBNC,EAyBM,CAxBJC,EAuBU,UAAA,CAtBP,KAAML,EAAA,MACP,MAAM,cACL,wBAAQA,EAAA,MAAYM,EAAO,OAA8B,KAAA,GAE1DD,EAKU,UAAA,KAAA,CAJRA,EAAgD,OAAhDE,EAAgDC,EAAzBC,EAAAC,CAAA,EAAUC,EAAAA,IAAI,CAAA,EAAA,CAAA,EAEtBX,EAAA,WAAfY,EAA+CC,EAAA,OAAtB,KAAK,cAAA,SAC9BD,EAAoCC,EAAA,OAApB,KAAK,YAAA,MAGbb,EAAA,OAAVE,EAAA,EAAAC,EAUK,KAVLW,EAUK,QATHX,EAQKY,EAAA,KAAAC,EARYnB,EAAA,MAANoB,QAAXd,EAQK,KAAA,CARoB,IAAKc,GAAE,CAC9BC,EAMaC,EAAA,CALV,GAAIV,EAAAW,CAAA,EAAW,OAAO,cAAcH,CAAE,CAAA,EACtC,MAAKI,EAAA,CAAA,CAAA,oBAAyBJ,IAAOK,EAAAA,MAAAA,EAChC,YAAY,CAAA,CAAA,aAElB,IAA8B,KAA3B,OAAO,cAAcL,CAAE,CAAA,EAAA,CAAA,CAAA,mKCpDtC,MAAMM,EAAQC,EAAA,EACRC,EAAU/B,EAAS,IACnB,OAAO6B,EAAM,OAAO,OAAU,SACzB,KAGFA,EAAM,OAAO,MAAM,YAAY,CAAC,GAAK,IAC7C,EAEK,CAAE,OAAQG,CAAA,EAAUC,EACxBjC,EAAS,IAAM,CACb,MAAMuB,EAAKQ,EAAQ,MAEnB,MAAO,WACJ,MAAMG,GACJ,YAAY,OAAO,EACnB,MAAM,MAAM,OAAO,EACnB,OAAO,YAAY,KAAKX,CAAE,CAAC,CAClC,CAAC,CAAA,EAGGY,EAAcnC,EAAS,IAAMgC,EAAM,OAAO,OAAO,CAAC,CAAE,OAAAI,KAAaA,CAAM,CAAC,eAI/DL,EAAA,OAAWI,EAAA,OAAeA,EAAA,MAAY,OAAM,OAAzD1B,EAQQ,QAAAC,EAAA,QAPND,EAMEY,EAAA,KAAAC,EALea,EAAA,MAARlB,QADTC,EAMEmB,EAAA,CAJC,IAAKpB,EAAK,KACV,KAAAA,EACA,UAASc,EAAA,MACV,MAAM,UAAA"}