import{d as b,_,o as e,a as d,c as j,F as f,j as C,f as h,w as Z,b as p,t as w,u as t,e as T,h as y,g as k,k as N,l as I,m as L,n as V}from"./index-CjZvuqUe.js";import{l as R,A as $,u as H}from"./index-HJmKARl4.js";import{u as K,a as B}from"./WordWritingSelect-VdDp-EXB.js";import{p as z,K as A,a as D,b as P,c as E,d as q}from"./KanjiWordList-4C_4SEOi.js";import{u as F}from"./fsrs-JCa1sYsB.js";import{f as W}from"./time-B3so-xG4.js";import{u as G,a as Q,r as J,R as O}from"./cards-UQCGZwWq.js";import{l as U}from"./db-B6qaO1xm.js";import"./iterators-PeFxZeGd.js";import"./index-MwAREZqo.js";import"./decks-GrwULuka.js";import"./formats-CxjEYhKc.js";import"./WordListItem-DEf7J6B6.js";const X=`<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 160 160">
  <g data-element="日">
    <path id="s01">
      <animate
        id="s01a1"
        attributeName="d"
        dur="400ms"
        begin="0; s10a1_fill.end+500ms"
        values="
          M0,30 H10 v10 H0 Z;
          M0,30 H10 v100 H0 Z;
        "
        keyTimes="0; 1"
        keySplines="0.39, 0.575, 0.565, 1"
        calcMode="spline"
      />
      <animate
        id="s01a1_fill"
        attributeName="d"
        begin="s01a1.end"
        end="s10a1_fill.end"
        values="
          M0,30 H10 v100 H0 Z;
        "
      />
    </path>

    <path id="s02">
      <animate
        id="s02a1"
        attributeName="d"
        dur="600ms"
        begin="s01a1.end+100ms"
        values="
          M0,45 v-15 h10 v15 h-10 v0 Z;
          M0,45 v-15 h40 v15 h-10 v0 Z;
          M0,45 v-15 h40 V130 h-10 V45 Z;
        "
        keyTimes="0; 0.33; 1"
        keySplines="0.39, 0.575, 0.565, 1; 0.39, 0.575, 0.565, 1"
        calcMode="spline"
      />
      <animate
        id="s02a1_fill"
        attributeName="d"
        begin="s02a1.end"
        end="s10a1_fill.end"
        values="
          M0,45 v-15 h40 V130 h-10 V45 Z;
        "
      />
    </path>

    <path id="s03">
      <animate
        id="s03a1"
        attributeName="d"
        dur="200ms"
        begin="s02a1.end+100ms"
        values="
          M10,85 v-15 h0 v15 Z;
          M10,85 v-15 h20 v15 Z;
        "
      />
      <animate
        id="s03a1_fill"
        attributeName="d"
        begin="s03a1.end"
        end="s10a1_fill.end"
        values="
          M10,85 v-15 h20 v15 Z;
        "
      />
    </path>

    <path id="s04">
      <animate
        id="s04a1"
        attributeName="d"
        dur="200ms"
        begin="s03a1.end+100ms"
        values="
          M10,125 v-15 h0 v15 Z;
          M10,125 v-15 h20 v15 Z;
        "
      />
      <animate
        id="s04a1_fill"
        attributeName="d"
        begin="s04a1.end"
        end="s10a1_fill.end"
        values="
          M10,125 v-15 h20 v15 Z;
        "
      />
    </path>
  </g>

  <g data-element="寺">
    <g data-element="土">
      <path id="s05">
        <animate
          id="s05a1"
          attributeName="d"
          dur="400ms"
          begin="s04a1.end+200ms"
          values="
            M60,30 v-10 h10 v10 Z;
            M60,30 v-10 h90 v10 Z;
          "
          keyTimes="0; 1"
          keySplines="0.39, 0.575, 0.565, 1"
          calcMode="spline"
        />
        <animate
          id="s05a1_fill"
          attributeName="d"
          begin="s05a1.end"
          end="s10a1_fill.end"
          values="
            M60,30 v-10 h90 v10 Z;
          "
        />
      </path>

      <path id="s06">
        <animate
          id="s06a1"
          attributeName="d"
          dur="400ms"
          begin="s05a1.end+200ms"
          values="
            M100,0 h10 v10 h-10 Z;
            M100,0 h10 v50 h-10 Z;
          "
          keyTimes="0; 1"
          keySplines="0.39, 0.575, 0.565, 1"
          calcMode="spline"
        />
        <animate
          id="s06a1_fill"
          attributeName="d"
          begin="s06a1.end"
          end="s10a1_fill.end"
          values="
            M100,0 h10 v50 h-10 Z;
          "
        />
      </path>

      <path id="s07">
        <animate
          id="s07a1"
          attributeName="d"
          dur="400ms"
          begin="s06a1.end+200ms"
          values="
            M50,60 v-10 h10 v10 Z;
            M50,60 v-10 H160 v10 Z;
          "
          keyTimes="0; 1"
          keySplines="0.39, 0.575, 0.565, 1"
          calcMode="spline"
        />
        <animate
          id="s07a1_fill"
          attributeName="d"
          begin="s07a1.end"
          end="s10a1_fill.end"
          values="
            M50,60 v-10 H160 v10 Z;
          "
        />
      </path>
    </g>

    <g data-element="寸">
      <path id="s08">
        <animate
          id="s08a1"
          attributeName="d"
          dur="400ms"
          begin="s07a1.end+200ms"
          values="
            M50,90 v-10 h10 v10 Z;
            M50,90 v-10 H160 v10 Z;
          "
          keyTimes="0; 1"
          keySplines="0.39, 0.575, 0.565, 1"
          calcMode="spline"
        />
        <animate
          id="s08a1_fill"
          attributeName="d"
          begin="s08a1.end"
          end="s10a1_fill.end"
          values="
            M50,90 v-10 H160 v10 Z;
          "
        />
      </path>

      <path id="s09">
        <animate
          id="s09a1"
          attributeName="d"
          dur="400ms"
          begin="s08a1.end+200ms"
          values="
            M130,65 h10 v10 h-10 Z;
            M130,65 h10 v80 h-10 Z;
          "
        />
        <animate
          id="s09a2"
          attributeName="d"
          dur="100ms"
          begin="s09a1.end"
          values="
            M 130,65
            h 10
            v 80
            c 0,0 0,0 0,0
            c 0,0 0,0 0,0
            c 0,0 0,0 0,0
            L 130,140
            c 0,0 0,0 0,0
            z;
            M 130,65
            h 10
            v 80
            c 0,7.12 0.21,12.17 -5.5,14
            c -5.5,1 -10.5,1 -10.5,1
            c 0,-3.33 -1.33,-6.33 -4,-9
            L 125,150
            c 4,0 5,-4 5,-5
            z;
            M 130,65
            h 10
            v 80
            c 0,7.12 0.21,12.17 -5.5,14
            c -5.5,1 -10.5,1 -34.5,1
            c 0,-3.33 -1.33,-6.33 -4,-9
            L 125,150
            c 4,0 5,-4 5,-5
            z;
          "
          keyTimes="0; 0.66; 1"
          keySplines="0.39, 0.575, 0.565, 1; 0.39, 0.575, 0.565, 1"
          calcMode="spline"
        />
        <animate
          id="s09a2"
          attributeName="d"
          begin="s09a2.end"
          end="s10a1_fill.end"
          values="
            M 130,65
            h 10
            v 80
            c 0,7.12 0.21,12.17 -5.5,14
            c -5.5,1 -10.5,1 -34.5,1
            c 0,-3.33 -1.33,-6.33 -4,-9
            L 125,150
            c 4,0 5,-4 5,-5
            z;
          "
        />
      </path>

      <path id="s10">
        <animate
          id="s10a1"
          attributeName="d"
          dur="400ms"
          begin="s09a2.end+200ms"
          values="
            M 65,110
            l 7.85,-6.3
            c 0,0 0,0 0,0
            l -7.85,6.3
            c 0,0 0,0 0,0;
            M 65,110
            l 7.85,-6.3
            c 5,2.5 10.1,7.7 14.575,13.525
            l -7.85,6.3
            C 75.1,117.7 70,112.5 65,110;
            M 65,110
            l 7.85,-6.3
            c 10,5 20.4,20.8 25.4,30.8
            l -7.85,6.3
            c -5,-10 -15.4,-25.8 -25.4,-30.8;
          "
          keyTimes="0; 0.5; 1"
          keySplines="0.39, 0.575, 0.565, 1; 0.39, 0.575, 0.565, 1"
          calcMode="spline"
        />

        <animate
          id="s10a1_fill"
          attributeName="d"
          dur="1s"
          begin="s10a1.end"
          values="
            M 65,110
            l 7.85,-6.3
            c 10,5 20.4,20.8 25.4,30.8
            l -7.85,6.3
            c -5,-10 -15.4,-25.8 -25.4,-30.8;
          "
        />
      </path>
    </g>
  </g>
</svg>
`,S=new CSSStyleSheet;S.replaceSync(`
svg {
  block-size: 1em;
  fill: currentColor;
  inline-size: 1em;
}
`);class Y extends HTMLElement{constructor(){super();const i=this.attachShadow({mode:"open"});i.adoptedStyleSheets=[S],i.innerHTML=X}}customElements.define("c-app-loading",Y);const x=b({});function nn(u,i,o,c,l,n){return e(),d("c-app-loading")}const en=_(x,[["render",nn]]),an={class:"rate-buttons"},sn={class:"rate-button-content"},tn={class:"rating"},rn={class:"next-review-time"},dn=b({__name:"RateButtons",props:{fsrs:{}},emits:["rate"],setup(u,{emit:i}){const o=u,c=i,l=j(()=>r.value.repeat(o.fsrs,new Date));function n(v){var s;const M=((s=v.last_review)==null?void 0:s.getTime())??Date.now(),a=v.due.getTime();return W(a-M)}const r=F();function m(v){v!==R.Manual&&c("rate",r.value.next(o.fsrs,new Date,v))}return(v,M)=>(e(),d("div",an,[(e(!0),d(f,null,C(l.value,({log:a,card:s})=>(e(),h($,{class:"rating-button",key:a.rating,"data-rating":t(R)[a.rating],onClick:g=>m(a.rating)},{default:Z(()=>[p("span",sn,[p("span",tn,w(t(R)[a.rating]),1),p("small",rn,w(n(s)),1)])]),_:2},1032,["data-rating","onClick"]))),128))]))}}),on=_(dn,[["__scopeId","data-v-4210a69b"]]),ln={key:0},un={class:"advance-buttons"},cn=b({__name:"KanjiReview",props:{progress:{},answered:{type:Boolean}},emits:["answer","rate"],setup(u){const i=u,o=K(()=>i.progress.cardId),c=B(()=>i.progress.cardId);z(()=>i.progress.cardId.toString(16).padStart(5,"0"));const l=j(()=>i.progress.fsrs.state===H.New);return(n,r)=>t(o)?(e(),d("section",ln,[T(A,{class:"title",kanji:t(o),"hide-literal":!n.answered&&n.progress.cardType==="kanji-write"&&!l.value,"hide-meaning":!n.answered&&n.progress.cardType==="kanji-read"},null,8,["kanji","hide-literal","hide-meaning"]),n.answered||n.progress.cardType==="kanji-write"?(e(),h(D,{key:0,class:"readings",kanji:t(o)},null,8,["kanji"])):y("",!0),T(P,{class:"strokes",kanji:t(o),"auto-hint":!n.answered&&n.progress.cardType==="kanji-write"&&l.value,"practice-mode":!n.answered&&n.progress.cardType==="kanji-write","practice-review":n.progress.cardType==="kanji-write",onPracticeDone:r[0]||(r[0]=m=>n.$emit("answer"))},null,8,["kanji","auto-hint","practice-mode","practice-review"]),p("div",un,[n.answered?(e(),h(on,{key:0,fsrs:n.progress.fsrs,onRate:r[1]||(r[1]=m=>n.$emit("rate",m))},null,8,["fsrs"])):(e(),h($,{key:1,onClick:r[2]||(r[2]=m=>n.$emit("answer")),filled:""},{default:Z(()=>[r[3]||(r[3]=k(" Show ")),n.progress.cardType==="kanji-read"?(e(),d(f,{key:0},[k(" Reading")],64)):(e(),d(f,{key:1},[k(" Writing")],64))]),_:1}))]),n.answered||n.progress.cardType==="kanji-write"&&l.value?(e(),h(q,{key:1,class:"components"})):y("",!0),t(c)?(e(),h(E,{key:2,class:"words","kanji-vocab":t(c),"hide-kanji":!n.answered&&n.progress.cardType==="kanji-write"&&!l.value,"hide-reading":!n.answered&&n.progress.cardType==="kanji-read","hide-meaning":!n.answered&&n.progress.cardType==="kanji-read"},null,8,["kanji-vocab","hide-kanji","hide-reading","hide-meaning"])):y("",!0)])):y("",!0)}}),pn=_(cn,[["__scopeId","data-v-249adc66"]]),mn={key:0,class:"review-remaining-count"},vn={class:"review-count"},gn={class:"new-count"},hn={class:"learning-count"},fn=b({__name:"ReviewRemainCount",setup(u){const i=G();return(o,c)=>t(i)?(e(),d("div",mn,[p("span",vn,w(t(i).due),1),p("span",gn,"(+ "+w(t(i).new)+")",1),p("span",hn,w(t(i).learning),1)])):y("",!0)}}),kn=_(fn,[["__scopeId","data-v-def2b4ab"]]);function yn(u){return u==="kanji-read"||u==="kanji-write"}const wn={class:"header"},bn={class:"title"},_n={key:0,class:"loading"},Mn=b({__name:"ReviewView",setup(u){const i=L(),o=V(),c=j(()=>{const{kanji:a,"card-type":s}=i.query;if(typeof a!="string"||typeof s!="string")return null;const g=a.codePointAt(0);return!g||!yn(s)?null:{cardId:g,cardType:s}}),l=N(null),{result:n,loading:r}=Q(c),m=N(!0);I(r,a=>{a||(m.value=!1)});const v=j(()=>{var a;return m.value?!0:!n.value||!l.value||((a=c.value)==null?void 0:a.cardId)===n.value.cardId?!1:r.value&&n.value.cardId===l.value.cardId&&n.value.cardType===n.value.cardType});async function M(a,s){try{l.value={cardId:a.cardId,cardType:a.cardType},await J(a,s),U.postMessage("card-review"),o.replace({query:{kanji:void 0,"card-type":void 0}})}catch(g){console.error(g)}}return(a,s)=>(e(),d("article",null,[p("header",wn,[p("strong",bn,[t(n)?(e(),d(f,{key:0},[t(n).cardType==="kanji-read"?(e(),d(f,{key:0},[k(" Reading ")],64)):(e(),d(f,{key:1},[k("Writing")],64)),s[2]||(s[2]=k(" Review "))],64)):m.value?y("",!0):(e(),d(f,{key:1},[k("Review Summary")],64))]),T(kn,{class:"counts"})]),v.value?(e(),d("section",_n,[s[3]||(s[3]=p("p",null,"Loading next card…",-1)),T(en,{class:"loading-icon"})])):t(n)?(e(),h(pn,{key:1,progress:t(n),answered:c.value!=null,onAnswer:s[0]||(s[0]=g=>a.$router.replace({query:{kanji:String.fromCodePoint(t(n).cardId),"card-type":t(n).cardType}})),onRate:s[1]||(s[1]=g=>M(t(n),g))},null,8,["progress","answered"])):(e(),h(O,{key:2}))]))}}),Bn=_(Mn,[["__scopeId","data-v-2d6d4259"]]);export{Bn as default};
